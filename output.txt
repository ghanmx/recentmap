

// .\package.json
{
  "name": "vite_react_shadcn_ts",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc -b && vite build",
    "build:dev": "tsc -b && vite build --mode development",
    "lint": "eslint . --ext .ts,.tsx",
    "lint:fix": "eslint . --c .ts,.tsx --fix",
    "preview": "vite preview",
    "format": "prettier --write .",
    "type-check": "tsc --noEmit",
    "analyze": "vite build --mode analyze",
    "release": "npm run release"
  },
  "dependencies": {
    "@eslint/plugin-kit": "^0.2.3",
    "@hookform/resolvers": "^3.9.0",
    "@mapbox/polyline": "^1.2.1",
    "@radix-ui/react-accordion": "^1.2.0",
    "@radix-ui/react-alert-dialog": "^1.1.1",
    "@radix-ui/react-aspect-ratio": "^1.1.0",
    "@radix-ui/react-avatar": "^1.1.0",
    "@radix-ui/react-checkbox": "^1.1.1",
    "@radix-ui/react-collapsible": "^1.1.0",
    "@radix-ui/react-context-menu": "^2.2.1",
    "@radix-ui/react-dialog": "^1.1.1",
    "@radix-ui/react-dropdown-menu": "^2.1.1",
    "@radix-ui/react-hover-card": "^1.1.1",
    "@radix-ui/react-label": "^2.1.0",
    "@radix-ui/react-menubar": "^1.1.1",
    "@radix-ui/react-navigation-menu": "^1.2.0",
    "@radix-ui/react-popover": "^1.1.1",
    "@radix-ui/react-progress": "^1.1.0",
    "@radix-ui/react-radio-group": "^1.2.0",
    "@radix-ui/react-scroll-area": "^1.1.0",
    "@radix-ui/react-select": "^2.1.1",
    "@radix-ui/react-separator": "^1.1.0",
    "@radix-ui/react-slider": "^1.2.0",
    "@radix-ui/react-slot": "^1.1.0",
    "@radix-ui/react-switch": "^1.1.0",
    "@radix-ui/react-tabs": "^1.1.0",
    "@radix-ui/react-toast": "^1.2.1",
    "@radix-ui/react-toggle": "^1.1.0",
    "@radix-ui/react-toggle-group": "^1.1.0",
    "@radix-ui/react-tooltip": "^1.1.2",
    "@stackbit/cms-git": "^1.0.22",
    "@stripe/react-stripe-js": "^2.8.1",
    "@stripe/stripe-js": "^4.9.0",
    "@tailwindcss/aspect-ratio": "^0.4.2",
    "@tailwindcss/forms": "^0.5.9",
    "@tanstack/react-query": "^5.59.16",
    "@types/leaflet": "^1.9.14",
    "axios": "^1.7.7",
    "class-variance-authority": "^0.7.0",
    "cmdk": "^1.0.0",
    "date-fns": "^3.6.0",
    "embla-carousel-react": "^8.3.0",
    "eslint-plugin-unused-imports": "^4.1.4",
    "framer-motion": "^11.11.17",
    "glob": "^11.0.0",
    "http-proxy-middleware": "^3.0.3",
    "input-otp": "^1.2.4",
    "leaflet": "^1.9.4",
    "lodash": "^4.17.21",
    "lovable-tagger": "^1.0.14",
    "lru-cache": "^11.0.2",
    "lucide-react": "^0.451.0",
    "next-themes": "^0.3.0",
    "react": "^18.3.1",
    "react-day-picker": "^8.10.1",
    "react-dom": "^18.3.1",
    "react-draggable": "^4.4.6",
    "react-hook-form": "^7.53.0",
    "react-leaflet": "^4.2.1",
    "react-resizable-panels": "^2.1.3",
    "react-router-dom": "^6.27.0",
    "recharts": "^2.12.7",
    "rimraf": "^6.0.1",
    "sonner": "^1.5.0",
    "tailwind-merge": "^2.5.2",
    "tailwindcss-animate": "^1.0.7",
    "vaul": "^0.9.3",
    "zod": "^3.23.8",
    "formspree/cli": "^0.1.1"
  },
  "devDependencies": {
    "@eslint/js": "^9.9.0",
    "@stackbit/types": "^2.1.6",
    "@tailwindcss/typography": "^0.5.15",
    "@types/node": "^22.5.5",
    "@types/react": "^18.3.3",
    "@types/react-dom": "^18.3.0",
    "@vitejs/plugin-react-swc": "^3.5.0",
    "autoprefixer": "^10.4.20",
    "eslint": "^9.9.0",
    "eslint-plugin-react-hooks": "^5.1.0-rc.0",
    "eslint-plugin-react-refresh": "^0.4.9",
    "globals": "^15.9.0",
    "packages-update": "^2.0.0",
    "postcss": "^8.4.47",
    "prettier": "^3.0.0",
    "prettier-plugin-tailwindcss": "^0.4.1",
    "tailwindcss": "^3.4.11",
    "typescript": "^5.5.3",
    "typescript-eslint": "^8.0.1",
    "vite": "^5.4.1",
    "formspree/cli-action": "^1.0.0"
  },
  "eslintConfig": {
    "extends": [
      "eslint:recommended",
      "plugin:react/recommended",
      "plugin:@typescript-eslint/recommended",
      "prettier"
    ],
    "plugins": [
      "react-hooks",
      "unused-imports"
    ],
    "rules": {
      "unused-imports/no-unused-imports": "error",
      "unused-imports/no-unused-vars": [
        "warn",
        {
          "vars": "all",
          "varsIgnorePattern": "^_",
          "args": "after-used",
          "argsIgnorePattern": "^_"
        }
      ],
      "@typescript-eslint/no-unused-vars": "off",
      "react-refresh/only-export-components": [
        "warn",
        {
          "allowConstantExport": true
        }
      ]
    }
  },
  "prettier": {
    "singleQuote": true,
    "semi": false,
    "tailwindConfig": "./tailwind.config.ts"
  }
}



// .\tsconfig.json
{
  "files": [],
  "references": [
    { "path": "./tsconfig.app.json" },
    { "path": "./tsconfig.node.json" }
  ],
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    },
    "noImplicitAny": false,
    "noUnusedParameters": false,
    "skipLibCheck": true,
    "allowJs": true,
    "noUnusedLocals": false,
    "strictNullChecks": false
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\components.json
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "default",
  "rsc": false,
  "tsx": true,
  "tailwind": {
    "config": "tailwind.config.ts",
    "css": "src/index.css",
    "baseColor": "slate",
    "cssVariables": true,
    "prefix": ""
  },
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\eslint.config.js
import js from '@eslint/js'
import globals from 'globals'
import reactHooks from 'eslint-plugin-react-hooks'
import reactRefresh from 'eslint-plugin-react-refresh'
import tseslint from 'typescript-eslint'
import unusedImports from 'eslint-plugin-unused-imports'

export default tseslint.config(
  { ignores: ['dist', '.netlify'] },
  {
    extends: [js.configs.recommended, ...tseslint.configs.recommended],
    files: ['**/*.{ts,tsx}'],
    languageOptions: {
      ecmaVersion: 2024,
      globals: {
        ...globals.browser,
        React: true,
        JSX: true,
      },
      parserOptions: {
        project: true,
        ecmaFeatures: {
          jsx: true,
          modules: true,
        },
      },
    },
    plugins: {
      'react-hooks': reactHooks,
      'react-refresh': reactRefresh,
      'unused-imports': unusedImports,
    },
    rules: {
      ...reactHooks.configs.recommended.rules,
      'react-refresh/only-export-components': [
        'warn',
        { allowConstantExport: true },
      ],
      '@typescript-eslint/no-unused-vars': [
        'warn',
        { argsIgnorePattern: '^_' },
      ],
      'unused-imports/no-unused-imports': 'error',
      'unused-imports/no-unused-vars': 'off',
      '@typescript-eslint/strict-boolean-expressions': 'error',
      '@typescript-eslint/no-explicit-any': 'error',
      '@typescript-eslint/explicit-function-return-type': 'warn',
      'react-hooks/exhaustive-deps': 'warn',
      'no-console': ['warn', { allow: ['warn', 'error'] }],
      'prefer-const': 'error',
      eqeqeq: ['error', 'always'],
    },
    settings: {
      react: {
        version: 'detect',
      },
    },
  },
)



// C:\Users\israe\Documents\GitHub\recentmap\package.json
{
  "name": "vite_react_shadcn_ts",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc -b && vite build",
    "build:dev": "tsc -b && vite build --mode development",
    "lint": "eslint . --ext .ts,.tsx",
    "lint:fix": "eslint . --c .ts,.tsx --fix",
    "preview": "vite preview",
    "format": "prettier --write .",
    "type-check": "tsc --noEmit",
    "analyze": "vite build --mode analyze",
    "release": "npm run release"
  },
  "dependencies": {
    "@eslint/plugin-kit": "^0.2.3",
    "@hookform/resolvers": "^3.9.0",
    "@mapbox/polyline": "^1.2.1",
    "@radix-ui/react-accordion": "^1.2.0",
    "@radix-ui/react-alert-dialog": "^1.1.1",
    "@radix-ui/react-aspect-ratio": "^1.1.0",
    "@radix-ui/react-avatar": "^1.1.0",
    "@radix-ui/react-checkbox": "^1.1.1",
    "@radix-ui/react-collapsible": "^1.1.0",
    "@radix-ui/react-context-menu": "^2.2.1",
    "@radix-ui/react-dialog": "^1.1.1",
    "@radix-ui/react-dropdown-menu": "^2.1.1",
    "@radix-ui/react-hover-card": "^1.1.1",
    "@radix-ui/react-label": "^2.1.0",
    "@radix-ui/react-menubar": "^1.1.1",
    "@radix-ui/react-navigation-menu": "^1.2.0",
    "@radix-ui/react-popover": "^1.1.1",
    "@radix-ui/react-progress": "^1.1.0",
    "@radix-ui/react-radio-group": "^1.2.0",
    "@radix-ui/react-scroll-area": "^1.1.0",
    "@radix-ui/react-select": "^2.1.1",
    "@radix-ui/react-separator": "^1.1.0",
    "@radix-ui/react-slider": "^1.2.0",
    "@radix-ui/react-slot": "^1.1.0",
    "@radix-ui/react-switch": "^1.1.0",
    "@radix-ui/react-tabs": "^1.1.0",
    "@radix-ui/react-toast": "^1.2.1",
    "@radix-ui/react-toggle": "^1.1.0",
    "@radix-ui/react-toggle-group": "^1.1.0",
    "@radix-ui/react-tooltip": "^1.1.2",
    "@stackbit/cms-git": "^1.0.22",
    "@stripe/react-stripe-js": "^2.8.1",
    "@stripe/stripe-js": "^4.9.0",
    "@tailwindcss/aspect-ratio": "^0.4.2",
    "@tailwindcss/forms": "^0.5.9",
    "@tanstack/react-query": "^5.59.16",
    "@types/leaflet": "^1.9.14",
    "axios": "^1.7.7",
    "class-variance-authority": "^0.7.0",
    "cmdk": "^1.0.0",
    "date-fns": "^3.6.0",
    "embla-carousel-react": "^8.3.0",
    "eslint-plugin-unused-imports": "^4.1.4",
    "framer-motion": "^11.11.17",
    "glob": "^11.0.0",
    "http-proxy-middleware": "^3.0.3",
    "input-otp": "^1.2.4",
    "leaflet": "^1.9.4",
    "lodash": "^4.17.21",
    "lovable-tagger": "^1.0.14",
    "lru-cache": "^11.0.2",
    "lucide-react": "^0.451.0",
    "next-themes": "^0.3.0",
    "react": "^18.3.1",
    "react-day-picker": "^8.10.1",
    "react-dom": "^18.3.1",
    "react-draggable": "^4.4.6",
    "react-hook-form": "^7.53.0",
    "react-leaflet": "^4.2.1",
    "react-resizable-panels": "^2.1.3",
    "react-router-dom": "^6.27.0",
    "recharts": "^2.12.7",
    "rimraf": "^6.0.1",
    "sonner": "^1.5.0",
    "tailwind-merge": "^2.5.2",
    "tailwindcss-animate": "^1.0.7",
    "vaul": "^0.9.3",
    "zod": "^3.23.8",
    "formspree/cli": "^0.1.1"
  },
  "devDependencies": {
    "@eslint/js": "^9.9.0",
    "@stackbit/types": "^2.1.6",
    "@tailwindcss/typography": "^0.5.15",
    "@types/node": "^22.5.5",
    "@types/react": "^18.3.3",
    "@types/react-dom": "^18.3.0",
    "@vitejs/plugin-react-swc": "^3.5.0",
    "autoprefixer": "^10.4.20",
    "eslint": "^9.9.0",
    "eslint-plugin-react-hooks": "^5.1.0-rc.0",
    "eslint-plugin-react-refresh": "^0.4.9",
    "globals": "^15.9.0",
    "packages-update": "^2.0.0",
    "postcss": "^8.4.47",
    "prettier": "^3.0.0",
    "prettier-plugin-tailwindcss": "^0.4.1",
    "tailwindcss": "^3.4.11",
    "typescript": "^5.5.3",
    "typescript-eslint": "^8.0.1",
    "vite": "^5.4.1",
    "formspree/cli-action": "^1.0.0"
  },
  "eslintConfig": {
    "extends": [
      "eslint:recommended",
      "plugin:react/recommended",
      "plugin:@typescript-eslint/recommended",
      "prettier"
    ],
    "plugins": [
      "react-hooks",
      "unused-imports"
    ],
    "rules": {
      "unused-imports/no-unused-imports": "error",
      "unused-imports/no-unused-vars": [
        "warn",
        {
          "vars": "all",
          "varsIgnorePattern": "^_",
          "args": "after-used",
          "argsIgnorePattern": "^_"
        }
      ],
      "@typescript-eslint/no-unused-vars": "off",
      "react-refresh/only-export-components": [
        "warn",
        {
          "allowConstantExport": true
        }
      ]
    }
  },
  "prettier": {
    "singleQuote": true,
    "semi": false,
    "tailwindConfig": "./tailwind.config.ts"
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\postcss.config.js
export default {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}



// C:\Users\israe\Documents\GitHub\recentmap\stackbit.config.ts
import { defineStackbitConfig } from '@stackbit/types'
import { GitContentSource } from '@stackbit/cms-git'

export default defineStackbitConfig({
  stackbitVersion: '~0.6.0',
  ssgName: 'custom',
  nodeVersion: '20',
  devCommand: 'npm run dev -- --port {PORT} --host 127.0.0.1',
  buildCommand: 'npm run build',
  installCommand: 'npm install',
  dataDir: 'content',
  pagesDir: 'src/pages',
  publishDir: 'dist',
  experimental: {
    ssg: {
      name: 'vite',
      passthrough: ['/*'],
      directRoutes: {
        '/': 'index.html',
      },
    },
  },
  contentSources: [
    new GitContentSource({
      rootPath: __dirname,
      contentDirs: ['content'],
      models: [
        {
          name: 'page',
          type: 'page',
          urlPath: '/{slug}',
          fields: [
            { type: 'string', name: 'title', required: true },
            { type: 'string', name: 'description' },
            { type: 'image', name: 'image' },
            { type: 'datetime', name: 'date' },
            { type: 'string', name: 'layout', default: 'page' },
          ],
        },
        {
          name: 'post',
          type: 'page',
          urlPath: '/blog/{slug}',
          fields: [
            { type: 'string', name: 'title', required: true },
            { type: 'string', name: 'description' },
            { type: 'image', name: 'image' },
            { type: 'datetime', name: 'date' },
            { type: 'string', name: 'author' },
            { type: 'list', name: 'tags', items: { type: 'string' } },
            { type: 'string', name: 'layout', default: 'post' },
          ],
        },
      ],
    }),
  ],
  telemetry: false,
})



// C:\Users\israe\Documents\GitHub\recentmap\tailwind.config.ts
import type { Config } from 'tailwindcss'

export default {
  darkMode: ['class'],
  content: [
    './pages/**/*.{ts,tsx}',
    './components/**/*.{ts,tsx}',
    './app/**/*.{ts,tsx}',
    './src/**/*.{ts,tsx}',
  ],
  prefix: '',
  theme: {
    container: {
      center: true,
      padding: '2rem',
      screens: {
        sm: '640px',
        md: '768px',
        lg: '1024px',
        xl: '1280px',
        '2xl': '1400px',
      },
    },
    extend: {
      colors: {
        border: 'hsl(var(--border))',
        input: 'hsl(var(--input))',
        ring: 'hsl(var(--ring))',
        background: 'hsl(var(--background))',
        foreground: 'hsl(var(--foreground))',
        primary: {
          DEFAULT: 'hsl(var(--primary))',
          foreground: 'hsl(var(--primary-foreground))',
        },
        secondary: {
          DEFAULT: 'hsl(var(--secondary))',
          foreground: 'hsl(var(--secondary-foreground))',
        },
        destructive: {
          DEFAULT: 'hsl(var(--destructive))',
          foreground: 'hsl(var(--destructive-foreground))',
        },
        muted: {
          DEFAULT: 'hsl(var(--muted))',
          foreground: 'hsl(var(--muted-foreground))',
        },
        accent: {
          DEFAULT: 'hsl(var(--accent))',
          foreground: 'hsl(var(--accent-foreground))',
        },
        popover: {
          DEFAULT: 'hsl(var(--popover))',
          foreground: 'hsl(var(--popover-foreground))',
        },
        card: {
          DEFAULT: 'hsl(var(--card))',
          foreground: 'hsl(var(--card-foreground))',
        },
      },
      fontFamily: {
        sans: ['Inter var', 'Inter', 'sans-serif'],
        heading: ['Montserrat', 'sans-serif'],
        mono: ['JetBrains Mono', 'monospace'],
      },
      borderRadius: {
        lg: 'var(--radius)',
        md: 'calc(var(--radius) - 2px)',
        sm: 'calc(var(--radius) - 4px)',
      },
      keyframes: {
        'accordion-down': {
          from: { height: '0' },
          to: { height: 'var(--radix-accordion-content-height)' },
        },
        'accordion-up': {
          from: { height: 'var(--radix-accordion-content-height)' },
          to: { height: '0' },
        },
      },
      animation: {
        'accordion-down': 'accordion-down 0.2s ease-out',
        'accordion-up': 'accordion-up 0.2s ease-out',
      },
    },
  },
  plugins: [
    require('tailwindcss-animate'),
    require('@tailwindcss/typography'),
    require('@tailwindcss/forms'),
    require('@tailwindcss/aspect-ratio'),
  ],
} satisfies Config



// C:\Users\israe\Documents\GitHub\recentmap\tsconfig.app.json
{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "skipLibCheck": true,
    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,
    "jsx": "react-jsx",
    /* Linting */
    "strict": true,
    "noUnusedLocals": false,
    "noUnusedParameters": false,
    "noImplicitAny": false,
    "noFallthroughCasesInSwitch": false,
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["src", "stackbit.config.ts"]
}



// C:\Users\israe\Documents\GitHub\recentmap\tsconfig.json
{
  "files": [],
  "references": [
    { "path": "./tsconfig.app.json" },
    { "path": "./tsconfig.node.json" }
  ],
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    },
    "noImplicitAny": false,
    "noUnusedParameters": false,
    "skipLibCheck": true,
    "allowJs": true,
    "noUnusedLocals": false,
    "strictNullChecks": false
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\tsconfig.node.json
{
  "compilerOptions": {
    "target": "ES2022",
    "lib": ["ES2023"],
    "module": "ESNext",
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,

    /* Linting */
    "strict": true,
    "noUnusedLocals": false,
    "noUnusedParameters": false,
    "noFallthroughCasesInSwitch": true
  },
  "include": ["vite.config.ts"]
}



// C:\Users\israe\Documents\GitHub\recentmap\vite.config.ts
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react-swc'
import path from 'path'
import { componentTagger } from 'lovable-tagger'

// https://vitejs.dev/config/
export default defineConfig(() => ({
  server: {
    host: '::',
    port: 8080,
  },
  plugins: [react(), componentTagger()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
    },
  },
}))



// C:\Users\israe\Documents\GitHub\recentmap\.vscode\launch.json
{
    // Use IntelliSense para saber los atributos posibles.
    // Mantenga el puntero para ver las descripciones de los existentes atributos.
    // Para más información, visite: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        {
            "type": "chrome",
            "request": "launch",
            "name": "Iniciar Chrome para localhost",
            "url": "http://localhost:8080",
            "webRoot": "${workspaceFolder}"
        }
    ]
}


// C:\Users\israe\Documents\GitHub\recentmap\dist\assets\TowMap-H-hSEC71.js
import{c as No,t as zo,j as x,M as Qn,r as T,R as qn,a as ti,b as Hr,g as Bo,u as Ro,d as Xt,B as go,e as Le,f as Fr,p as Zo,C as Ho,L as Fo,m as Fn,A as jr}from"./index-SV8g5SpG.js";/**
 * @license lucide-react v0.451.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=No("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.451.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=No("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]),Wr=1e4,vo={},Uo=a=>{const s=Date.now(),r=vo[a]||0;return s-r>Wr?(vo[a]=s,!0):!1},yo=(a,s)=>{Uo(`location_${a}`)&&zo({title:`${a==="pickup"?"Pickup":"Drop-off"} Location Set`,description:x.jsxs("div",{"data-component-path":"src\\utils\\notificationUtils.tsx","data-component-name":"div","data-component-line":"27","data-component-file":"notificationUtils.tsx","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20gap-2%22%7D",className:"flex items-center gap-2",children:[x.jsx(Qn,{"data-component-path":"src\\utils\\notificationUtils.tsx","data-component-name":"MapPin","data-component-line":"28","data-component-file":"notificationUtils.tsx","data-component-content":"%7B%22className%22%3A%22h-4%20w-4%22%7D",className:"h-4 w-4"}),x.jsxs("span",{"data-component-path":"src\\utils\\notificationUtils.tsx","data-component-name":"span","data-component-line":"29","data-component-file":"notificationUtils.tsx","data-component-content":"%7B%22text%22%3A%22Coordinates%3A%20%2C%22%7D",children:["Coordinates: ",s.lat.toFixed(4),", ",s.lng.toFixed(4)]})]}),duration:5e3,className:"bg-green-50 border-green-200"})},Wo=a=>{Uo("route")&&zo({title:"Route Calculated",description:x.jsxs("div",{"data-component-path":"src\\utils\\notificationUtils.tsx","data-component-name":"div","data-component-line":"45","data-component-file":"notificationUtils.tsx","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20gap-2%22%7D",className:"flex items-center gap-2",children:[x.jsx(Ur,{"data-component-path":"src\\utils\\notificationUtils.tsx","data-component-name":"Info","data-component-line":"46","data-component-file":"notificationUtils.tsx","data-component-content":"%7B%22className%22%3A%22h-4%20w-4%22%7D",className:"h-4 w-4"}),x.jsxs("span",{"data-component-path":"src\\utils\\notificationUtils.tsx","data-component-name":"span","data-component-line":"47","data-component-file":"notificationUtils.tsx","data-component-content":"%7B%22text%22%3A%22Total%20route%20distance%3A%20km%22%7D",children:["Total route distance: ",a.toFixed(2)," km"]})]}),duration:5e3,className:"bg-blue-50 border-blue-200"})};function Go(a,s){const r=T.useRef(s);T.useEffect(function(){s!==r.current&&a.attributionControl!=null&&(r.current!=null&&a.attributionControl.removeAttribution(r.current),s!=null&&a.attributionControl.addAttribution(s)),r.current=s},[a,s])}const Gr=1;function Vr(a){return Object.freeze({__version:Gr,map:a})}function Vo(a,s){return Object.freeze({...a,...s})}const qo=T.createContext(null),Yo=qo.Provider;function Ke(){const a=T.useContext(qo);if(a==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return a}function Xo(a){function s(r,c){const{instance:u,context:f}=a(r).current;return T.useImperativeHandle(c,()=>u),r.children==null?null:qn.createElement(Yo,{value:f},r.children)}return T.forwardRef(s)}function qr(a){function s(r,c){const[u,f]=T.useState(!1),{instance:m}=a(r,f).current;T.useImperativeHandle(c,()=>m),T.useEffect(function(){u&&m.update()},[m,u,r.children]);const v=m._contentNode;return v?ti.createPortal(r.children,v):null}return T.forwardRef(s)}function Yr(a){function s(r,c){const{instance:u}=a(r).current;return T.useImperativeHandle(c,()=>u),null}return T.forwardRef(s)}function ei(a,s){const r=T.useRef();T.useEffect(function(){return s!=null&&a.instance.on(s),r.current=s,function(){r.current!=null&&a.instance.off(r.current),r.current=null}},[a,s])}function Je(a,s){const r=a.pane??s.pane;return r?{...a,pane:r}:a}function Xr(a,s){return function(c,u){const f=Ke(),m=a(Je(c,f),f);return Go(f.map,c.attribution),ei(m.current,c.eventHandlers),s(m.current,f,c,u),m}}var Yn={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(a,s){(function(r,c){c(s)})(Hr,function(r){var c="1.9.4";function u(t){var e,n,i,o;for(n=1,i=arguments.length;n<i;n++){o=arguments[n];for(e in o)t[e]=o[e]}return t}var f=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function m(t,e){var n=Array.prototype.slice;if(t.bind)return t.bind.apply(t,n.call(arguments,1));var i=n.call(arguments,2);return function(){return t.apply(e,i.length?i.concat(n.call(arguments)):arguments)}}var v=0;function _(t){return"_leaflet_id"in t||(t._leaflet_id=++v),t._leaflet_id}function b(t,e,n){var i,o,l,h;return h=function(){i=!1,o&&(l.apply(n,o),o=!1)},l=function(){i?o=arguments:(t.apply(n,arguments),setTimeout(h,e),i=!0)},l}function I(t,e,n){var i=e[1],o=e[0],l=i-o;return t===i&&n?t:((t-o)%l+l)%l+o}function E(){return!1}function Z(t,e){if(e===!1)return t;var n=Math.pow(10,e===void 0?6:e);return Math.round(t*n)/n}function B(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function O(t){return B(t).split(/\s+/)}function A(t,e){Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?f(t.options):{});for(var n in e)t.options[n]=e[n];return t.options}function G(t,e,n){var i=[];for(var o in t)i.push(encodeURIComponent(n?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(!e||e.indexOf("?")===-1?"?":"&")+i.join("&")}var X=/\{ *([\w_ -]+) *\}/g;function C(t,e){return t.replace(X,function(n,i){var o=e[i];if(o===void 0)throw new Error("No value provided for variable "+n);return typeof o=="function"&&(o=o(e)),o})}var w=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function P(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}var N="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Y(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var U=0;function wt(t){var e=+new Date,n=Math.max(0,16-(e-U));return U=e+n,window.setTimeout(t,n)}var Dt=window.requestAnimationFrame||Y("RequestAnimationFrame")||wt,kt=window.cancelAnimationFrame||Y("CancelAnimationFrame")||Y("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function it(t,e,n){if(n&&Dt===wt)t.call(e);else return Dt.call(window,m(t,e))}function st(t){t&&kt.call(window,t)}var rn={__proto__:null,extend:u,create:f,bind:m,get lastId(){return v},stamp:_,throttle:b,wrapNum:I,falseFn:E,formatNum:Z,trim:B,splitWords:O,setOptions:A,getParamString:G,template:C,isArray:w,indexOf:P,emptyImageUrl:N,requestFn:Dt,cancelFn:kt,requestAnimFrame:it,cancelAnimFrame:st};function gt(){}gt.extend=function(t){var e=function(){A(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},n=e.__super__=this.prototype,i=f(n);i.constructor=e,e.prototype=i;for(var o in this)Object.prototype.hasOwnProperty.call(this,o)&&o!=="prototype"&&o!=="__super__"&&(e[o]=this[o]);return t.statics&&u(e,t.statics),t.includes&&(Ce(t.includes),u.apply(null,[i].concat(t.includes))),u(i,t),delete i.statics,delete i.includes,i.options&&(i.options=n.options?f(n.options):{},u(i.options,t.options)),i._initHooks=[],i.callInitHooks=function(){if(!this._initHooksCalled){n.callInitHooks&&n.callInitHooks.call(this),this._initHooksCalled=!0;for(var l=0,h=i._initHooks.length;l<h;l++)i._initHooks[l].call(this)}},e},gt.include=function(t){var e=this.prototype.options;return u(this.prototype,t),t.options&&(this.prototype.options=e,this.mergeOptions(t.options)),this},gt.mergeOptions=function(t){return u(this.prototype.options,t),this},gt.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n=typeof t=="function"?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};function Ce(t){if(!(typeof L>"u"||!L||!L.Mixin)){t=w(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ht={on:function(t,e,n){if(typeof t=="object")for(var i in t)this._on(i,t[i],e);else{t=O(t);for(var o=0,l=t.length;o<l;o++)this._on(t[o],e,n)}return this},off:function(t,e,n){if(!arguments.length)delete this._events;else if(typeof t=="object")for(var i in t)this._off(i,t[i],e);else{t=O(t);for(var o=arguments.length===1,l=0,h=t.length;l<h;l++)o?this._off(t[l]):this._off(t[l],e,n)}return this},_on:function(t,e,n,i){if(typeof e!="function"){console.warn("wrong listener type: "+typeof e);return}if(this._listens(t,e,n)===!1){n===this&&(n=void 0);var o={fn:e,ctx:n};i&&(o.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(o)}},_off:function(t,e,n){var i,o,l;if(this._events&&(i=this._events[t],!!i)){if(arguments.length===1){if(this._firingCount)for(o=0,l=i.length;o<l;o++)i[o].fn=E;delete this._events[t];return}if(typeof e!="function"){console.warn("wrong listener type: "+typeof e);return}var h=this._listens(t,e,n);if(h!==!1){var d=i[h];this._firingCount&&(d.fn=E,this._events[t]=i=i.slice()),i.splice(h,1)}}},fire:function(t,e,n){if(!this.listens(t,n))return this;var i=u({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var o=this._events[t];if(o){this._firingCount=this._firingCount+1||1;for(var l=0,h=o.length;l<h;l++){var d=o[l],p=d.fn;d.once&&this.off(t,p,d.ctx),p.call(d.ctx||this,i)}this._firingCount--}}return n&&this._propagateEvent(i),this},listens:function(t,e,n,i){typeof t!="string"&&console.warn('"string" type argument expected');var o=e;typeof e!="function"&&(i=!!e,o=void 0,n=void 0);var l=this._events&&this._events[t];if(l&&l.length&&this._listens(t,o,n)!==!1)return!0;if(i){for(var h in this._eventParents)if(this._eventParents[h].listens(t,e,n,i))return!0}return!1},_listens:function(t,e,n){if(!this._events)return!1;var i=this._events[t]||[];if(!e)return!!i.length;n===this&&(n=void 0);for(var o=0,l=i.length;o<l;o++)if(i[o].fn===e&&i[o].ctx===n)return o;return!1},once:function(t,e,n){if(typeof t=="object")for(var i in t)this._on(i,t[i],e,!0);else{t=O(t);for(var o=0,l=t.length;o<l;o++)this._on(t[o],e,n,!0)}return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[_(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[_(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,u({layer:t.target,propagatedFrom:t.target},t),!0)}};ht.addEventListener=ht.on,ht.removeEventListener=ht.clearAllEventListeners=ht.off,ht.addOneTimeEventListener=ht.once,ht.fireEvent=ht.fire,ht.hasEventListeners=ht.listens;var Rt=gt.extend(ht);function k(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e}var ce=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};k.prototype={clone:function(){return new k(this.x,this.y)},add:function(t){return this.clone()._add(D(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(D(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new k(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new k(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ce(this.x),this.y=ce(this.y),this},distanceTo:function(t){t=D(t);var e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return t=D(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=D(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+Z(this.x)+", "+Z(this.y)+")"}};function D(t,e,n){return t instanceof k?t:w(t)?new k(t[0],t[1]):t==null?t:typeof t=="object"&&"x"in t&&"y"in t?new k(t.x,t.y):new k(t,e,n)}function $(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;i<o;i++)this.extend(n[i])}$.prototype={extend:function(t){var e,n;if(!t)return this;if(t instanceof k||typeof t[0]=="number"||"x"in t)e=n=D(t);else if(t=ut(t),e=t.min,n=t.max,!e||!n)return this;return!this.min&&!this.max?(this.min=e.clone(),this.max=n.clone()):(this.min.x=Math.min(e.x,this.min.x),this.max.x=Math.max(n.x,this.max.x),this.min.y=Math.min(e.y,this.min.y),this.max.y=Math.max(n.y,this.max.y)),this},getCenter:function(t){return D((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return D(this.min.x,this.max.y)},getTopRight:function(){return D(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return typeof t[0]=="number"||t instanceof k?t=D(t):t=ut(t),t instanceof $?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=ut(t);var e=this.min,n=this.max,i=t.min,o=t.max,l=o.x>=e.x&&i.x<=n.x,h=o.y>=e.y&&i.y<=n.y;return l&&h},overlaps:function(t){t=ut(t);var e=this.min,n=this.max,i=t.min,o=t.max,l=o.x>e.x&&i.x<n.x,h=o.y>e.y&&i.y<n.y;return l&&h},isValid:function(){return!!(this.min&&this.max)},pad:function(t){var e=this.min,n=this.max,i=Math.abs(e.x-n.x)*t,o=Math.abs(e.y-n.y)*t;return ut(D(e.x-i,e.y-o),D(n.x+i,n.y+o))},equals:function(t){return t?(t=ut(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight())):!1}};function ut(t,e){return!t||t instanceof $?t:new $(t,e)}function dt(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;i<o;i++)this.extend(n[i])}dt.prototype={extend:function(t){var e=this._southWest,n=this._northEast,i,o;if(t instanceof V)i=t,o=t;else if(t instanceof dt){if(i=t._southWest,o=t._northEast,!i||!o)return this}else return t?this.extend(F(t)||tt(t)):this;return!e&&!n?(this._southWest=new V(i.lat,i.lng),this._northEast=new V(o.lat,o.lng)):(e.lat=Math.min(i.lat,e.lat),e.lng=Math.min(i.lng,e.lng),n.lat=Math.max(o.lat,n.lat),n.lng=Math.max(o.lng,n.lng)),this},pad:function(t){var e=this._southWest,n=this._northEast,i=Math.abs(e.lat-n.lat)*t,o=Math.abs(e.lng-n.lng)*t;return new dt(new V(e.lat-i,e.lng-o),new V(n.lat+i,n.lng+o))},getCenter:function(){return new V((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new V(this.getNorth(),this.getWest())},getSouthEast:function(){return new V(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){typeof t[0]=="number"||t instanceof V||"lat"in t?t=F(t):t=tt(t);var e=this._southWest,n=this._northEast,i,o;return t instanceof dt?(i=t.getSouthWest(),o=t.getNorthEast()):i=o=t,i.lat>=e.lat&&o.lat<=n.lat&&i.lng>=e.lng&&o.lng<=n.lng},intersects:function(t){t=tt(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),o=t.getNorthEast(),l=o.lat>=e.lat&&i.lat<=n.lat,h=o.lng>=e.lng&&i.lng<=n.lng;return l&&h},overlaps:function(t){t=tt(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),o=t.getNorthEast(),l=o.lat>e.lat&&i.lat<n.lat,h=o.lng>e.lng&&i.lng<n.lng;return l&&h},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return t?(t=tt(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function tt(t,e){return t instanceof dt?t:new dt(t,e)}function V(t,e,n){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,n!==void 0&&(this.alt=+n)}V.prototype={equals:function(t,e){if(!t)return!1;t=F(t);var n=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return n<=(e===void 0?1e-9:e)},toString:function(t){return"LatLng("+Z(this.lat,t)+", "+Z(this.lng,t)+")"},distanceTo:function(t){return Zt.distance(this,F(t))},wrap:function(){return Zt.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return tt([this.lat-e,this.lng-n],[this.lat+e,this.lng+n])},clone:function(){return new V(this.lat,this.lng,this.alt)}};function F(t,e,n){return t instanceof V?t:w(t)&&typeof t[0]!="object"?t.length===3?new V(t[0],t[1],t[2]):t.length===2?new V(t[0],t[1]):null:t==null?t:typeof t=="object"&&"lat"in t?new V(t.lat,"lng"in t?t.lng:t.lon,t.alt):e===void 0?null:new V(t,e,n)}var At={latLngToPoint:function(t,e){var n=this.projection.project(t),i=this.scale(e);return this.transformation._transform(n,i)},pointToLatLng:function(t,e){var n=this.scale(e),i=this.transformation.untransform(t,n);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,n=this.scale(t),i=this.transformation.transform(e.min,n),o=this.transformation.transform(e.max,n);return new $(i,o)},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?I(t.lng,this.wrapLng,!0):t.lng,n=this.wrapLat?I(t.lat,this.wrapLat,!0):t.lat,i=t.alt;return new V(n,e,i)},wrapLatLngBounds:function(t){var e=t.getCenter(),n=this.wrapLatLng(e),i=e.lat-n.lat,o=e.lng-n.lng;if(i===0&&o===0)return t;var l=t.getSouthWest(),h=t.getNorthEast(),d=new V(l.lat-i,l.lng-o),p=new V(h.lat-i,h.lng-o);return new dt(d,p)}},Zt=u({},At,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var n=Math.PI/180,i=t.lat*n,o=e.lat*n,l=Math.sin((e.lat-t.lat)*n/2),h=Math.sin((e.lng-t.lng)*n/2),d=l*l+Math.cos(i)*Math.cos(o)*h*h,p=2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d));return this.R*p}}),ri=6378137,sn={R:ri,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),o=Math.sin(i*e);return new k(this.R*t.lng*e,this.R*Math.log((1+o)/(1-o))/2)},unproject:function(t){var e=180/Math.PI;return new V((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:function(){var t=ri*Math.PI;return new $([-t,-t],[t,t])}()};function ln(t,e,n,i){if(w(t)){this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3];return}this._a=t,this._b=e,this._c=n,this._d=i}ln.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new k((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};function he(t,e,n,i){return new ln(t,e,n,i)}var cn=u({},Zt,{code:"EPSG:3857",projection:sn,transformation:function(){var t=.5/(Math.PI*sn.R);return he(t,.5,-t,.5)}()}),_a=u({},cn,{code:"EPSG:900913"});function si(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function li(t,e){var n="",i,o,l,h,d,p;for(i=0,l=t.length;i<l;i++){for(d=t[i],o=0,h=d.length;o<h;o++)p=d[o],n+=(o?"L":"M")+p.x+" "+p.y;n+=e?M.svg?"z":"x":""}return n||"M0 0"}var hn=document.documentElement.style,Se="ActiveXObject"in window,ga=Se&&!document.addEventListener,ci="msLaunchUri"in navigator&&!("documentMode"in document),un=Lt("webkit"),hi=Lt("android"),ui=Lt("android 2")||Lt("android 3"),va=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ya=hi&&Lt("Google")&&va<537&&!("AudioNode"in window),dn=!!window.opera,di=!ci&&Lt("chrome"),fi=Lt("gecko")&&!un&&!dn&&!Se,xa=!di&&Lt("safari"),pi=Lt("phantom"),mi="OTransition"in hn,wa=navigator.platform.indexOf("Win")===0,_i=Se&&"transition"in hn,fn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ui,gi="MozPerspective"in hn,Pa=!window.L_DISABLE_3D&&(_i||fn||gi)&&!mi&&!pi,ue=typeof orientation<"u"||Lt("mobile"),ba=ue&&un,Ta=ue&&fn,vi=!window.PointerEvent&&window.MSPointerEvent,yi=!!(window.PointerEvent||vi),xi="ontouchstart"in window||!!window.TouchEvent,La=!window.L_NO_TOUCH&&(xi||yi),Ma=ue&&dn,Ca=ue&&fi,Sa=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Ea=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",E,e),window.removeEventListener("testPassiveEventSupport",E,e)}catch{}return t}(),Oa=function(){return!!document.createElement("canvas").getContext}(),pn=!!(document.createElementNS&&si("svg").createSVGRect),Da=!!pn&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),ka=!pn&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&typeof e.adj=="object"}catch{return!1}}(),Aa=navigator.platform.indexOf("Mac")===0,Ia=navigator.platform.indexOf("Linux")===0;function Lt(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var M={ie:Se,ielt9:ga,edge:ci,webkit:un,android:hi,android23:ui,androidStock:ya,opera:dn,chrome:di,gecko:fi,safari:xa,phantom:pi,opera12:mi,win:wa,ie3d:_i,webkit3d:fn,gecko3d:gi,any3d:Pa,mobile:ue,mobileWebkit:ba,mobileWebkit3d:Ta,msPointer:vi,pointer:yi,touch:La,touchNative:xi,mobileOpera:Ma,mobileGecko:Ca,retina:Sa,passiveEvents:Ea,canvas:Oa,svg:pn,vml:ka,inlineSvg:Da,mac:Aa,linux:Ia},wi=M.msPointer?"MSPointerDown":"pointerdown",Pi=M.msPointer?"MSPointerMove":"pointermove",bi=M.msPointer?"MSPointerUp":"pointerup",Ti=M.msPointer?"MSPointerCancel":"pointercancel",mn={touchstart:wi,touchmove:Pi,touchend:bi,touchcancel:Ti},Li={touchstart:Ha,touchmove:Ee,touchend:Ee,touchcancel:Ee},Jt={},Mi=!1;function Na(t,e,n){return e==="touchstart"&&Za(),Li[e]?(n=Li[e].bind(this,n),t.addEventListener(mn[e],n,!1),n):(console.warn("wrong event specified:",e),E)}function za(t,e,n){if(!mn[e]){console.warn("wrong event specified:",e);return}t.removeEventListener(mn[e],n,!1)}function Ba(t){Jt[t.pointerId]=t}function Ra(t){Jt[t.pointerId]&&(Jt[t.pointerId]=t)}function Ci(t){delete Jt[t.pointerId]}function Za(){Mi||(document.addEventListener(wi,Ba,!0),document.addEventListener(Pi,Ra,!0),document.addEventListener(bi,Ci,!0),document.addEventListener(Ti,Ci,!0),Mi=!0)}function Ee(t,e){if(e.pointerType!==(e.MSPOINTER_TYPE_MOUSE||"mouse")){e.touches=[];for(var n in Jt)e.touches.push(Jt[n]);e.changedTouches=[e],t(e)}}function Ha(t,e){e.MSPOINTER_TYPE_TOUCH&&e.pointerType===e.MSPOINTER_TYPE_TOUCH&&at(e),Ee(t,e)}function Fa(t){var e={},n,i;for(i in t)n=t[i],e[i]=n&&n.bind?n.bind(t):n;return t=e,e.type="dblclick",e.detail=2,e.isTrusted=!1,e._simulated=!0,e}var ja=200;function Ua(t,e){t.addEventListener("dblclick",e);var n=0,i;function o(l){if(l.detail!==1){i=l.detail;return}if(!(l.pointerType==="mouse"||l.sourceCapabilities&&!l.sourceCapabilities.firesTouchEvents)){var h=ki(l);if(!(h.some(function(p){return p instanceof HTMLLabelElement&&p.attributes.for})&&!h.some(function(p){return p instanceof HTMLInputElement||p instanceof HTMLSelectElement}))){var d=Date.now();d-n<=ja?(i++,i===2&&e(Fa(l))):i=1,n=d}}}return t.addEventListener("click",o),{dblclick:e,simDblclick:o}}function Wa(t,e){t.removeEventListener("dblclick",e.dblclick),t.removeEventListener("click",e.simDblclick)}var _n=ke(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),de=ke(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Si=de==="webkitTransition"||de==="OTransition"?de+"End":"transitionend";function Ei(t){return typeof t=="string"?document.getElementById(t):t}function fe(t,e){var n=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!n||n==="auto")&&document.defaultView){var i=document.defaultView.getComputedStyle(t,null);n=i?i[e]:null}return n==="auto"?null:n}function W(t,e,n){var i=document.createElement(t);return i.className=e||"",n&&n.appendChild(i),i}function K(t){var e=t.parentNode;e&&e.removeChild(t)}function Oe(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function Qt(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function te(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function gn(t,e){if(t.classList!==void 0)return t.classList.contains(e);var n=De(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)}function R(t,e){if(t.classList!==void 0)for(var n=O(e),i=0,o=n.length;i<o;i++)t.classList.add(n[i]);else if(!gn(t,e)){var l=De(t);vn(t,(l?l+" ":"")+e)}}function Q(t,e){t.classList!==void 0?t.classList.remove(e):vn(t,B((" "+De(t)+" ").replace(" "+e+" "," ")))}function vn(t,e){t.className.baseVal===void 0?t.className=e:t.className.baseVal=e}function De(t){return t.correspondingElement&&(t=t.correspondingElement),t.className.baseVal===void 0?t.className:t.className.baseVal}function vt(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&Ga(t,e)}function Ga(t,e){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(i)}catch{if(e===1)return}e=Math.round(e*100),n?(n.Enabled=e!==100,n.Opacity=e):t.style.filter+=" progid:"+i+"(opacity="+e+")"}function ke(t){for(var e=document.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1}function Wt(t,e,n){var i=e||new k(0,0);t.style[_n]=(M.ie3d?"translate("+i.x+"px,"+i.y+"px)":"translate3d("+i.x+"px,"+i.y+"px,0)")+(n?" scale("+n+")":"")}function et(t,e){t._leaflet_pos=e,M.any3d?Wt(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function Gt(t){return t._leaflet_pos||new k(0,0)}var pe,me,yn;if("onselectstart"in document)pe=function(){z(window,"selectstart",at)},me=function(){q(window,"selectstart",at)};else{var _e=ke(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);pe=function(){if(_e){var t=document.documentElement.style;yn=t[_e],t[_e]="none"}},me=function(){_e&&(document.documentElement.style[_e]=yn,yn=void 0)}}function xn(){z(window,"dragstart",at)}function wn(){q(window,"dragstart",at)}var Ae,Pn;function bn(t){for(;t.tabIndex===-1;)t=t.parentNode;t.style&&(Ie(),Ae=t,Pn=t.style.outlineStyle,t.style.outlineStyle="none",z(window,"keydown",Ie))}function Ie(){Ae&&(Ae.style.outlineStyle=Pn,Ae=void 0,Pn=void 0,q(window,"keydown",Ie))}function Oi(t){do t=t.parentNode;while((!t.offsetWidth||!t.offsetHeight)&&t!==document.body);return t}function Tn(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var Va={__proto__:null,TRANSFORM:_n,TRANSITION:de,TRANSITION_END:Si,get:Ei,getStyle:fe,create:W,remove:K,empty:Oe,toFront:Qt,toBack:te,hasClass:gn,addClass:R,removeClass:Q,setClass:vn,getClass:De,setOpacity:vt,testProp:ke,setTransform:Wt,setPosition:et,getPosition:Gt,get disableTextSelection(){return pe},get enableTextSelection(){return me},disableImageDrag:xn,enableImageDrag:wn,preventOutline:bn,restoreOutline:Ie,getSizedParentNode:Oi,getScale:Tn};function z(t,e,n,i){if(e&&typeof e=="object")for(var o in e)Mn(t,o,e[o],n);else{e=O(e);for(var l=0,h=e.length;l<h;l++)Mn(t,e[l],n,i)}return this}var Mt="_leaflet_events";function q(t,e,n,i){if(arguments.length===1)Di(t),delete t[Mt];else if(e&&typeof e=="object")for(var o in e)Cn(t,o,e[o],n);else if(e=O(e),arguments.length===2)Di(t,function(d){return P(e,d)!==-1});else for(var l=0,h=e.length;l<h;l++)Cn(t,e[l],n,i);return this}function Di(t,e){for(var n in t[Mt]){var i=n.split(/\d/)[0];(!e||e(i))&&Cn(t,i,null,null,n)}}var Ln={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Mn(t,e,n,i){var o=e+_(n)+(i?"_"+_(i):"");if(t[Mt]&&t[Mt][o])return this;var l=function(d){return n.call(i||t,d||window.event)},h=l;!M.touchNative&&M.pointer&&e.indexOf("touch")===0?l=Na(t,e,l):M.touch&&e==="dblclick"?l=Ua(t,l):"addEventListener"in t?e==="touchstart"||e==="touchmove"||e==="wheel"||e==="mousewheel"?t.addEventListener(Ln[e]||e,l,M.passiveEvents?{passive:!1}:!1):e==="mouseenter"||e==="mouseleave"?(l=function(d){d=d||window.event,En(t,d)&&h(d)},t.addEventListener(Ln[e],l,!1)):t.addEventListener(e,h,!1):t.attachEvent("on"+e,l),t[Mt]=t[Mt]||{},t[Mt][o]=l}function Cn(t,e,n,i,o){o=o||e+_(n)+(i?"_"+_(i):"");var l=t[Mt]&&t[Mt][o];if(!l)return this;!M.touchNative&&M.pointer&&e.indexOf("touch")===0?za(t,e,l):M.touch&&e==="dblclick"?Wa(t,l):"removeEventListener"in t?t.removeEventListener(Ln[e]||e,l,!1):t.detachEvent("on"+e,l),t[Mt][o]=null}function Vt(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function Sn(t){return Mn(t,"wheel",Vt),this}function ge(t){return z(t,"mousedown touchstart dblclick contextmenu",Vt),t._leaflet_disable_click=!0,this}function at(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function qt(t){return at(t),Vt(t),this}function ki(t){if(t.composedPath)return t.composedPath();for(var e=[],n=t.target;n;)e.push(n),n=n.parentNode;return e}function Ai(t,e){if(!e)return new k(t.clientX,t.clientY);var n=Tn(e),i=n.boundingClientRect;return new k((t.clientX-i.left)/n.x-e.clientLeft,(t.clientY-i.top)/n.y-e.clientTop)}var qa=M.linux&&M.chrome?window.devicePixelRatio:M.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ii(t){return M.edge?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/qa:t.deltaY&&t.deltaMode===1?-t.deltaY*20:t.deltaY&&t.deltaMode===2?-t.deltaY*60:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?-t.detail*20:t.detail?t.detail/-32765*60:0}function En(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch{return!1}return n!==t}var Ya={__proto__:null,on:z,off:q,stopPropagation:Vt,disableScrollPropagation:Sn,disableClickPropagation:ge,preventDefault:at,stop:qt,getPropagationPath:ki,getMousePosition:Ai,getWheelDelta:Ii,isExternalTarget:En,addListener:z,removeListener:q},Ni=Rt.extend({run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=Gt(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=it(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,n=this._duration*1e3;e<n?this._runFrame(this._easeOut(e/n),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var n=this._startPos.add(this._offset.multiplyBy(t));e&&n._round(),et(this._el,n),this.fire("step")},_complete:function(){st(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),j=Rt.extend({options:{crs:cn,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=A(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=m(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.zoom!==void 0&&(this._zoom=this._limitZoom(e.zoom)),e.center&&e.zoom!==void 0&&this.setView(F(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=de&&M.any3d&&!M.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),z(this._proxy,Si,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,n){if(e=e===void 0?this._zoom:this._limitZoom(e),t=this._limitCenter(F(t),e,this.options.maxBounds),n=n||{},this._stop(),this._loaded&&!n.reset&&n!==!0){n.animate!==void 0&&(n.zoom=u({animate:n.animate},n.zoom),n.pan=u({animate:n.animate,duration:n.duration},n.pan));var i=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan);if(i)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e,n.pan&&n.pan.noMoveStart),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(M.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(M.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,n){var i=this.getZoomScale(e),o=this.getSize().divideBy(2),l=t instanceof k?t:this.latLngToContainerPoint(t),h=l.subtract(o).multiplyBy(1-1/i),d=this.containerPointToLatLng(o.add(h));return this.setView(d,e,{zoom:n})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():tt(t);var n=D(e.paddingTopLeft||e.padding||[0,0]),i=D(e.paddingBottomRight||e.padding||[0,0]),o=this.getBoundsZoom(t,!1,n.add(i));if(o=typeof e.maxZoom=="number"?Math.min(e.maxZoom,o):o,o===1/0)return{center:t.getCenter(),zoom:o};var l=i.subtract(n).divideBy(2),h=this.project(t.getSouthWest(),o),d=this.project(t.getNorthEast(),o),p=this.unproject(h.add(d).divideBy(2).add(l),o);return{center:p,zoom:o}},fitBounds:function(t,e){if(t=tt(t),!t.isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(t,e);return this.setView(n.center,n.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(t=D(t).round(),e=e||{},!t.x&&!t.y)return this.fire("moveend");if(e.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ni,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){R(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,n){if(n=n||{},n.animate===!1||!M.any3d)return this.setView(t,e,n);this._stop();var i=this.project(this.getCenter()),o=this.project(t),l=this.getSize(),h=this._zoom;t=F(t),e=e===void 0?h:e;var d=Math.max(l.x,l.y),p=d*this.getZoomScale(h,e),g=o.distanceTo(i)||1,y=1.42,S=y*y;function H(nt){var Ve=nt?-1:1,zr=nt?p:d,Br=p*p-d*d+Ve*S*S*g*g,Rr=2*zr*S*g,Hn=Br/Rr,_o=Math.sqrt(Hn*Hn+1)-Hn,Zr=_o<1e-9?-18:Math.log(_o);return Zr}function lt(nt){return(Math.exp(nt)-Math.exp(-nt))/2}function ot(nt){return(Math.exp(nt)+Math.exp(-nt))/2}function xt(nt){return lt(nt)/ot(nt)}var ft=H(0);function re(nt){return d*(ot(ft)/ot(ft+y*nt))}function kr(nt){return d*(ot(ft)*xt(ft+y*nt)-lt(ft))/S}function Ar(nt){return 1-Math.pow(1-nt,1.5)}var Ir=Date.now(),po=(H(1)-ft)/y,Nr=n.duration?1e3*n.duration:1e3*po*.8;function mo(){var nt=(Date.now()-Ir)/Nr,Ve=Ar(nt)*po;nt<=1?(this._flyToFrame=it(mo,this),this._move(this.unproject(i.add(o.subtract(i).multiplyBy(kr(Ve)/g)),h),this.getScaleZoom(d/re(Ve),h),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}return this._moveStart(!0,n.noMoveStart),mo.call(this),this},flyToBounds:function(t,e){var n=this._getBoundsCenterZoom(t,e);return this.flyTo(n.center,n.zoom,e)},setMaxBounds:function(t){return t=tt(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var n=this.getCenter(),i=this._limitCenter(n,this._zoom,tt(t));return n.equals(i)||this.panTo(i,e),this._enforcingBounds=!1,this},panInside:function(t,e){e=e||{};var n=D(e.paddingTopLeft||e.padding||[0,0]),i=D(e.paddingBottomRight||e.padding||[0,0]),o=this.project(this.getCenter()),l=this.project(t),h=this.getPixelBounds(),d=ut([h.min.add(n),h.max.subtract(i)]),p=d.getSize();if(!d.contains(l)){this._enforcingBounds=!0;var g=l.subtract(d.getCenter()),y=d.extend(l).getSize().subtract(p);o.x+=g.x<0?-y.x:y.x,o.y+=g.y<0?-y.y:y.y,this.panTo(this.unproject(o),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=u({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var n=this.getSize(),i=e.divideBy(2).round(),o=n.divideBy(2).round(),l=i.subtract(o);return!l.x&&!l.y?this:(t.animate&&t.pan?this.panBy(l):(t.pan&&this._rawPanBy(l),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(m(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:n}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=u({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=m(this._handleGeolocationResponse,this),n=m(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,n,t):navigator.geolocation.getCurrentPosition(e,n,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var e=t.code,n=t.message||(e===1?"permission denied":e===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var e=t.coords.latitude,n=t.coords.longitude,i=new V(e,n),o=i.toBounds(t.coords.accuracy*2),l=this._locateOptions;if(l.setView){var h=this.getBoundsZoom(o);this.setView(i,l.maxZoom?Math.min(h,l.maxZoom):h)}var d={latlng:i,bounds:o,timestamp:t.timestamp};for(var p in t.coords)typeof t.coords[p]=="number"&&(d[p]=t.coords[p]);this.fire("locationfound",d)}},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),K(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(st(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)K(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var n="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),i=W("div",n,e||this._mapPane);return t&&(this._panes[t]=i),i},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),n=this.unproject(t.getTopRight());return new dt(e,n)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=tt(t),n=D(n||[0,0]);var i=this.getZoom()||0,o=this.getMinZoom(),l=this.getMaxZoom(),h=t.getNorthWest(),d=t.getSouthEast(),p=this.getSize().subtract(n),g=ut(this.project(d,i),this.project(h,i)).getSize(),y=M.any3d?this.options.zoomSnap:1,S=p.x/g.x,H=p.y/g.y,lt=e?Math.max(S,H):Math.min(S,H);return i=this.getScaleZoom(lt,i),y&&(i=Math.round(i/(y/100))*(y/100),i=e?Math.ceil(i/y)*y:Math.floor(i/y)*y),Math.max(o,Math.min(l,i))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new k(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var n=this._getTopLeftPoint(t,e);return new $(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===void 0?this.getZoom():t)},getPane:function(t){return typeof t=="string"?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var n=this.options.crs;return e=e===void 0?this._zoom:e,n.scale(t)/n.scale(e)},getScaleZoom:function(t,e){var n=this.options.crs;e=e===void 0?this._zoom:e;var i=n.zoom(t*n.scale(e));return isNaN(i)?1/0:i},project:function(t,e){return e=e===void 0?this._zoom:e,this.options.crs.latLngToPoint(F(t),e)},unproject:function(t,e){return e=e===void 0?this._zoom:e,this.options.crs.pointToLatLng(D(t),e)},layerPointToLatLng:function(t){var e=D(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(F(t))._round();return e._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(F(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(tt(t))},distance:function(t,e){return this.options.crs.distance(F(t),F(e))},containerPointToLayerPoint:function(t){return D(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return D(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(D(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(F(t)))},mouseEventToContainerPoint:function(t){return Ai(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=Ei(t);if(e){if(e._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");z(e,"scroll",this._onScroll,this),this._containerId=_(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&M.any3d,R(t,"leaflet-container"+(M.touch?" leaflet-touch":"")+(M.retina?" leaflet-retina":"")+(M.ielt9?" leaflet-oldie":"")+(M.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=fe(t,"position");e!=="absolute"&&e!=="relative"&&e!=="fixed"&&e!=="sticky"&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),et(this._mapPane,new k(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(R(t.markerPane,"leaflet-zoom-hide"),R(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e,n){et(this._mapPane,new k(0,0));var i=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var o=this._zoom!==e;this._moveStart(o,n)._move(t,e)._moveEnd(o),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,n,i){e===void 0&&(e=this._zoom);var o=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),i?n&&n.pinch&&this.fire("zoom",n):((o||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return st(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){et(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[_(this._container)]=this;var e=t?q:z;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),M.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){st(this._resizeRequest),this._resizeRequest=it(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var n=[],i,o=e==="mouseout"||e==="mouseover",l=t.target||t.srcElement,h=!1;l;){if(i=this._targets[_(l)],i&&(e==="click"||e==="preclick")&&this._draggableMoved(i)){h=!0;break}if(i&&i.listens(e,!0)&&(o&&!En(l,t)||(n.push(i),o))||l===this._container)break;l=l.parentNode}return!n.length&&!h&&!o&&this.listens(e,!0)&&(n=[this]),n},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var e=t.target||t.srcElement;if(!(!this._loaded||e._leaflet_disable_events||t.type==="click"&&this._isClickDisabled(e))){var n=t.type;n==="mousedown"&&bn(e),this._fireDOMEvent(t,n)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,n){if(t.type==="click"){var i=u({},t);i.type="preclick",this._fireDOMEvent(i,i.type,n)}var o=this._findEventTargets(t,e);if(n){for(var l=[],h=0;h<n.length;h++)n[h].listens(e,!0)&&l.push(n[h]);o=l.concat(o)}if(o.length){e==="contextmenu"&&at(t);var d=o[0],p={originalEvent:t};if(t.type!=="keypress"&&t.type!=="keydown"&&t.type!=="keyup"){var g=d.getLatLng&&(!d._radius||d._radius<=10);p.containerPoint=g?this.latLngToContainerPoint(d.getLatLng()):this.mouseEventToContainerPoint(t),p.layerPoint=this.containerPointToLayerPoint(p.containerPoint),p.latlng=g?d.getLatLng():this.layerPointToLatLng(p.layerPoint)}for(h=0;h<o.length;h++)if(o[h].fire(e,p,!0),p.originalEvent._stopped||o[h].options.bubblingMouseEvents===!1&&P(this._mouseEvents,e)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return Gt(this._mapPane)||new k(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){var n=t&&e!==void 0?this._getNewPixelOrigin(t,e):this.getPixelOrigin();return n.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return this.project(t,e)._subtract(i)},_latLngBoundsToNewLayerBounds:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return ut([this.project(t.getSouthWest(),e)._subtract(i),this.project(t.getNorthWest(),e)._subtract(i),this.project(t.getSouthEast(),e)._subtract(i),this.project(t.getNorthEast(),e)._subtract(i)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var i=this.project(t,e),o=this.getSize().divideBy(2),l=new $(i.subtract(o),i.add(o)),h=this._getBoundsOffset(l,n,e);return Math.abs(h.x)<=1&&Math.abs(h.y)<=1?t:this.unproject(i.add(h),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),i=new $(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(i,e))},_getBoundsOffset:function(t,e,n){var i=ut(this.project(e.getNorthEast(),n),this.project(e.getSouthWest(),n)),o=i.min.subtract(t.min),l=i.max.subtract(t.max),h=this._rebound(o.x,-l.x),d=this._rebound(o.y,-l.y);return new k(h,d)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom(),i=M.any3d?this.options.zoomSnap:1;return i&&(t=Math.round(t/i)*i),Math.max(e,Math.min(n,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Q(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._trunc();return(e&&e.animate)!==!0&&!this.getSize().contains(n)?!1:(this.panBy(n,e),!0)},_createAnimProxy:function(){var t=this._proxy=W("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(e){var n=_n,i=this._proxy.style[n];Wt(this._proxy,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),i===this._proxy.style[n]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){K(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();Wt(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||n.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/i);return n.animate!==!0&&!this.getSize().contains(o)?!1:(it(function(){this._moveStart(!0,n.noMoveStart||!1)._animateZoom(t,e,!0)},this),!0)},_animateZoom:function(t,e,n,i){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,R(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:i}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(m(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Q(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Xa(t,e){return new j(t,e)}var Pt=gt.extend({options:{position:"topright"},initialize:function(t){A(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),i=t._controlCorners[n];return R(e,"leaflet-control"),n.indexOf("bottom")!==-1?i.insertBefore(e,i.firstChild):i.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(K(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),ve=function(t){return new Pt(t)};j.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",n=this._controlContainer=W("div",e+"control-container",this._container);function i(o,l){var h=e+o+" "+e+l;t[o+l]=W("div",h,n)}i("top","left"),i("top","right"),i("bottom","left"),i("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)K(this._controlCorners[t]);K(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var zi=Pt.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,n,i){return n<i?-1:i<n?1:0}},initialize:function(t,e,n){A(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var i in t)this._addLayer(t[i],i);for(i in e)this._addLayer(e[i],i,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return Pt.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(_(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){R(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(R(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):Q(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Q(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=W("div",t),n=this.options.collapsed;e.setAttribute("aria-haspopup",!0),ge(e),Sn(e);var i=this._section=W("section",t+"-list");n&&(this._map.on("click",this.collapse,this),z(e,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var o=this._layersLink=W("a",t+"-toggle",e);o.href="#",o.title="Layers",o.setAttribute("role","button"),z(o,{keydown:function(l){l.keyCode===13&&this._expandSafely()},click:function(l){at(l),this._expandSafely()}},this),n||this.expand(),this._baseLayersList=W("div",t+"-base",i),this._separator=W("div",t+"-separator",i),this._overlaysList=W("div",t+"-overlays",i),e.appendChild(i)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&_(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,n){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:n}),this.options.sortLayers&&this._layers.sort(m(function(i,o){return this.options.sortFunction(i.layer,o.layer,i.name,o.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Oe(this._baseLayersList),Oe(this._overlaysList),this._layerControlInputs=[];var t,e,n,i,o=0;for(n=0;n<this._layers.length;n++)i=this._layers[n],this._addItem(i),e=e||i.overlay,t=t||!i.overlay,o+=i.overlay?0:1;return this.options.hideSingleBase&&(t=t&&o>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(_(t.target)),n=e.overlay?t.type==="add"?"overlayadd":"overlayremove":t.type==="add"?"baselayerchange":null;n&&this._map.fire(n,e)},_createRadioElement:function(t,e){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",i=document.createElement("div");return i.innerHTML=n,i.firstChild},_addItem:function(t){var e=document.createElement("label"),n=this._map.hasLayer(t.layer),i;t.overlay?(i=document.createElement("input"),i.type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=n):i=this._createRadioElement("leaflet-base-layers_"+_(this),n),this._layerControlInputs.push(i),i.layerId=_(t.layer),z(i,"click",this._onInputClick,this);var o=document.createElement("span");o.innerHTML=" "+t.name;var l=document.createElement("span");e.appendChild(l),l.appendChild(i),l.appendChild(o);var h=t.overlay?this._overlaysList:this._baseLayersList;return h.appendChild(e),this._checkDisabledLayers(),e},_onInputClick:function(){if(!this._preventClick){var t=this._layerControlInputs,e,n,i=[],o=[];this._handlingClick=!0;for(var l=t.length-1;l>=0;l--)e=t[l],n=this._getLayer(e.layerId).layer,e.checked?i.push(n):e.checked||o.push(n);for(l=0;l<o.length;l++)this._map.hasLayer(o[l])&&this._map.removeLayer(o[l]);for(l=0;l<i.length;l++)this._map.hasLayer(i[l])||this._map.addLayer(i[l]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t=this._layerControlInputs,e,n,i=this._map.getZoom(),o=t.length-1;o>=0;o--)e=t[o],n=this._getLayer(e.layerId).layer,e.disabled=n.options.minZoom!==void 0&&i<n.options.minZoom||n.options.maxZoom!==void 0&&i>n.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,z(t,"click",at),this.expand();var e=this;setTimeout(function(){q(t,"click",at),e._preventClick=!1})}}),$a=function(t,e,n){return new zi(t,e,n)},On=Pt.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=W("div",e+" leaflet-bar"),i=this.options;return this._zoomInButton=this._createButton(i.zoomInText,i.zoomInTitle,e+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(i.zoomOutText,i.zoomOutTitle,e+"-out",n,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,n,i,o){var l=W("a",n,i);return l.innerHTML=t,l.href="#",l.title=e,l.setAttribute("role","button"),l.setAttribute("aria-label",e),ge(l),z(l,"click",qt),z(l,"click",o,this),z(l,"click",this._refocusOnMap,this),l},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";Q(this._zoomInButton,e),Q(this._zoomOutButton,e),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(R(this._zoomOutButton,e),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(R(this._zoomInButton,e),this._zoomInButton.setAttribute("aria-disabled","true"))}});j.mergeOptions({zoomControl:!0}),j.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new On,this.addControl(this.zoomControl))});var Ka=function(t){return new On(t)},Bi=Pt.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e="leaflet-control-scale",n=W("div",e),i=this.options;return this._addScales(i,e+"-line",n),t.on(i.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=W("div",e,n)),t.imperial&&(this._iScale=W("div",e,n))},_update:function(){var t=this._map,e=t.getSize().y/2,n=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(n)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),n=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,n,e/t)},_updateImperial:function(t){var e=t*3.2808399,n,i,o;e>5280?(n=e/5280,i=this._getRoundNum(n),this._updateScale(this._iScale,i+" mi",i/n)):(o=this._getRoundNum(e),this._updateScale(this._iScale,o+" ft",o/e))},_updateScale:function(t,e,n){t.style.width=Math.round(this.options.maxWidth*n)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1,e*n}}),Ja=function(t){return new Bi(t)},Qa='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Dn=Pt.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(M.inlineSvg?Qa+" ":"")+"Leaflet</a>"},initialize:function(t){A(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=W("div","leaflet-control-attribution"),ge(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(' <span aria-hidden="true">|</span> ')}}});j.mergeOptions({attributionControl:!0}),j.addInitHook(function(){this.options.attributionControl&&new Dn().addTo(this)});var tr=function(t){return new Dn(t)};Pt.Layers=zi,Pt.Zoom=On,Pt.Scale=Bi,Pt.Attribution=Dn,ve.layers=$a,ve.zoom=Ka,ve.scale=Ja,ve.attribution=tr;var Ct=gt.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ct.addTo=function(t,e){return t.addHandler(e,this),this};var er={Events:ht},Ri=M.touch?"touchstart mousedown":"mousedown",Ht=Rt.extend({options:{clickTolerance:3},initialize:function(t,e,n,i){A(this,i),this._element=t,this._dragStartTarget=e||t,this._preventOutline=n},enable:function(){this._enabled||(z(this._dragStartTarget,Ri,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Ht._dragging===this&&this.finishDrag(!0),q(this._dragStartTarget,Ri,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!gn(this._element,"leaflet-zoom-anim"))){if(t.touches&&t.touches.length!==1){Ht._dragging===this&&this.finishDrag();return}if(!(Ht._dragging||t.shiftKey||t.which!==1&&t.button!==1&&!t.touches)&&(Ht._dragging=this,this._preventOutline&&bn(this._element),xn(),pe(),!this._moving)){this.fire("down");var e=t.touches?t.touches[0]:t,n=Oi(this._element);this._startPoint=new k(e.clientX,e.clientY),this._startPos=Gt(this._element),this._parentScale=Tn(n);var i=t.type==="mousedown";z(document,i?"mousemove":"touchmove",this._onMove,this),z(document,i?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(t){if(this._enabled){if(t.touches&&t.touches.length>1){this._moved=!0;return}var e=t.touches&&t.touches.length===1?t.touches[0]:t,n=new k(e.clientX,e.clientY)._subtract(this._startPoint);!n.x&&!n.y||Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(n.x/=this._parentScale.x,n.y/=this._parentScale.y,at(t),this._moved||(this.fire("dragstart"),this._moved=!0,R(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),R(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,this._lastEvent=t,this._updatePosition())}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),et(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){Q(document.body,"leaflet-dragging"),this._lastTarget&&(Q(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),q(document,"mousemove touchmove",this._onMove,this),q(document,"mouseup touchend touchcancel",this._onUp,this),wn(),me();var e=this._moved&&this._moving;this._moving=!1,Ht._dragging=!1,e&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function Zi(t,e,n){var i,o=[1,4,2,8],l,h,d,p,g,y,S,H;for(l=0,y=t.length;l<y;l++)t[l]._code=Yt(t[l],e);for(d=0;d<4;d++){for(S=o[d],i=[],l=0,y=t.length,h=y-1;l<y;h=l++)p=t[l],g=t[h],p._code&S?g._code&S||(H=Ne(g,p,S,e,n),H._code=Yt(H,e),i.push(H)):(g._code&S&&(H=Ne(g,p,S,e,n),H._code=Yt(H,e),i.push(H)),i.push(p));t=i}return t}function Hi(t,e){var n,i,o,l,h,d,p,g,y;if(!t||t.length===0)throw new Error("latlngs not passed");yt(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var S=F([0,0]),H=tt(t),lt=H.getNorthWest().distanceTo(H.getSouthWest())*H.getNorthEast().distanceTo(H.getNorthWest());lt<1700&&(S=kn(t));var ot=t.length,xt=[];for(n=0;n<ot;n++){var ft=F(t[n]);xt.push(e.project(F([ft.lat-S.lat,ft.lng-S.lng])))}for(d=p=g=0,n=0,i=ot-1;n<ot;i=n++)o=xt[n],l=xt[i],h=o.y*l.x-l.y*o.x,p+=(o.x+l.x)*h,g+=(o.y+l.y)*h,d+=h*3;d===0?y=xt[0]:y=[p/d,g/d];var re=e.unproject(D(y));return F([re.lat+S.lat,re.lng+S.lng])}function kn(t){for(var e=0,n=0,i=0,o=0;o<t.length;o++){var l=F(t[o]);e+=l.lat,n+=l.lng,i++}return F([e/i,n/i])}var nr={__proto__:null,clipPolygon:Zi,polygonCenter:Hi,centroid:kn};function Fi(t,e){if(!e||!t.length)return t.slice();var n=e*e;return t=ar(t,n),t=or(t,n),t}function ji(t,e,n){return Math.sqrt(ye(t,e,n,!0))}function ir(t,e,n){return ye(t,e,n)}function or(t,e){var n=t.length,i=typeof Uint8Array<"u"?Uint8Array:Array,o=new i(n);o[0]=o[n-1]=1,An(t,o,e,0,n-1);var l,h=[];for(l=0;l<n;l++)o[l]&&h.push(t[l]);return h}function An(t,e,n,i,o){var l=0,h,d,p;for(d=i+1;d<=o-1;d++)p=ye(t[d],t[i],t[o],!0),p>l&&(h=d,l=p);l>n&&(e[h]=1,An(t,e,n,i,h),An(t,e,n,h,o))}function ar(t,e){for(var n=[t[0]],i=1,o=0,l=t.length;i<l;i++)rr(t[i],t[o])>e&&(n.push(t[i]),o=i);return o<l-1&&n.push(t[l-1]),n}var Ui;function Wi(t,e,n,i,o){var l=i?Ui:Yt(t,n),h=Yt(e,n),d,p,g;for(Ui=h;;){if(!(l|h))return[t,e];if(l&h)return!1;d=l||h,p=Ne(t,e,d,n,o),g=Yt(p,n),d===l?(t=p,l=g):(e=p,h=g)}}function Ne(t,e,n,i,o){var l=e.x-t.x,h=e.y-t.y,d=i.min,p=i.max,g,y;return n&8?(g=t.x+l*(p.y-t.y)/h,y=p.y):n&4?(g=t.x+l*(d.y-t.y)/h,y=d.y):n&2?(g=p.x,y=t.y+h*(p.x-t.x)/l):n&1&&(g=d.x,y=t.y+h*(d.x-t.x)/l),new k(g,y,o)}function Yt(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n}function rr(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i}function ye(t,e,n,i){var o=e.x,l=e.y,h=n.x-o,d=n.y-l,p=h*h+d*d,g;return p>0&&(g=((t.x-o)*h+(t.y-l)*d)/p,g>1?(o=n.x,l=n.y):g>0&&(o+=h*g,l+=d*g)),h=t.x-o,d=t.y-l,i?h*h+d*d:new k(o,l)}function yt(t){return!w(t[0])||typeof t[0][0]!="object"&&typeof t[0][0]<"u"}function Gi(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),yt(t)}function Vi(t,e){var n,i,o,l,h,d,p,g;if(!t||t.length===0)throw new Error("latlngs not passed");yt(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var y=F([0,0]),S=tt(t),H=S.getNorthWest().distanceTo(S.getSouthWest())*S.getNorthEast().distanceTo(S.getNorthWest());H<1700&&(y=kn(t));var lt=t.length,ot=[];for(n=0;n<lt;n++){var xt=F(t[n]);ot.push(e.project(F([xt.lat-y.lat,xt.lng-y.lng])))}for(n=0,i=0;n<lt-1;n++)i+=ot[n].distanceTo(ot[n+1])/2;if(i===0)g=ot[0];else for(n=0,l=0;n<lt-1;n++)if(h=ot[n],d=ot[n+1],o=h.distanceTo(d),l+=o,l>i){p=(l-i)/o,g=[d.x-p*(d.x-h.x),d.y-p*(d.y-h.y)];break}var ft=e.unproject(D(g));return F([ft.lat+y.lat,ft.lng+y.lng])}var sr={__proto__:null,simplify:Fi,pointToSegmentDistance:ji,closestPointOnSegment:ir,clipSegment:Wi,_getEdgeIntersection:Ne,_getBitCode:Yt,_sqClosestPointOnSegment:ye,isFlat:yt,_flat:Gi,polylineCenter:Vi},In={project:function(t){return new k(t.lng,t.lat)},unproject:function(t){return new V(t.y,t.x)},bounds:new $([-180,-90],[180,90])},Nn={R:6378137,R_MINOR:6356752314245179e-9,bounds:new $([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(t){var e=Math.PI/180,n=this.R,i=t.lat*e,o=this.R_MINOR/n,l=Math.sqrt(1-o*o),h=l*Math.sin(i),d=Math.tan(Math.PI/4-i/2)/Math.pow((1-h)/(1+h),l/2);return i=-n*Math.log(Math.max(d,1e-10)),new k(t.lng*e*n,i)},unproject:function(t){for(var e=180/Math.PI,n=this.R,i=this.R_MINOR/n,o=Math.sqrt(1-i*i),l=Math.exp(-t.y/n),h=Math.PI/2-2*Math.atan(l),d=0,p=.1,g;d<15&&Math.abs(p)>1e-7;d++)g=o*Math.sin(h),g=Math.pow((1-g)/(1+g),o/2),p=Math.PI/2-2*Math.atan(l*g)-h,h+=p;return new V(h*e,t.x*e/n)}},lr={__proto__:null,LonLat:In,Mercator:Nn,SphericalMercator:sn},cr=u({},Zt,{code:"EPSG:3395",projection:Nn,transformation:function(){var t=.5/(Math.PI*Nn.R);return he(t,.5,-t,.5)}()}),qi=u({},Zt,{code:"EPSG:4326",projection:In,transformation:he(1/180,1,-1/180,.5)}),hr=u({},At,{projection:In,transformation:he(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var n=e.lng-t.lng,i=e.lat-t.lat;return Math.sqrt(n*n+i*i)},infinite:!0});At.Earth=Zt,At.EPSG3395=cr,At.EPSG3857=cn,At.EPSG900913=_a,At.EPSG4326=qi,At.Simple=hr;var bt=Rt.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[_(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[_(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var n=this.getEvents();e.on(n,this),this.once("remove",function(){e.off(n,this)},this)}this.onAdd(e),this.fire("add"),e.fire("layeradd",{layer:this})}}});j.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=_(t);return this._layers[e]?this:(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var e=_(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return _(t)in this._layers},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},_addLayers:function(t){t=t?w(t)?t:[t]:[];for(var e=0,n=t.length;e<n;e++)this.addLayer(t[e])},_addZoomLimit:function(t){(!isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[_(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=_(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,n=this._getZoomSpan();for(var i in this._zoomBoundLayers){var o=this._zoomBoundLayers[i].options;t=o.minZoom===void 0?t:Math.min(t,o.minZoom),e=o.maxZoom===void 0?e:Math.max(e,o.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ee=bt.extend({initialize:function(t,e){A(this,e),this._layers={};var n,i;if(t)for(n=0,i=t.length;n<i;n++)this.addLayer(t[n])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){var e=typeof t=="number"?t:this.getLayerId(t);return e in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e=Array.prototype.slice.call(arguments,1),n,i;for(n in this._layers)i=this._layers[n],i[t]&&i[t].apply(i,e);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return _(t)}}),ur=function(t,e){return new ee(t,e)},It=ee.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),ee.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),ee.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new dt;for(var e in this._layers){var n=this._layers[e];t.extend(n.getBounds?n.getBounds():n.getLatLng())}return t}}),dr=function(t,e){return new It(t,e)},ne=gt.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){A(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if(t==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i=this._createImg(n,e&&e.tagName==="IMG"?e:null);return this._setIconStyles(i,t),(this.options.crossOrigin||this.options.crossOrigin==="")&&(i.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),i},_setIconStyles:function(t,e){var n=this.options,i=n[e+"Size"];typeof i=="number"&&(i=[i,i]);var o=D(i),l=D(e==="shadow"&&n.shadowAnchor||n.iconAnchor||o&&o.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(n.className||""),l&&(t.style.marginLeft=-l.x+"px",t.style.marginTop=-l.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,e){return e=e||document.createElement("img"),e.src=t,e},_getIconUrl:function(t){return M.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function fr(t){return new ne(t)}var xe=ne.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return typeof xe.imagePath!="string"&&(xe.imagePath=this._detectIconPath()),(this.options.imagePath||xe.imagePath)+ne.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var e=function(n,i,o){var l=i.exec(n);return l&&l[o]};return t=e(t,/^url\((['"])?(.+)\1\)$/,2),t&&e(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=W("div","leaflet-default-icon-path",document.body),e=fe(t,"background-image")||fe(t,"backgroundImage");if(document.body.removeChild(t),e=this._stripUrl(e),e)return e;var n=document.querySelector('link[href$="leaflet.css"]');return n?n.href.substring(0,n.href.length-11-1):""}}),Yi=Ct.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new Ht(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),R(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Q(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,n=e._map,i=this._marker.options.autoPanSpeed,o=this._marker.options.autoPanPadding,l=Gt(e._icon),h=n.getPixelBounds(),d=n.getPixelOrigin(),p=ut(h.min._subtract(d).add(o),h.max._subtract(d).subtract(o));if(!p.contains(l)){var g=D((Math.max(p.max.x,l.x)-p.max.x)/(h.max.x-p.max.x)-(Math.min(p.min.x,l.x)-p.min.x)/(h.min.x-p.min.x),(Math.max(p.max.y,l.y)-p.max.y)/(h.max.y-p.max.y)-(Math.min(p.min.y,l.y)-p.min.y)/(h.min.y-p.min.y)).multiplyBy(i);n.panBy(g,{animate:!1}),this._draggable._newPos._add(g),this._draggable._startPos._add(g),et(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=it(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(st(this._panRequest),this._panRequest=it(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,n=e._shadow,i=Gt(e._icon),o=e._map.layerPointToLatLng(i);n&&et(n,i),e._latlng=o,t.latlng=o,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){st(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),ze=bt.extend({options:{icon:new xe,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){A(this,e),this._latlng=F(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=F(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=t.icon.createIcon(this._icon),i=!1;n!==this._icon&&(this._icon&&this._removeIcon(),i=!0,t.title&&(n.title=t.title),n.tagName==="IMG"&&(n.alt=t.alt||"")),R(n,e),t.keyboard&&(n.tabIndex="0",n.setAttribute("role","button")),this._icon=n,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&z(n,"focus",this._panOnFocus,this);var o=t.icon.createShadow(this._shadow),l=!1;o!==this._shadow&&(this._removeShadow(),l=!0),o&&(R(o,e),o.alt=""),this._shadow=o,t.opacity<1&&this._updateOpacity(),i&&this.getPane().appendChild(this._icon),this._initInteraction(),o&&l&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&q(this._icon,"focus",this._panOnFocus,this),K(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&K(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&et(this._icon,t),this._shadow&&et(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(R(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Yi)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Yi(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&vt(this._icon,t),this._shadow&&vt(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var e=this.options.icon.options,n=e.iconSize?D(e.iconSize):D(0,0),i=e.iconAnchor?D(e.iconAnchor):D(0,0);t.panInside(this._latlng,{paddingTopLeft:i,paddingBottomRight:n.subtract(i)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function pr(t,e){return new ze(t,e)}var Ft=bt.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return A(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Be=Ft.extend({options:{fill:!0,radius:10},initialize:function(t,e){A(this,e),this._latlng=F(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=F(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Ft.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,n=this._clickTolerance(),i=[t+n,e+n];this._pxBounds=new $(this._point.subtract(i),this._point.add(i))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function mr(t,e){return new Be(t,e)}var zn=Be.extend({initialize:function(t,e,n){if(typeof e=="number"&&(e=u({},n,{radius:e})),A(this,e),this._latlng=F(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new dt(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Ft.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,n=this._map,i=n.options.crs;if(i.distance===Zt.distance){var o=Math.PI/180,l=this._mRadius/Zt.R/o,h=n.project([e+l,t]),d=n.project([e-l,t]),p=h.add(d).divideBy(2),g=n.unproject(p).lat,y=Math.acos((Math.cos(l*o)-Math.sin(e*o)*Math.sin(g*o))/(Math.cos(e*o)*Math.cos(g*o)))/o;(isNaN(y)||y===0)&&(y=l/Math.cos(Math.PI/180*e)),this._point=p.subtract(n.getPixelOrigin()),this._radius=isNaN(y)?0:p.x-n.project([g,t-y]).x,this._radiusY=p.y-h.y}else{var S=i.unproject(i.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(S).x}this._updateBounds()}});function _r(t,e,n){return new zn(t,e,n)}var Nt=Ft.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){A(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e=1/0,n=null,i=ye,o,l,h=0,d=this._parts.length;h<d;h++)for(var p=this._parts[h],g=1,y=p.length;g<y;g++){o=p[g-1],l=p[g];var S=i(t,o,l,!0);S<e&&(e=S,n=i(t,o,l))}return n&&(n.distance=Math.sqrt(e)),n},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Vi(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=F(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new dt,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return yt(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],n=yt(t),i=0,o=t.length;i<o;i++)n?(e[i]=F(t[i]),this._bounds.extend(e[i])):e[i]=this._convertLatLngs(t[i]);return e},_project:function(){var t=new $;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new k(t,t);this._rawPxBounds&&(this._pxBounds=new $([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)]))},_projectLatlngs:function(t,e,n){var i=t[0]instanceof V,o=t.length,l,h;if(i){for(h=[],l=0;l<o;l++)h[l]=this._map.latLngToLayerPoint(t[l]),n.extend(h[l]);e.push(h)}else for(l=0;l<o;l++)this._projectLatlngs(t[l],e,n)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}var e=this._parts,n,i,o,l,h,d,p;for(n=0,o=0,l=this._rings.length;n<l;n++)for(p=this._rings[n],i=0,h=p.length;i<h-1;i++)d=Wi(p[i],p[i+1],t,i,!0),d&&(e[o]=e[o]||[],e[o].push(d[0]),(d[1]!==p[i+1]||i===h-2)&&(e[o].push(d[1]),o++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,n=0,i=t.length;n<i;n++)t[n]=Fi(t[n],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var n,i,o,l,h,d,p=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(n=0,l=this._parts.length;n<l;n++)for(d=this._parts[n],i=0,h=d.length,o=h-1;i<h;o=i++)if(!(!e&&i===0)&&ji(t,d[o],d[i])<=p)return!0;return!1}});function gr(t,e){return new Nt(t,e)}Nt._flat=Gi;var ie=Nt.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Hi(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var e=Nt.prototype._convertLatLngs.call(this,t),n=e.length;return n>=2&&e[0]instanceof V&&e[0].equals(e[n-1])&&e.pop(),e},_setLatLngs:function(t){Nt.prototype._setLatLngs.call(this,t),yt(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return yt(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,n=new k(e,e);if(t=new $(t.min.subtract(n),t.max.add(n)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}for(var i=0,o=this._rings.length,l;i<o;i++)l=Zi(this._rings[i],t,!0),l.length&&this._parts.push(l)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e=!1,n,i,o,l,h,d,p,g;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(l=0,p=this._parts.length;l<p;l++)for(n=this._parts[l],h=0,g=n.length,d=g-1;h<g;d=h++)i=n[h],o=n[d],i.y>t.y!=o.y>t.y&&t.x<(o.x-i.x)*(t.y-i.y)/(o.y-i.y)+i.x&&(e=!e);return e||Nt.prototype._containsPoint.call(this,t,!0)}});function vr(t,e){return new ie(t,e)}var zt=It.extend({initialize:function(t,e){A(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e=w(t)?t:t.features,n,i,o;if(e){for(n=0,i=e.length;n<i;n++)o=e[n],(o.geometries||o.geometry||o.features||o.coordinates)&&this.addData(o);return this}var l=this.options;if(l.filter&&!l.filter(t))return this;var h=Re(t,l);return h?(h.feature=Fe(t),h.defaultOptions=h.options,this.resetStyle(h),l.onEachFeature&&l.onEachFeature(t,h),this.addLayer(h)):this},resetStyle:function(t){return t===void 0?this.eachLayer(this.resetStyle,this):(t.options=u({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){t.setStyle&&(typeof e=="function"&&(e=e(t.feature)),t.setStyle(e))}});function Re(t,e){var n=t.type==="Feature"?t.geometry:t,i=n?n.coordinates:null,o=[],l=e&&e.pointToLayer,h=e&&e.coordsToLatLng||Bn,d,p,g,y;if(!i&&!n)return null;switch(n.type){case"Point":return d=h(i),Xi(l,t,d,e);case"MultiPoint":for(g=0,y=i.length;g<y;g++)d=h(i[g]),o.push(Xi(l,t,d,e));return new It(o);case"LineString":case"MultiLineString":return p=Ze(i,n.type==="LineString"?0:1,h),new Nt(p,e);case"Polygon":case"MultiPolygon":return p=Ze(i,n.type==="Polygon"?1:2,h),new ie(p,e);case"GeometryCollection":for(g=0,y=n.geometries.length;g<y;g++){var S=Re({geometry:n.geometries[g],type:"Feature",properties:t.properties},e);S&&o.push(S)}return new It(o);case"FeatureCollection":for(g=0,y=n.features.length;g<y;g++){var H=Re(n.features[g],e);H&&o.push(H)}return new It(o);default:throw new Error("Invalid GeoJSON object.")}}function Xi(t,e,n,i){return t?t(e,n):new ze(n,i&&i.markersInheritOptions&&i)}function Bn(t){return new V(t[1],t[0],t[2])}function Ze(t,e,n){for(var i=[],o=0,l=t.length,h;o<l;o++)h=e?Ze(t[o],e-1,n):(n||Bn)(t[o]),i.push(h);return i}function Rn(t,e){return t=F(t),t.alt!==void 0?[Z(t.lng,e),Z(t.lat,e),Z(t.alt,e)]:[Z(t.lng,e),Z(t.lat,e)]}function He(t,e,n,i){for(var o=[],l=0,h=t.length;l<h;l++)o.push(e?He(t[l],yt(t[l])?0:e-1,n,i):Rn(t[l],i));return!e&&n&&o.length>0&&o.push(o[0].slice()),o}function oe(t,e){return t.feature?u({},t.feature,{geometry:e}):Fe(e)}function Fe(t){return t.type==="Feature"||t.type==="FeatureCollection"?t:{type:"Feature",properties:{},geometry:t}}var Zn={toGeoJSON:function(t){return oe(this,{type:"Point",coordinates:Rn(this.getLatLng(),t)})}};ze.include(Zn),zn.include(Zn),Be.include(Zn),Nt.include({toGeoJSON:function(t){var e=!yt(this._latlngs),n=He(this._latlngs,e?1:0,!1,t);return oe(this,{type:(e?"Multi":"")+"LineString",coordinates:n})}}),ie.include({toGeoJSON:function(t){var e=!yt(this._latlngs),n=e&&!yt(this._latlngs[0]),i=He(this._latlngs,n?2:e?1:0,!0,t);return e||(i=[i]),oe(this,{type:(n?"Multi":"")+"Polygon",coordinates:i})}}),ee.include({toMultiPoint:function(t){var e=[];return this.eachLayer(function(n){e.push(n.toGeoJSON(t).geometry.coordinates)}),oe(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(e==="MultiPoint")return this.toMultiPoint(t);var n=e==="GeometryCollection",i=[];return this.eachLayer(function(o){if(o.toGeoJSON){var l=o.toGeoJSON(t);if(n)i.push(l.geometry);else{var h=Fe(l);h.type==="FeatureCollection"?i.push.apply(i,h.features):i.push(h)}}}),n?oe(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}});function $i(t,e){return new zt(t,e)}var yr=$i,je=bt.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,n){this._url=t,this._bounds=tt(e),A(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(R(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){K(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&Qt(this._image),this},bringToBack:function(){return this._map&&te(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=tt(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._url.tagName==="IMG",e=this._image=t?this._url:W("img");if(R(e,"leaflet-image-layer"),this._zoomAnimated&&R(e,"leaflet-zoom-animated"),this.options.className&&R(e,this.options.className),e.onselectstart=E,e.onmousemove=E,e.onload=m(this.fire,this,"load"),e.onerror=m(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(e.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t){this._url=e.src;return}e.src=this._url,e.alt=this.options.alt},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;Wt(this._image,n,e)},_reset:function(){var t=this._image,e=new $(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=e.getSize();et(t,e.min),t.style.width=n.x+"px",t.style.height=n.y+"px"},_updateOpacity:function(){vt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),xr=function(t,e,n){return new je(t,e,n)},Ki=je.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t=this._url.tagName==="VIDEO",e=this._image=t?this._url:W("video");if(R(e,"leaflet-image-layer"),this._zoomAnimated&&R(e,"leaflet-zoom-animated"),this.options.className&&R(e,this.options.className),e.onselectstart=E,e.onmousemove=E,e.onloadeddata=m(this.fire,this,"load"),t){for(var n=e.getElementsByTagName("source"),i=[],o=0;o<n.length;o++)i.push(n[o].src);this._url=n.length>0?i:[e.src];return}w(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(e.style,"objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop,e.muted=!!this.options.muted,e.playsInline=!!this.options.playsInline;for(var l=0;l<this._url.length;l++){var h=W("source");h.src=this._url[l],e.appendChild(h)}}});function wr(t,e,n){return new Ki(t,e,n)}var Ji=je.extend({_initImage:function(){var t=this._image=this._url;R(t,"leaflet-image-layer"),this._zoomAnimated&&R(t,"leaflet-zoom-animated"),this.options.className&&R(t,this.options.className),t.onselectstart=E,t.onmousemove=E}});function Pr(t,e,n){return new Ji(t,e,n)}var St=bt.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,e){t&&(t instanceof V||w(t))?(this._latlng=F(t),A(this,e)):(A(this,t),this._source=e),this.options.content&&(this._content=this.options.content)},openOn:function(t){return t=arguments.length?t:this._source._map,t.hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&vt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&vt(this._container,1),this.bringToFront(),this.options.interactive&&(R(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(vt(this._container,0),this._removeTimeout=setTimeout(m(K,void 0,this._container),200)):K(this._container),this.options.interactive&&(Q(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=F(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Qt(this._container),this},bringToBack:function(){return this._map&&te(this._container),this},_prepareOpen:function(t){var e=this._source;if(!e._map)return!1;if(e instanceof It){e=null;var n=this._source._layers;for(var i in n)if(n[i]._map){e=n[i];break}if(!e)return!1;this._source=e}if(!t)if(e.getCenter)t=e.getCenter();else if(e.getLatLng)t=e.getLatLng();else if(e.getBounds)t=e.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,e=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof e=="string")t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=D(this.options.offset),n=this._getAnchor();this._zoomAnimated?et(this._container,t.add(n)):e=e.add(t).add(n);var i=this._containerBottom=-e.y,o=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=i+"px",this._container.style.left=o+"px"}},_getAnchor:function(){return[0,0]}});j.include({_initOverlay:function(t,e,n,i){var o=e;return o instanceof t||(o=new t(i).setContent(e)),n&&o.setLatLng(n),o}}),bt.include({_initOverlay:function(t,e,n,i){var o=n;return o instanceof t?(A(o,i),o._source=this):(o=e&&!i?e:new t(i,this),o.setContent(n)),o}});var Ue=St.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t=arguments.length?t:this._source._map,!t.hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,St.prototype.openOn.call(this,t)},onAdd:function(t){St.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ft||this._source.on("preclick",Vt))},onRemove:function(t){St.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ft||this._source.off("preclick",Vt))},getEvents:function(){var t=St.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",e=this._container=W("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=W("div",t+"-content-wrapper",e);if(this._contentNode=W("div",t+"-content",n),ge(e),Sn(this._contentNode),z(e,"contextmenu",Vt),this._tipContainer=W("div",t+"-tip-container",e),this._tip=W("div",t+"-tip",this._tipContainer),this.options.closeButton){var i=this._closeButton=W("a",t+"-close-button",e);i.setAttribute("role","button"),i.setAttribute("aria-label","Close popup"),i.href="#close",i.innerHTML='<span aria-hidden="true">&#215;</span>',z(i,"click",function(o){at(o),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var i=t.offsetHeight,o=this.options.maxHeight,l="leaflet-popup-scrolled";o&&i>o?(e.height=o+"px",R(t,l)):Q(t,l),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),n=this._getAnchor();et(this._container,e.add(n))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var t=this._map,e=parseInt(fe(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+e,i=this._containerWidth,o=new k(this._containerLeft,-n-this._containerBottom);o._add(Gt(this._container));var l=t.layerPointToContainerPoint(o),h=D(this.options.autoPanPadding),d=D(this.options.autoPanPaddingTopLeft||h),p=D(this.options.autoPanPaddingBottomRight||h),g=t.getSize(),y=0,S=0;l.x+i+p.x>g.x&&(y=l.x+i-g.x+p.x),l.x-y-d.x<0&&(y=l.x-d.x),l.y+n+p.y>g.y&&(S=l.y+n-g.y+p.y),l.y-S-d.y<0&&(S=l.y-d.y),(y||S)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([y,S]))}},_getAnchor:function(){return D(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),br=function(t,e){return new Ue(t,e)};j.mergeOptions({closePopupOnClick:!0}),j.include({openPopup:function(t,e,n){return this._initOverlay(Ue,t,e,n).openOn(this),this},closePopup:function(t){return t=arguments.length?t:this._popup,t&&t.close(),this}}),bt.include({bindPopup:function(t,e){return this._popup=this._initOverlay(Ue,this._popup,t,e),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof It||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(!(!this._popup||!this._map)){qt(t);var e=t.layer||t.target;if(this._popup._source===e&&!(e instanceof Ft)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng);return}this._popup._source=e,this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){t.originalEvent.keyCode===13&&this._openPopup(t)}});var We=St.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){St.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){St.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=St.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip",e=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=W("div",e),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+_(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e,n,i=this._map,o=this._container,l=i.latLngToContainerPoint(i.getCenter()),h=i.layerPointToContainerPoint(t),d=this.options.direction,p=o.offsetWidth,g=o.offsetHeight,y=D(this.options.offset),S=this._getAnchor();d==="top"?(e=p/2,n=g):d==="bottom"?(e=p/2,n=0):d==="center"?(e=p/2,n=g/2):d==="right"?(e=0,n=g/2):d==="left"?(e=p,n=g/2):h.x<l.x?(d="right",e=0,n=g/2):(d="left",e=p+(y.x+S.x)*2,n=g/2),t=t.subtract(D(e,n,!0)).add(y).add(S),Q(o,"leaflet-tooltip-right"),Q(o,"leaflet-tooltip-left"),Q(o,"leaflet-tooltip-top"),Q(o,"leaflet-tooltip-bottom"),R(o,"leaflet-tooltip-"+d),et(o,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&vt(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return D(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Tr=function(t,e){return new We(t,e)};j.include({openTooltip:function(t,e,n){return this._initOverlay(We,t,e,n).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),bt.include({bindTooltip:function(t,e){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(We,this._tooltip,t,e),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(!(!t&&this._tooltipHandlersAdded)){var e=t?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,n.click=this._openTooltip,this._map?this._addFocusListeners():n.add=this._addFocusListeners),this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),this[e](n),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof It||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var e=typeof t.getElement=="function"&&t.getElement();e&&(z(e,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),z(e,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var e=typeof t.getElement=="function"&&t.getElement();e&&e.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var e=this;this._map.once("moveend",function(){e._openOnceFlag=!1,e._openTooltip(t)});return}this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)}},_moveTooltip:function(t){var e=t.latlng,n,i;this._tooltip.options.sticky&&t.originalEvent&&(n=this._map.mouseEventToContainerPoint(t.originalEvent),i=this._map.containerPointToLayerPoint(n),e=this._map.layerPointToLatLng(i)),this._tooltip.setLatLng(e)}});var Qi=ne.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&t.tagName==="DIV"?t:document.createElement("div"),n=this.options;if(n.html instanceof Element?(Oe(e),e.appendChild(n.html)):e.innerHTML=n.html!==!1?n.html:"",n.bgPos){var i=D(n.bgPos);e.style.backgroundPosition=-i.x+"px "+-i.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});function Lr(t){return new Qi(t)}ne.Default=xe;var we=bt.extend({options:{tileSize:256,opacity:1,updateWhenIdle:M.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){A(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),K(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Qt(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(te(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=b(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof k?t:new k(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e=this.getPane().children,n=-t(-1/0,1/0),i=0,o=e.length,l;i<o;i++)l=e[i].style.zIndex,e[i]!==this._container&&l&&(n=t(n,+l));isFinite(n)&&(this.options.zIndex=n+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!M.ielt9){vt(this._container,this.options.opacity);var t=+new Date,e=!1,n=!1;for(var i in this._tiles){var o=this._tiles[i];if(!(!o.current||!o.loaded)){var l=Math.min(1,(t-o.loaded)/200);vt(o.el,l),l<1?e=!0:(o.active?n=!0:this._onOpaqueTile(o),o.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),e&&(st(this._fadeFrame),this._fadeFrame=it(this._updateOpacity,this))}},_onOpaqueTile:E,_initContainer:function(){this._container||(this._container=W("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(t!==void 0){for(var n in this._levels)n=Number(n),this._levels[n].el.children.length||n===t?(this._levels[n].el.style.zIndex=e-Math.abs(t-n),this._onUpdateLevel(n)):(K(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var i=this._levels[t],o=this._map;return i||(i=this._levels[t]={},i.el=W("div","leaflet-tile-container leaflet-zoom-animated",this._container),i.el.style.zIndex=e,i.origin=o.project(o.unproject(o.getPixelOrigin()),t).round(),i.zoom=t,this._setZoomTransform(i,o.getCenter(),o.getZoom()),E(i.el.offsetWidth),this._onCreateLevel(i)),this._level=i,i}},_onUpdateLevel:E,_onRemoveLevel:E,_onCreateLevel:E,_pruneTiles:function(){if(this._map){var t,e,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom){this._removeAllTiles();return}for(t in this._tiles)e=this._tiles[t],e.retain=e.current;for(t in this._tiles)if(e=this._tiles[t],e.current&&!e.active){var i=e.coords;this._retainParent(i.x,i.y,i.z,i.z-5)||this._retainChildren(i.x,i.y,i.z,i.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)K(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,n,i){var o=Math.floor(t/2),l=Math.floor(e/2),h=n-1,d=new k(+o,+l);d.z=+h;var p=this._tileCoordsToKey(d),g=this._tiles[p];return g&&g.active?(g.retain=!0,!0):(g&&g.loaded&&(g.retain=!0),h>i?this._retainParent(o,l,h,i):!1)},_retainChildren:function(t,e,n,i){for(var o=2*t;o<2*t+2;o++)for(var l=2*e;l<2*e+2;l++){var h=new k(o,l);h.z=n+1;var d=this._tileCoordsToKey(h),p=this._tiles[d];if(p&&p.active){p.retain=!0;continue}else p&&p.loaded&&(p.retain=!0);n+1<i&&this._retainChildren(o,l,n+1,i)}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return e.minNativeZoom!==void 0&&t<e.minNativeZoom?e.minNativeZoom:e.maxNativeZoom!==void 0&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,n,i){var o=Math.round(e);this.options.maxZoom!==void 0&&o>this.options.maxZoom||this.options.minZoom!==void 0&&o<this.options.minZoom?o=void 0:o=this._clampZoom(o);var l=this.options.updateWhenZooming&&o!==this._tileZoom;(!i||l)&&(this._tileZoom=o,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),o!==void 0&&this._update(t),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var n in this._levels)this._setZoomTransform(this._levels[n],t,e)},_setZoomTransform:function(t,e,n){var i=this._map.getZoomScale(n,t.zoom),o=t.origin.multiplyBy(i).subtract(this._map._getNewPixelOrigin(e,n)).round();M.any3d?Wt(t.el,o,i):et(t.el,o)},_resetGrid:function(){var t=this._map,e=t.options.crs,n=this._tileSize=this.getTileSize(),i=this._tileZoom,o=this._map.getPixelWorldBounds(this._tileZoom);o&&(this._globalTileRange=this._pxBoundsToTileRange(o)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],i).x/n.x),Math.ceil(t.project([0,e.wrapLng[1]],i).x/n.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],i).y/n.x),Math.ceil(t.project([e.wrapLat[1],0],i).y/n.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var e=this._map,n=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),i=e.getZoomScale(n,this._tileZoom),o=e.project(t,this._tileZoom).floor(),l=e.getSize().divideBy(i*2);return new $(o.subtract(l),o.add(l))},_update:function(t){var e=this._map;if(e){var n=this._clampZoom(e.getZoom());if(t===void 0&&(t=e.getCenter()),this._tileZoom!==void 0){var i=this._getTiledPixelBounds(t),o=this._pxBoundsToTileRange(i),l=o.getCenter(),h=[],d=this.options.keepBuffer,p=new $(o.getBottomLeft().subtract([d,-d]),o.getTopRight().add([d,-d]));if(!(isFinite(o.min.x)&&isFinite(o.min.y)&&isFinite(o.max.x)&&isFinite(o.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var g in this._tiles){var y=this._tiles[g].coords;(y.z!==this._tileZoom||!p.contains(new k(y.x,y.y)))&&(this._tiles[g].current=!1)}if(Math.abs(n-this._tileZoom)>1){this._setView(t,n);return}for(var S=o.min.y;S<=o.max.y;S++)for(var H=o.min.x;H<=o.max.x;H++){var lt=new k(H,S);if(lt.z=this._tileZoom,!!this._isValidTile(lt)){var ot=this._tiles[this._tileCoordsToKey(lt)];ot?ot.current=!0:h.push(lt)}}if(h.sort(function(ft,re){return ft.distanceTo(l)-re.distanceTo(l)}),h.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var xt=document.createDocumentFragment();for(H=0;H<h.length;H++)this._addTile(h[H],xt);this._level.el.appendChild(xt)}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var n=this._globalTileRange;if(!e.wrapLng&&(t.x<n.min.x||t.x>n.max.x)||!e.wrapLat&&(t.y<n.min.y||t.y>n.max.y))return!1}if(!this.options.bounds)return!0;var i=this._tileCoordsToBounds(t);return tt(this.options.bounds).overlaps(i)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,n=this.getTileSize(),i=t.scaleBy(n),o=i.add(n),l=e.unproject(i,t.z),h=e.unproject(o,t.z);return[l,h]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),n=new dt(e[0],e[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),n=new k(+e[0],+e[1]);return n.z=+e[2],n},_removeTile:function(t){var e=this._tiles[t];e&&(K(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){R(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=E,t.onmousemove=E,M.ielt9&&this.options.opacity<1&&vt(t,this.options.opacity)},_addTile:function(t,e){var n=this._getTilePos(t),i=this._tileCoordsToKey(t),o=this.createTile(this._wrapCoords(t),m(this._tileReady,this,t));this._initTile(o),this.createTile.length<2&&it(m(this._tileReady,this,t,null,o)),et(o,n),this._tiles[i]={el:o,coords:t,current:!0},e.appendChild(o),this.fire("tileloadstart",{tile:o,coords:t})},_tileReady:function(t,e,n){e&&this.fire("tileerror",{error:e,tile:n,coords:t});var i=this._tileCoordsToKey(t);n=this._tiles[i],n&&(n.loaded=+new Date,this._map._fadeAnimated?(vt(n.el,0),st(this._fadeFrame),this._fadeFrame=it(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),e||(R(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),M.ielt9||!this._map._fadeAnimated?it(this._pruneTiles,this):setTimeout(m(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new k(this._wrapX?I(t.x,this._wrapX):t.x,this._wrapY?I(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new $(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function Mr(t){return new we(t)}var ae=we.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,e){this._url=t,e=A(this,e),e.detectRetina&&M.retina&&e.maxZoom>0?(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom=Math.min(e.maxZoom,e.minZoom+1)):(e.zoomOffset++,e.maxZoom=Math.max(e.minZoom,e.maxZoom-1)),e.minZoom=Math.max(0,e.minZoom)):e.zoomReverse?e.minZoom=Math.min(e.maxZoom,e.minZoom):e.maxZoom=Math.max(e.minZoom,e.maxZoom),typeof e.subdomains=="string"&&(e.subdomains=e.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&e===void 0&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var n=document.createElement("img");return z(n,"load",m(this._tileOnLoad,this,e,n)),z(n,"error",m(this._tileOnError,this,e,n)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(n.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(n.referrerPolicy=this.options.referrerPolicy),n.alt="",n.src=this.getTileUrl(t),n},getTileUrl:function(t){var e={r:M.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var n=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=n),e["-y"]=n}return C(this._url,u(e,this.options))},_tileOnLoad:function(t,e){M.ielt9?setTimeout(m(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,n){var i=this.options.errorTileUrl;i&&e.getAttribute("src")!==i&&(e.src=i),t(n,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom,n=this.options.zoomReverse,i=this.options.zoomOffset;return n&&(t=e-t),t+i},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&(e=this._tiles[t].el,e.onload=E,e.onerror=E,!e.complete)){e.src=N;var n=this._tiles[t].coords;K(e),delete this._tiles[t],this.fire("tileabort",{tile:e,coords:n})}},_removeTile:function(t){var e=this._tiles[t];if(e)return e.el.setAttribute("src",N),we.prototype._removeTile.call(this,t)},_tileReady:function(t,e,n){if(!(!this._map||n&&n.getAttribute("src")===N))return we.prototype._tileReady.call(this,t,e,n)}});function to(t,e){return new ae(t,e)}var eo=ae.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var n=u({},this.defaultWmsParams);for(var i in e)i in this.options||(n[i]=e[i]);e=A(this,e);var o=e.detectRetina&&M.retina?2:1,l=this.getTileSize();n.width=l.x*o,n.height=l.y*o,this.wmsParams=n},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,ae.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),n=this._crs,i=ut(n.project(e[0]),n.project(e[1])),o=i.min,l=i.max,h=(this._wmsVersion>=1.3&&this._crs===qi?[o.y,o.x,l.y,l.x]:[o.x,o.y,l.x,l.y]).join(","),d=ae.prototype.getTileUrl.call(this,t);return d+G(this.wmsParams,d,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+h},setParams:function(t,e){return u(this.wmsParams,t),e||this.redraw(),this}});function Cr(t,e){return new eo(t,e)}ae.WMS=eo,to.wms=Cr;var Bt=bt.extend({options:{padding:.1},initialize:function(t){A(this,t),_(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),R(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var n=this._map.getZoomScale(e,this._zoom),i=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,e),l=i.multiplyBy(-n).add(o).subtract(this._map._getNewPixelOrigin(t,e));M.any3d?Wt(this._container,l,n):et(this._container,l)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),n=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new $(n,n.add(e.multiplyBy(1+t*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),no=Bt.extend({options:{tolerance:0},getEvents:function(){var t=Bt.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Bt.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");z(t,"mousemove",this._onMouseMove,this),z(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),z(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){st(this._redrawRequest),delete this._ctx,K(this._container),q(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var e in this._layers)t=this._layers[e],t._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Bt.prototype._update.call(this);var t=this._bounds,e=this._container,n=t.getSize(),i=M.retina?2:1;et(e,t.min),e.width=i*n.x,e.height=i*n.y,e.style.width=n.x+"px",e.style.height=n.y+"px",M.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){Bt.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[_(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,n=e.next,i=e.prev;n?n.prev=i:this._drawLast=i,i?i.next=n:this._drawFirst=n,delete t._order,delete this._layers[_(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(typeof t.options.dashArray=="string"){var e=t.options.dashArray.split(/[, ]+/),n=[],i,o;for(o=0;o<e.length;o++){if(i=Number(e[o]),isNaN(i))return;n.push(i)}t.options._dashArray=n}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||it(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new $,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var n=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var i=this._drawFirst;i;i=i.next)t=i.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var n,i,o,l,h=t._parts,d=h.length,p=this._ctx;if(d){for(p.beginPath(),n=0;n<d;n++){for(i=0,o=h[n].length;i<o;i++)l=h[n][i],p[i?"lineTo":"moveTo"](l.x,l.y);e&&p.closePath()}this._fillStroke(p,t)}}},_updateCircle:function(t){if(!(!this._drawing||t._empty())){var e=t._point,n=this._ctx,i=Math.max(Math.round(t._radius),1),o=(Math.max(Math.round(t._radiusY),1)||i)/i;o!==1&&(n.save(),n.scale(1,o)),n.beginPath(),n.arc(e.x,e.y/o,i,0,Math.PI*2,!1),o!==1&&n.restore(),this._fillStroke(n,t)}},_fillStroke:function(t,e){var n=e.options;n.fill&&(t.globalAlpha=n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill(n.fillRule||"evenodd")),n.stroke&&n.weight!==0&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=n.opacity,t.lineWidth=n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){for(var e=this._map.mouseEventToLayerPoint(t),n,i,o=this._drawFirst;o;o=o.next)n=o.layer,n.options.interactive&&n._containsPoint(e)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(n))&&(i=n);this._fireEvent(i?[i]:!1,t)},_onMouseMove:function(t){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(Q(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var n,i,o=this._drawFirst;o;o=o.next)n=o.layer,n.options.interactive&&n._containsPoint(e)&&(i=n);i!==this._hoveredLayer&&(this._handleMouseOut(t),i&&(R(this._container,"leaflet-interactive"),this._fireEvent([i],t,"mouseover"),this._hoveredLayer=i)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,t),this._mouseHoverThrottled=!0,setTimeout(m(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,e,n){this._map._fireDOMEvent(e,n||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var n=e.next,i=e.prev;if(n)n.prev=i;else return;i?i.next=n:n&&(this._drawFirst=n),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t)}},_bringToBack:function(t){var e=t._order;if(e){var n=e.next,i=e.prev;if(i)i.next=n;else return;n?n.prev=i:i&&(this._drawLast=i),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t)}}});function io(t){return M.canvas?new no(t):null}var Pe=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch{}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Sr={_initContainer:function(){this._container=W("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Bt.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=Pe("shape");R(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=Pe("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[_(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;K(e),t.removeInteractiveTarget(e),delete this._layers[_(t)]},_updateStyle:function(t){var e=t._stroke,n=t._fill,i=t.options,o=t._container;o.stroked=!!i.stroke,o.filled=!!i.fill,i.stroke?(e||(e=t._stroke=Pe("stroke")),o.appendChild(e),e.weight=i.weight+"px",e.color=i.color,e.opacity=i.opacity,i.dashArray?e.dashStyle=w(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=i.lineCap.replace("butt","flat"),e.joinstyle=i.lineJoin):e&&(o.removeChild(e),t._stroke=null),i.fill?(n||(n=t._fill=Pe("fill")),o.appendChild(n),n.color=i.fillColor||i.color,n.opacity=i.fillOpacity):n&&(o.removeChild(n),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),n=Math.round(t._radius),i=Math.round(t._radiusY||n);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+n+","+i+" 0,"+65535*360)},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){Qt(t._container)},_bringToBack:function(t){te(t._container)}},Ge=M.vml?Pe:si,be=Bt.extend({_initContainer:function(){this._container=Ge("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ge("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){K(this._container),q(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Bt.prototype._update.call(this);var t=this._bounds,e=t.getSize(),n=this._container;(!this._svgSize||!this._svgSize.equals(e))&&(this._svgSize=e,n.setAttribute("width",e.x),n.setAttribute("height",e.y)),et(n,t.min),n.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=Ge("path");t.options.className&&R(e,t.options.className),t.options.interactive&&R(e,"leaflet-interactive"),this._updateStyle(t),this._layers[_(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){K(t._path),t.removeInteractiveTarget(t._path),delete this._layers[_(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,n=t.options;e&&(n.stroke?(e.setAttribute("stroke",n.color),e.setAttribute("stroke-opacity",n.opacity),e.setAttribute("stroke-width",n.weight),e.setAttribute("stroke-linecap",n.lineCap),e.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?e.setAttribute("stroke-dasharray",n.dashArray):e.removeAttribute("stroke-dasharray"),n.dashOffset?e.setAttribute("stroke-dashoffset",n.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),n.fill?(e.setAttribute("fill",n.fillColor||n.color),e.setAttribute("fill-opacity",n.fillOpacity),e.setAttribute("fill-rule",n.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,li(t._parts,e))},_updateCircle:function(t){var e=t._point,n=Math.max(Math.round(t._radius),1),i=Math.max(Math.round(t._radiusY),1)||n,o="a"+n+","+i+" 0 1,0 ",l=t._empty()?"M0 0":"M"+(e.x-n)+","+e.y+o+n*2+",0 "+o+-n*2+",0 ";this._setPath(t,l)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){Qt(t._path)},_bringToBack:function(t){te(t._path)}});M.vml&&be.include(Sr);function oo(t){return M.svg||M.vml?new be(t):null}j.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if(t==="overlayPane"||t===void 0)return!1;var e=this._paneRenderers[t];return e===void 0&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&io(t)||oo(t)}});var ao=ie.extend({initialize:function(t,e){ie.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=tt(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function Er(t,e){return new ao(t,e)}be.create=Ge,be.pointsToPath=li,zt.geometryToLayer=Re,zt.coordsToLatLng=Bn,zt.coordsToLatLngs=Ze,zt.latLngToCoords=Rn,zt.latLngsToCoords=He,zt.getFeature=oe,zt.asFeature=Fe,j.mergeOptions({boxZoom:!0});var ro=Ct.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){z(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){q(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){K(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||t.which!==1&&t.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),pe(),xn(),this._startPoint=this._map.mouseEventToContainerPoint(t),z(document,{contextmenu:qt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=W("div","leaflet-zoom-box",this._container),R(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new $(this._point,this._startPoint),n=e.getSize();et(this._box,e.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(K(this._box),Q(this._container,"leaflet-crosshair")),me(),wn(),q(document,{contextmenu:qt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if(!(t.which!==1&&t.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(m(this._resetState,this),0);var e=new dt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){t.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});j.addInitHook("addHandler","boxZoom",ro),j.mergeOptions({doubleClickZoom:!0});var so=Ct.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom(),i=e.options.zoomDelta,o=t.originalEvent.shiftKey?n-i:n+i;e.options.doubleClickZoom==="center"?e.setZoom(o):e.setZoomAround(t.containerPoint,o)}});j.addInitHook("addHandler","doubleClickZoom",so),j.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var lo=Ct.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new Ht(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}R(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Q(this._map._container,"leaflet-grab"),Q(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=tt(this._map.options.maxBounds);this._offsetLimit=ut(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,o=(i-e+n)%t+e-n,l=(i+e+n)%t-e-n,h=Math.abs(o+n)<Math.abs(l+n)?o:l;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=h},_onDragEnd:function(t){var e=this._map,n=e.options,i=!n.inertia||t.noInertia||this._times.length<2;if(e.fire("dragend",t),i)e.fire("moveend");else{this._prunePositions(+new Date);var o=this._lastPos.subtract(this._positions[0]),l=(this._lastTime-this._times[0])/1e3,h=n.easeLinearity,d=o.multiplyBy(h/l),p=d.distanceTo([0,0]),g=Math.min(n.inertiaMaxSpeed,p),y=d.multiplyBy(g/p),S=g/(n.inertiaDeceleration*h),H=y.multiplyBy(-S/2).round();!H.x&&!H.y?e.fire("moveend"):(H=e._limitOffset(H,e.options.maxBounds),it(function(){e.panBy(H,{duration:S,easeLinearity:h,noMoveStart:!0,animate:!0})}))}}});j.addInitHook("addHandler","dragging",lo),j.mergeOptions({keyboard:!0,keyboardPanDelta:80});var co=Ct.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),z(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),q(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,n=t.scrollTop||e.scrollTop,i=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(i,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e=this._panKeys={},n=this.keyCodes,i,o;for(i=0,o=n.left.length;i<o;i++)e[n.left[i]]=[-1*t,0];for(i=0,o=n.right.length;i<o;i++)e[n.right[i]]=[t,0];for(i=0,o=n.down.length;i<o;i++)e[n.down[i]]=[0,t];for(i=0,o=n.up.length;i<o;i++)e[n.up[i]]=[0,-1*t]},_setZoomDelta:function(t){var e=this._zoomKeys={},n=this.keyCodes,i,o;for(i=0,o=n.zoomIn.length;i<o;i++)e[n.zoomIn[i]]=t;for(i=0,o=n.zoomOut.length;i<o;i++)e[n.zoomOut[i]]=-t},_addHooks:function(){z(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){q(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e=t.keyCode,n=this._map,i;if(e in this._panKeys){if(!n._panAnim||!n._panAnim._inProgress)if(i=this._panKeys[e],t.shiftKey&&(i=D(i).multiplyBy(3)),n.options.maxBounds&&(i=n._limitOffset(D(i),n.options.maxBounds)),n.options.worldCopyJump){var o=n.wrapLatLng(n.unproject(n.project(n.getCenter()).add(i)));n.panTo(o)}else n.panBy(i)}else if(e in this._zoomKeys)n.setZoom(n.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[e]);else if(e===27&&n._popup&&n._popup.options.closeOnEscapeKey)n.closePopup();else return;qt(t)}}});j.addInitHook("addHandler","keyboard",co),j.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ho=Ct.extend({addHooks:function(){z(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){q(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=Ii(t),n=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var i=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(m(this._performZoom,this),i),qt(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),n=this._map.options.zoomSnap||0;t._stop();var i=this._delta/(this._map.options.wheelPxPerZoomLevel*4),o=4*Math.log(2/(1+Math.exp(-Math.abs(i))))/Math.LN2,l=n?Math.ceil(o/n)*n:o,h=t._limitZoom(e+(this._delta>0?l:-l))-e;this._delta=0,this._startTime=null,h&&(t.options.scrollWheelZoom==="center"?t.setZoom(e+h):t.setZoomAround(this._lastMousePos,e+h))}});j.addInitHook("addHandler","scrollWheelZoom",ho);var Or=600;j.mergeOptions({tapHold:M.touchNative&&M.safari&&M.mobile,tapTolerance:15});var uo=Ct.extend({addHooks:function(){z(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){q(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),t.touches.length===1){var e=t.touches[0];this._startPos=this._newPos=new k(e.clientX,e.clientY),this._holdTimeout=setTimeout(m(function(){this._cancel(),this._isTapValid()&&(z(document,"touchend",at),z(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",e))},this),Or),z(document,"touchend touchcancel contextmenu",this._cancel,this),z(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){q(document,"touchend",at),q(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),q(document,"touchend touchcancel contextmenu",this._cancel,this),q(document,"touchmove",this._onMove,this)},_onMove:function(t){var e=t.touches[0];this._newPos=new k(e.clientX,e.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,e){var n=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:e.screenX,screenY:e.screenY,clientX:e.clientX,clientY:e.clientY});n._simulated=!0,e.target.dispatchEvent(n)}});j.addInitHook("addHandler","tapHold",uo),j.mergeOptions({touchZoom:M.touch,bounceAtZoomLimits:!0});var fo=Ct.extend({addHooks:function(){R(this._map._container,"leaflet-touch-zoom"),z(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Q(this._map._container,"leaflet-touch-zoom"),q(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(!(!t.touches||t.touches.length!==2||e._animatingZoom||this._zooming)){var n=e.mouseEventToContainerPoint(t.touches[0]),i=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),e.options.touchZoom!=="center"&&(this._pinchStartLatLng=e.containerPointToLatLng(n.add(i)._divideBy(2))),this._startDist=n.distanceTo(i),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),z(document,"touchmove",this._onTouchMove,this),z(document,"touchend touchcancel",this._onTouchEnd,this),at(t)}},_onTouchMove:function(t){if(!(!t.touches||t.touches.length!==2||!this._zooming)){var e=this._map,n=e.mouseEventToContainerPoint(t.touches[0]),i=e.mouseEventToContainerPoint(t.touches[1]),o=n.distanceTo(i)/this._startDist;if(this._zoom=e.getScaleZoom(o,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&o<1||this._zoom>e.getMaxZoom()&&o>1)&&(this._zoom=e._limitZoom(this._zoom)),e.options.touchZoom==="center"){if(this._center=this._startLatLng,o===1)return}else{var l=n._add(i)._divideBy(2)._subtract(this._centerPoint);if(o===1&&l.x===0&&l.y===0)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(l),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),st(this._animRequest);var h=m(e._move,e,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=it(h,this,!0),at(t)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,st(this._animRequest),q(document,"touchmove",this._onTouchMove,this),q(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});j.addInitHook("addHandler","touchZoom",fo),j.BoxZoom=ro,j.DoubleClickZoom=so,j.Drag=lo,j.Keyboard=co,j.ScrollWheelZoom=ho,j.TapHold=uo,j.TouchZoom=fo,r.Bounds=$,r.Browser=M,r.CRS=At,r.Canvas=no,r.Circle=zn,r.CircleMarker=Be,r.Class=gt,r.Control=Pt,r.DivIcon=Qi,r.DivOverlay=St,r.DomEvent=Ya,r.DomUtil=Va,r.Draggable=Ht,r.Evented=Rt,r.FeatureGroup=It,r.GeoJSON=zt,r.GridLayer=we,r.Handler=Ct,r.Icon=ne,r.ImageOverlay=je,r.LatLng=V,r.LatLngBounds=dt,r.Layer=bt,r.LayerGroup=ee,r.LineUtil=sr,r.Map=j,r.Marker=ze,r.Mixin=er,r.Path=Ft,r.Point=k,r.PolyUtil=nr,r.Polygon=ie,r.Polyline=Nt,r.Popup=Ue,r.PosAnimation=Ni,r.Projection=lr,r.Rectangle=ao,r.Renderer=Bt,r.SVG=be,r.SVGOverlay=Ji,r.TileLayer=ae,r.Tooltip=We,r.Transformation=ln,r.Util=rn,r.VideoOverlay=Ki,r.bind=m,r.bounds=ut,r.canvas=io,r.circle=_r,r.circleMarker=mr,r.control=ve,r.divIcon=Lr,r.extend=u,r.featureGroup=dr,r.geoJSON=$i,r.geoJson=yr,r.gridLayer=Mr,r.icon=fr,r.imageOverlay=xr,r.latLng=F,r.latLngBounds=tt,r.layerGroup=ur,r.map=Xa,r.marker=pr,r.point=D,r.polygon=vr,r.polyline=gr,r.popup=br,r.rectangle=Er,r.setOptions=A,r.stamp=_,r.svg=oo,r.svgOverlay=Pr,r.tileLayer=to,r.tooltip=Tr,r.transformation=he,r.version=c,r.videoOverlay=wr;var Dr=window.L;r.noConflict=function(){return window.L=Dr,this},window.L=r})})(Yn,Yn.exports);var $t=Yn.exports;const ni=Bo($t);function Qe(a,s,r){return Object.freeze({instance:a,context:s,container:r})}function tn(a,s){return s==null?function(c,u){const f=T.useRef();return f.current||(f.current=a(c,u)),f}:function(c,u){const f=T.useRef();f.current||(f.current=a(c,u));const m=T.useRef(c),{instance:v}=f.current;return T.useEffect(function(){m.current!==c&&(s(v,c,m.current),m.current=c)},[v,c,u]),f}}function $o(a,s){T.useEffect(function(){return(s.layerContainer??s.map).addLayer(a.instance),function(){var f;(f=s.layerContainer)==null||f.removeLayer(a.instance),s.map.removeLayer(a.instance)}},[s,a])}function Ko(a){return function(r){const c=Ke(),u=a(Je(r,c),c);return Go(c.map,r.attribution),ei(u.current,r.eventHandlers),$o(u.current,c),u}}function $r(a,s){const r=T.useRef();T.useEffect(function(){if(s.pathOptions!==r.current){const u=s.pathOptions??{};a.instance.setStyle(u),r.current=u}},[a,s])}function Kr(a){return function(r){const c=Ke(),u=a(Je(r,c),c);return ei(u.current,r.eventHandlers),$o(u.current,c),$r(u.current,r),u}}function Jr(a,s){const r=tn(a,s),c=Ko(r);return Xo(c)}function Qr(a,s){const r=tn(a),c=Xr(r,s);return qr(c)}function ts(a,s){const r=tn(a,s),c=Kr(r);return Xo(c)}function es(a,s){const r=tn(a,s),c=Ko(r);return Yr(c)}function ns(a,s,r){const{opacity:c,zIndex:u}=s;c!=null&&c!==r.opacity&&a.setOpacity(c),u!=null&&u!==r.zIndex&&a.setZIndex(u)}function Jo(){return Ke().map}function is(a){const s=Jo();return T.useEffect(function(){return s.on(a),function(){s.off(a)}},[s,a]),s}function Xn(){return Xn=Object.assign||function(a){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(a[c]=r[c])}return a},Xn.apply(this,arguments)}function os({bounds:a,boundsOptions:s,center:r,children:c,className:u,id:f,placeholder:m,style:v,whenReady:_,zoom:b,...I},E){const[Z]=T.useState({className:u,id:f,style:v}),[B,O]=T.useState(null);T.useImperativeHandle(E,()=>(B==null?void 0:B.map)??null,[B]);const A=T.useCallback(X=>{if(X!==null&&B===null){const C=new $t.Map(X,I);r!=null&&b!=null?C.setView(r,b):a!=null&&C.fitBounds(a,s),_!=null&&C.whenReady(_),O(Vr(C))}},[]);T.useEffect(()=>()=>{B==null||B.map.remove()},[B]);const G=B?qn.createElement(Yo,{value:B},c):m??null;return qn.createElement("div",Xn({},Z,{ref:A}),G)}const as=T.forwardRef(os),Qo=Jr(function({position:s,...r},c){const u=new $t.Marker(s,r);return Qe(u,Vo(c,{overlayContainer:u}))},function(s,r,c){r.position!==c.position&&s.setLatLng(r.position),r.icon!=null&&r.icon!==c.icon&&s.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==c.zIndexOffset&&s.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==c.opacity&&s.setOpacity(r.opacity),s.dragging!=null&&r.draggable!==c.draggable&&(r.draggable===!0?s.dragging.enable():s.dragging.disable())}),jn=ts(function({positions:s,...r},c){const u=new $t.Polyline(s,r);return Qe(u,Vo(c,{overlayContainer:u}))},function(s,r,c){r.positions!==c.positions&&s.setLatLngs(r.positions)}),ta=Qr(function(s,r){const c=new $t.Popup(s,r.overlayContainer);return Qe(c,r)},function(s,r,{position:c},u){T.useEffect(function(){const{instance:m}=s;function v(b){b.popup===m&&(m.update(),u(!0))}function _(b){b.popup===m&&u(!1)}return r.map.on({popupopen:v,popupclose:_}),r.overlayContainer==null?(c!=null&&m.setLatLng(c),m.openOn(r.map)):r.overlayContainer.bindPopup(m),function(){var I;r.map.off({popupopen:v,popupclose:_}),(I=r.overlayContainer)==null||I.unbindPopup(),r.map.removeLayer(m)}},[s,r,u,c])}),rs=es(function({url:s,...r},c){const u=new $t.TileLayer(s,Je(r,c));return Qe(u,c)},function(s,r,c){ns(s,r,c);const{url:u}=r;u!=null&&u!==c.url&&s.setUrl(u)}),xo=({position:a,onDragEnd:s,icon:r,label:c,draggable:u=!0})=>{const f=T.useRef(null);T.useEffect(()=>{f.current&&f.current.setLatLng(a)},[a]);const m=v=>{const _=v.target;s(_.getLatLng())};return x.jsx(Qo,{"data-component-path":"src\\components\\map\\DraggableMarker.tsx","data-component-name":"Marker","data-component-line":"34","data-component-file":"DraggableMarker.tsx","data-component-content":"%7B%7D",position:a,draggable:u,icon:r,eventHandlers:{dragend:m},ref:f,children:x.jsx(ta,{"data-component-path":"src\\components\\map\\DraggableMarker.tsx","data-component-name":"Popup","data-component-line":"43","data-component-file":"DraggableMarker.tsx","data-component-content":"%7B%7D",children:x.jsx("div",{"data-component-path":"src\\components\\map\\DraggableMarker.tsx","data-component-name":"div","data-component-line":"44","data-component-file":"DraggableMarker.tsx","data-component-content":"%7B%22className%22%3A%22font-semibold%22%7D",className:"font-semibold",children:c})})})};var ea={exports:{}};(function(a){var s={};function r(f){return Math.floor(Math.abs(f)+.5)*(f>=0?1:-1)}function c(f,m,v){f=r(f*v),m=r(m*v);var _=(f-m)*2;_<0&&(_=-_-1);for(var b="";_>=32;)b+=String.fromCharCode((32|_&31)+63),_/=32;return b+=String.fromCharCode((_|0)+63),b}s.decode=function(f,m){for(var v=0,_=0,b=0,I=[],E=0,Z=0,B=null,O,A,G=Math.pow(10,Number.isInteger(m)?m:5);v<f.length;){B=null,E=1,Z=0;do B=f.charCodeAt(v++)-63,Z+=(B&31)*E,E*=32;while(B>=32);O=Z&1?(-Z-1)/2:Z/2,E=1,Z=0;do B=f.charCodeAt(v++)-63,Z+=(B&31)*E,E*=32;while(B>=32);A=Z&1?(-Z-1)/2:Z/2,_+=O,b+=A,I.push([_/G,b/G])}return I},s.encode=function(f,m){if(!f.length)return"";for(var v=Math.pow(10,Number.isInteger(m)?m:5),_=c(f[0][0],0,v)+c(f[0][1],0,v),b=1;b<f.length;b++){var I=f[b],E=f[b-1];_+=c(I[0],E[0],v),_+=c(I[1],E[1],v)}return _};function u(f){for(var m=[],v=0;v<f.length;v++){var _=f[v].slice();m.push([_[1],_[0]])}return m}s.fromGeoJSON=function(f,m){if(f&&f.type==="Feature"&&(f=f.geometry),!f||f.type!=="LineString")throw new Error("Input must be a GeoJSON LineString");return s.encode(u(f.coordinates),m)},s.toGeoJSON=function(f,m){var v=s.decode(f,m);return{type:"LineString",coordinates:u(v)}},a.exports&&(a.exports=s)})(ea);var Un=ea.exports;const ss=["https://routing.openstreetmap.de/routed-car/route/v1/driving","https://router.project-osrm.org/route/v1/driving"],$n=1100,qe=3,ls=2;let wo=0,Po=Promise.resolve();const Kn=a=>new Promise(s=>setTimeout(s,a)),bo=a=>Math.min($n*Math.pow(ls,a),5e3),cs=async()=>{const s=Date.now()-wo;s<$n&&await Kn($n-s),wo=Date.now()};async function Jn(a,s,r,c=0){const u=[];await cs();for(const f of a)try{const m=`${f}/${s}?overview=full&geometries=polyline`,v=await fetch(m,{...r,method:"GET",mode:"cors",headers:{Accept:"application/json","User-Agent":"TowingServiceApplication/1.0",Referer:"https://mrgruas.com"}});if(!v.ok)throw new Error(`HTTP error! status: ${v.status}`);if(v.status===429){const _=bo(c);if(await Kn(_),c<qe)return Jn(a,s,r,c+1)}return v}catch(m){console.error(`Error with ${f}:`,m),u.push(m instanceof Error?m:new Error(`Unknown error from ${f}`));continue}if(c<qe){console.log(`Retrying request, attempt ${c+1} of ${qe}`);const f=bo(c);return await Kn(f),Jn(a,s,r,c+1)}throw new Error(`All routing services failed after ${qe} retries. Errors: ${u.map(f=>f.message).join(", ")}`)}async function hs(a,s){const r=`${a.lng},${a.lat};${s.lng},${s.lat}`;try{const u=await new Promise((f,m)=>{Po=Po.then(()=>Jn(ss,r,{headers:{Accept:"application/json","User-Agent":"TowingServiceApplication/1.0",Referer:"https://mrgruas.com"}})).then(v=>v.json()).then(f).catch(m)});if(!u.routes||u.routes.length===0)throw new Error("No route found between the specified locations.");return{distance:u.routes[0].distance/1e3,duration:u.routes[0].duration,geometry:u.routes[0].geometry}}catch(c){throw c}}const To={lat:26.509672,lng:-100.0095504},le=async(a,s)=>{try{const r=await hs(a,s),c=us();return{...r,distance:r.distance*c,duration:r.duration*c}}catch{throw new Error("Failed to calculate route details")}},us=()=>{const a=new Date().getHours();return a>=7&&a<=9||a>=17&&a<=19?1.3:a>=22||a<=5?.9:1},Me={lat:26.510272,lng:-100.006323},ds=({pickupLocation:a,dropLocation:s,onRouteCalculated:r})=>{const[c,u]=T.useState([]),[f,m]=T.useState([]),[v,_]=T.useState([]),{updateTowingInfo:b}=Ro(),{toast:I}=Xt();return T.useEffect(()=>{(async()=>{if(a&&s)try{const Z=await le(Me,a);u(Un.decode(Z.geometry).map(([G,X])=>[G,X]));const B=await le(a,s);m(Un.decode(B.geometry).map(([G,X])=>[G,X]));const O=await le(s,Me);_(Un.decode(O.geometry).map(([G,X])=>[G,X]));const A=Z.distance+B.distance+O.distance;b(A),r==null||r(A),Wo(A)}catch(Z){console.error("Error calculating routes:",Z),I({title:"Error al calcular la ruta",description:Z instanceof Error?Z.message:"Por favor, intente nuevamente en unos segundos",variant:"destructive"})}})()},[a,s,r,b,I]),x.jsxs(x.Fragment,{children:[c.length>0&&x.jsx(jn,{"data-component-path":"src\\components\\map\\RoutePolyline.tsx","data-component-name":"Polyline","data-component-line":"94","data-component-file":"RoutePolyline.tsx","data-component-content":"%7B%7D",positions:c,color:"blue",weight:3,dashArray:"10, 10",opacity:.7}),f.length>0&&x.jsx(jn,{"data-component-path":"src\\components\\map\\RoutePolyline.tsx","data-component-name":"Polyline","data-component-line":"103","data-component-file":"RoutePolyline.tsx","data-component-content":"%7B%7D",positions:f,color:"green",weight:3,opacity:.9}),v.length>0&&x.jsx(jn,{"data-component-path":"src\\components\\map\\RoutePolyline.tsx","data-component-name":"Polyline","data-component-line":"111","data-component-file":"RoutePolyline.tsx","data-component-content":"%7B%7D",positions:v,color:"red",weight:3,dashArray:"10, 10",opacity:.7})]})},fs="https://nominatim.openstreetmap.org",Lo={lat:25.5922,lng:-99.9962},Mo=1e3;let Co=0;const na=a=>new Promise(s=>setTimeout(s,a)),ps=async(a,s,r=3)=>{const c={Accept:"application/json","User-Agent":"MRGruas Application (https://mrgruas.github.io)",Referer:"https://mrgruas.github.io",Origin:window.location.origin};for(let u=0;u<r;u++)try{const f=await fetch(a,{...s,headers:{...c,...s==null?void 0:s.headers},mode:"cors",credentials:"omit"});if(!f.ok)throw new Error(`HTTP error! status: ${f.status}`);return f}catch(f){if(console.error(`Attempt ${u+1} failed:`,f),u===r-1)return new Response(JSON.stringify([{lat:Lo.lat,lon:Lo.lng,display_name:"Ubicación en Nuevo León",importance:.5}]));await na(1e3*Math.pow(2,u))}throw new Error("Max retries reached")},$e=async(a,s,r={})=>{const c=Date.now()-Co;c<Mo&&await na(Mo-c);try{Co=Date.now();const u=new URLSearchParams({format:"json",lat:a.toString(),lon:s.toString(),"accept-language":r.language||"es"});return(await(await ps(`${fs}/reverse?${u.toString()}`)).json()).display_name||"Ubicación seleccionada"}catch(u){return console.error("Error fetching address:",u),"Ubicación seleccionada"}},ms=({selectingPickup:a,selectingDrop:s,handleLocationSelect:r,currentPickupLocation:c})=>{const{toast:u}=Xt();return is({click:async m=>{if(a||s)try{const v={lat:m.latlng.lat,lng:m.latlng.lng,address:await $e(m.latlng.lat,m.latlng.lng)};r(v),u({title:a?"Punto de recogida marcado":"Punto de entrega marcado",description:v.address})}catch{u({title:"Error",description:"No se pudo obtener la dirección de la ubicación seleccionada",variant:"destructive"})}}}),null},_s=new ni.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),gs=new ni.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),vs=new ni.Icon({iconUrl:"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),ia=T.memo(({pickupLocation:a,dropLocation:s})=>{const r=Jo(),{toast:c}=Xt(),u=T.useRef(0);return T.useEffect(()=>{const f=Date.now();if(a&&s){const m=new $t.LatLngBounds([a.lat,a.lng],[s.lat,s.lng]);r.fitBounds(m,{padding:[50,50]}),f-u.current>3e3&&(c({title:"Ruta actualizada",description:"El mapa se ha ajustado para mostrar la ruta completa"}),u.current=f)}else a?r.setView([a.lat,a.lng],15):s&&r.setView([s.lat,s.lng],15)},[r,a,s,c]),null});ia.displayName="MapUpdater";const oa=T.memo(({pickupLocation:a,dropLocation:s,selectingPickup:r,selectingDrop:c,onLocationSelect:u,setPickupLocation:f,setDropLocation:m,onRouteCalculated:v,isLoading:_=!1})=>{const{toast:b}=Xt(),I=T.useRef(0),E=T.useCallback(async O=>{try{const A=Date.now(),G=await $e(O.lat,O.lng);A-I.current>3e3&&(b({title:r?"Punto de recogida seleccionado":"Punto de entrega seleccionado",description:G,duration:3e3}),I.current=A),u(O)}catch{const G=Date.now();G-I.current>3e3&&(b({title:"Error",description:"No se pudo obtener la dirección",variant:"destructive",duration:3e3}),I.current=G)}},[u,r,b]),Z=T.useCallback(async(O,A)=>{const G={lat:O.lat,lng:O.lng};A==="pickup"?f(G):m(G),await E(G)},[E,f,m]),B=[25.6866,-100.3161];return x.jsxs(as,{"data-component-path":"src\\components\\map\\MapContainer.tsx","data-component-name":"MapContainer","data-component-line":"136","data-component-file":"MapContainer.tsx","data-component-content":"%7B%22className%22%3A%22w-full%20h-full%20rounded-lg%20shadow-lg%22%7D",center:B,zoom:13,className:"w-full h-full rounded-lg shadow-lg",zoomControl:!1,children:[x.jsx(rs,{"data-component-path":"src\\components\\map\\MapContainer.tsx","data-component-name":"TileLayer","data-component-line":"142","data-component-file":"MapContainer.tsx","data-component-content":"%7B%22className%22%3A%22brightness-95%22%7D",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",className:"brightness-95"}),x.jsx(ms,{"data-component-path":"src\\components\\map\\MapContainer.tsx","data-component-name":"MapLocationHandler","data-component-line":"148","data-component-file":"MapContainer.tsx","data-component-content":"%7B%7D",selectingPickup:r,selectingDrop:c,handleLocationSelect:E}),x.jsx(ia,{"data-component-path":"src\\components\\map\\MapContainer.tsx","data-component-name":"MapUpdater","data-component-line":"154","data-component-file":"MapContainer.tsx","data-component-content":"%7B%7D",pickupLocation:a,dropLocation:s}),x.jsx(Qo,{"data-component-path":"src\\components\\map\\MapContainer.tsx","data-component-name":"Marker","data-component-line":"159","data-component-file":"MapContainer.tsx","data-component-content":"%7B%7D",position:[To.lat,To.lng],icon:_s,children:x.jsxs(ta,{"data-component-path":"src\\components\\map\\MapContainer.tsx","data-component-name":"Popup","data-component-line":"163","data-component-file":"MapContainer.tsx","data-component-content":"%7B%22className%22%3A%22rounded-lg%20shadow-lg%22%7D",className:"rounded-lg shadow-lg",children:[x.jsx("div",{"data-component-path":"src\\components\\map\\MapContainer.tsx","data-component-name":"div","data-component-line":"164","data-component-file":"MapContainer.tsx","data-component-content":"%7B%22text%22%3A%22Empresa%20de%20Gr%C3%BAas%22%2C%22className%22%3A%22font-semibold%22%7D",className:"font-semibold",children:"Empresa de Grúas"}),x.jsx("div",{"data-component-path":"src\\components\\map\\MapContainer.tsx","data-component-name":"div","data-component-line":"165","data-component-file":"MapContainer.tsx","data-component-content":"%7B%22text%22%3A%22Ubicaci%C3%B3n%20Principal%22%2C%22className%22%3A%22text-sm%20text-gray-600%22%7D",className:"text-sm text-gray-600",children:"Ubicación Principal"})]})}),a&&x.jsx(xo,{"data-component-path":"src\\components\\map\\MapContainer.tsx","data-component-name":"DraggableMarker","data-component-line":"170","data-component-file":"MapContainer.tsx","data-component-content":"%7B%7D",position:[a.lat,a.lng],onDragEnd:O=>Z(O,"pickup"),icon:gs,label:"Punto de Recogida",draggable:!_}),s&&x.jsx(xo,{"data-component-path":"src\\components\\map\\MapContainer.tsx","data-component-name":"DraggableMarker","data-component-line":"180","data-component-file":"MapContainer.tsx","data-component-content":"%7B%7D",position:[s.lat,s.lng],onDragEnd:O=>Z(O,"drop"),icon:vs,label:"Punto de Entrega",draggable:!_}),a&&s&&x.jsx(ds,{"data-component-path":"src\\components\\map\\MapContainer.tsx","data-component-name":"RoutePolyline","data-component-line":"190","data-component-file":"MapContainer.tsx","data-component-content":"%7B%7D",pickupLocation:a,dropLocation:s,onRouteCalculated:v})]})});oa.displayName="MapContainerComponent";const ys=({selectingPickup:a,selectingDrop:s,onPickupClick:r,onDropClick:c})=>x.jsxs("div",{"data-component-path":"src\\components\\map\\MapControls.tsx","data-component-name":"div","data-component-line":"19","data-component-file":"MapControls.tsx","data-component-content":"%7B%22className%22%3A%22flex%20flex-col%20sm%3Aflex-row%20gap-4%22%7D",className:"flex flex-col sm:flex-row gap-4",children:[x.jsxs(go,{"data-component-path":"src\\components\\map\\MapControls.tsx","data-component-name":"Button","data-component-line":"20","data-component-file":"MapControls.tsx","data-component-content":"%7B%22text%22%3A%22Seleccionar%20Punto%20de%20Recogida%22%7D",variant:a?"secondary":"outline",onClick:r,className:Le("flex-1 flex items-center justify-center gap-3 h-14 text-base font-medium","bg-white/95 backdrop-blur-sm border border-gray-200","hover:bg-primary/10 hover:border-primary/50","active:scale-[0.98] transition-all duration-200","shadow-sm hover:shadow-md",a&&"bg-primary/10 border-primary text-primary"),children:[x.jsx(Qn,{"data-component-path":"src\\components\\map\\MapControls.tsx","data-component-name":"MapPin","data-component-line":"32","data-component-file":"MapControls.tsx","data-component-content":"%7B%7D",className:Le("w-5 h-5 transition-colors",a?"text-primary":"text-gray-600")}),"Seleccionar Punto de Recogida"]}),x.jsxs(go,{"data-component-path":"src\\components\\map\\MapControls.tsx","data-component-name":"Button","data-component-line":"40","data-component-file":"MapControls.tsx","data-component-content":"%7B%22text%22%3A%22Seleccionar%20Punto%20de%20Entrega%22%7D",variant:s?"secondary":"outline",onClick:c,className:Le("flex-1 flex items-center justify-center gap-3 h-14 text-base font-medium","bg-white/95 backdrop-blur-sm border border-gray-200","hover:bg-primary/10 hover:border-primary/50","active:scale-[0.98] transition-all duration-200","shadow-sm hover:shadow-md",s&&"bg-primary/10 border-primary text-primary"),children:[x.jsx(jo,{"data-component-path":"src\\components\\map\\MapControls.tsx","data-component-name":"Navigation","data-component-line":"52","data-component-file":"MapControls.tsx","data-component-content":"%7B%7D",className:Le("w-5 h-5 transition-colors",s?"text-primary":"text-gray-600")}),"Seleccionar Punto de Entrega"]})]});var en={exports:{}},aa={};function ra(a){var s,r,c="";if(typeof a=="string"||typeof a=="number")c+=a;else if(typeof a=="object")if(Array.isArray(a))for(s=0;s<a.length;s++)a[s]&&(r=ra(a[s]))&&(c&&(c+=" "),c+=r);else for(s in a)a[s]&&(c&&(c+=" "),c+=s);return c}function So(){for(var a,s,r=0,c="";r<arguments.length;)(a=arguments[r++])&&(s=ra(a))&&(c&&(c+=" "),c+=s);return c}const xs=Object.freeze(Object.defineProperty({__proto__:null,clsx:So,default:So},Symbol.toStringTag,{value:"Module"})),ws=Fr(xs);var J={},Et={};Object.defineProperty(Et,"__esModule",{value:!0});Et.dontSetMe=Ms;Et.findInArray=Ps;Et.int=Ls;Et.isFunction=bs;Et.isNum=Ts;function Ps(a,s){for(let r=0,c=a.length;r<c;r++)if(s.apply(s,[a[r],r,a]))return a[r]}function bs(a){return typeof a=="function"||Object.prototype.toString.call(a)==="[object Function]"}function Ts(a){return typeof a=="number"&&!isNaN(a)}function Ls(a){return parseInt(a,10)}function Ms(a,s,r){if(a[s])return new Error("Invalid prop ".concat(s," passed to ").concat(r," - do not set this, set it on the child."))}var Kt={};Object.defineProperty(Kt,"__esModule",{value:!0});Kt.browserPrefixToKey=la;Kt.browserPrefixToStyle=Cs;Kt.default=void 0;Kt.getPrefix=sa;const Wn=["Moz","Webkit","O","ms"];function sa(){var a;let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const r=(a=window.document)===null||a===void 0||(a=a.documentElement)===null||a===void 0?void 0:a.style;if(!r||s in r)return"";for(let c=0;c<Wn.length;c++)if(la(s,Wn[c])in r)return Wn[c];return""}function la(a,s){return s?"".concat(s).concat(Ss(a)):a}function Cs(a,s){return s?"-".concat(s.toLowerCase(),"-").concat(a):a}function Ss(a){let s="",r=!0;for(let c=0;c<a.length;c++)r?(s+=a[c].toUpperCase(),r=!1):a[c]==="-"?r=!0:s+=a[c];return s}Kt.default=sa();Object.defineProperty(J,"__esModule",{value:!0});J.addClassName=ua;J.addEvent=Ds;J.addUserSelectStyles=js;J.createCSSTransform=Rs;J.createSVGTransform=Zs;J.getTouch=Hs;J.getTouchIdentifier=Fs;J.getTranslation=ii;J.innerHeight=Ns;J.innerWidth=zs;J.matchesSelector=ha;J.matchesSelectorAndParentsTo=Os;J.offsetXYFromParent=Bs;J.outerHeight=As;J.outerWidth=Is;J.removeClassName=da;J.removeEvent=ks;J.removeUserSelectStyles=Us;var _t=Et,Eo=Es(Kt);function ca(a){if(typeof WeakMap!="function")return null;var s=new WeakMap,r=new WeakMap;return(ca=function(c){return c?r:s})(a)}function Es(a,s){if(a&&a.__esModule)return a;if(a===null||typeof a!="object"&&typeof a!="function")return{default:a};var r=ca(s);if(r&&r.has(a))return r.get(a);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if(f!=="default"&&Object.prototype.hasOwnProperty.call(a,f)){var m=u?Object.getOwnPropertyDescriptor(a,f):null;m&&(m.get||m.set)?Object.defineProperty(c,f,m):c[f]=a[f]}return c.default=a,r&&r.set(a,c),c}let Ye="";function ha(a,s){return Ye||(Ye=(0,_t.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(r){return(0,_t.isFunction)(a[r])})),(0,_t.isFunction)(a[Ye])?a[Ye](s):!1}function Os(a,s,r){let c=a;do{if(ha(c,s))return!0;if(c===r)return!1;c=c.parentNode}while(c);return!1}function Ds(a,s,r,c){if(!a)return;const u={capture:!0,...c};a.addEventListener?a.addEventListener(s,r,u):a.attachEvent?a.attachEvent("on"+s,r):a["on"+s]=r}function ks(a,s,r,c){if(!a)return;const u={capture:!0,...c};a.removeEventListener?a.removeEventListener(s,r,u):a.detachEvent?a.detachEvent("on"+s,r):a["on"+s]=null}function As(a){let s=a.clientHeight;const r=a.ownerDocument.defaultView.getComputedStyle(a);return s+=(0,_t.int)(r.borderTopWidth),s+=(0,_t.int)(r.borderBottomWidth),s}function Is(a){let s=a.clientWidth;const r=a.ownerDocument.defaultView.getComputedStyle(a);return s+=(0,_t.int)(r.borderLeftWidth),s+=(0,_t.int)(r.borderRightWidth),s}function Ns(a){let s=a.clientHeight;const r=a.ownerDocument.defaultView.getComputedStyle(a);return s-=(0,_t.int)(r.paddingTop),s-=(0,_t.int)(r.paddingBottom),s}function zs(a){let s=a.clientWidth;const r=a.ownerDocument.defaultView.getComputedStyle(a);return s-=(0,_t.int)(r.paddingLeft),s-=(0,_t.int)(r.paddingRight),s}function Bs(a,s,r){const u=s===s.ownerDocument.body?{left:0,top:0}:s.getBoundingClientRect(),f=(a.clientX+s.scrollLeft-u.left)/r,m=(a.clientY+s.scrollTop-u.top)/r;return{x:f,y:m}}function Rs(a,s){const r=ii(a,s,"px");return{[(0,Eo.browserPrefixToKey)("transform",Eo.default)]:r}}function Zs(a,s){return ii(a,s,"")}function ii(a,s,r){let{x:c,y:u}=a,f="translate(".concat(c).concat(r,",").concat(u).concat(r,")");if(s){const m="".concat(typeof s.x=="string"?s.x:s.x+r),v="".concat(typeof s.y=="string"?s.y:s.y+r);f="translate(".concat(m,", ").concat(v,")")+f}return f}function Hs(a,s){return a.targetTouches&&(0,_t.findInArray)(a.targetTouches,r=>s===r.identifier)||a.changedTouches&&(0,_t.findInArray)(a.changedTouches,r=>s===r.identifier)}function Fs(a){if(a.targetTouches&&a.targetTouches[0])return a.targetTouches[0].identifier;if(a.changedTouches&&a.changedTouches[0])return a.changedTouches[0].identifier}function js(a){if(!a)return;let s=a.getElementById("react-draggable-style-el");s||(s=a.createElement("style"),s.type="text/css",s.id="react-draggable-style-el",s.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,s.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,a.getElementsByTagName("head")[0].appendChild(s)),a.body&&ua(a.body,"react-draggable-transparent-selection")}function Us(a){if(a)try{if(a.body&&da(a.body,"react-draggable-transparent-selection"),a.selection)a.selection.empty();else{const s=(a.defaultView||window).getSelection();s&&s.type!=="Caret"&&s.removeAllRanges()}}catch{}}function ua(a,s){a.classList?a.classList.add(s):a.className.match(new RegExp("(?:^|\\s)".concat(s,"(?!\\S)")))||(a.className+=" ".concat(s))}function da(a,s){a.classList?a.classList.remove(s):a.className=a.className.replace(new RegExp("(?:^|\\s)".concat(s,"(?!\\S)"),"g"),"")}var Ot={};Object.defineProperty(Ot,"__esModule",{value:!0});Ot.canDragX=Vs;Ot.canDragY=qs;Ot.createCoreData=Xs;Ot.createDraggableData=$s;Ot.getBoundPosition=Ws;Ot.getControlPosition=Ys;Ot.snapToGrid=Gs;var mt=Et,se=J;function Ws(a,s,r){if(!a.props.bounds)return[s,r];let{bounds:c}=a.props;c=typeof c=="string"?c:Ks(c);const u=oi(a);if(typeof c=="string"){const{ownerDocument:f}=u,m=f.defaultView;let v;if(c==="parent"?v=u.parentNode:v=f.querySelector(c),!(v instanceof m.HTMLElement))throw new Error('Bounds selector "'+c+'" could not find an element.');const _=v,b=m.getComputedStyle(u),I=m.getComputedStyle(_);c={left:-u.offsetLeft+(0,mt.int)(I.paddingLeft)+(0,mt.int)(b.marginLeft),top:-u.offsetTop+(0,mt.int)(I.paddingTop)+(0,mt.int)(b.marginTop),right:(0,se.innerWidth)(_)-(0,se.outerWidth)(u)-u.offsetLeft+(0,mt.int)(I.paddingRight)-(0,mt.int)(b.marginRight),bottom:(0,se.innerHeight)(_)-(0,se.outerHeight)(u)-u.offsetTop+(0,mt.int)(I.paddingBottom)-(0,mt.int)(b.marginBottom)}}return(0,mt.isNum)(c.right)&&(s=Math.min(s,c.right)),(0,mt.isNum)(c.bottom)&&(r=Math.min(r,c.bottom)),(0,mt.isNum)(c.left)&&(s=Math.max(s,c.left)),(0,mt.isNum)(c.top)&&(r=Math.max(r,c.top)),[s,r]}function Gs(a,s,r){const c=Math.round(s/a[0])*a[0],u=Math.round(r/a[1])*a[1];return[c,u]}function Vs(a){return a.props.axis==="both"||a.props.axis==="x"}function qs(a){return a.props.axis==="both"||a.props.axis==="y"}function Ys(a,s,r){const c=typeof s=="number"?(0,se.getTouch)(a,s):null;if(typeof s=="number"&&!c)return null;const u=oi(r),f=r.props.offsetParent||u.offsetParent||u.ownerDocument.body;return(0,se.offsetXYFromParent)(c||a,f,r.props.scale)}function Xs(a,s,r){const c=!(0,mt.isNum)(a.lastX),u=oi(a);return c?{node:u,deltaX:0,deltaY:0,lastX:s,lastY:r,x:s,y:r}:{node:u,deltaX:s-a.lastX,deltaY:r-a.lastY,lastX:a.lastX,lastY:a.lastY,x:s,y:r}}function $s(a,s){const r=a.props.scale;return{node:s.node,x:a.state.x+s.deltaX/r,y:a.state.y+s.deltaY/r,deltaX:s.deltaX/r,deltaY:s.deltaY/r,lastX:a.state.x,lastY:a.state.y}}function Ks(a){return{left:a.left,top:a.top,right:a.right,bottom:a.bottom}}function oi(a){const s=a.findDOMNode();if(!s)throw new Error("<DraggableCore>: Unmounted during event!");return s}var nn={},on={};Object.defineProperty(on,"__esModule",{value:!0});on.default=Js;function Js(){}Object.defineProperty(nn,"__esModule",{value:!0});nn.default=void 0;var Gn=tl(T),pt=ai(Zo),Qs=ai(ti),rt=J,jt=Ot,Vn=Et,Te=ai(on);function ai(a){return a&&a.__esModule?a:{default:a}}function fa(a){if(typeof WeakMap!="function")return null;var s=new WeakMap,r=new WeakMap;return(fa=function(c){return c?r:s})(a)}function tl(a,s){if(a&&a.__esModule)return a;if(a===null||typeof a!="object"&&typeof a!="function")return{default:a};var r=fa(s);if(r&&r.has(a))return r.get(a);var c={},u=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var f in a)if(f!=="default"&&Object.prototype.hasOwnProperty.call(a,f)){var m=u?Object.getOwnPropertyDescriptor(a,f):null;m&&(m.get||m.set)?Object.defineProperty(c,f,m):c[f]=a[f]}return c.default=a,r&&r.set(a,c),c}function ct(a,s,r){return s=el(s),s in a?Object.defineProperty(a,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[s]=r,a}function el(a){var s=nl(a,"string");return typeof s=="symbol"?s:String(s)}function nl(a,s){if(typeof a!="object"||a===null)return a;var r=a[Symbol.toPrimitive];if(r!==void 0){var c=r.call(a,s||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const Tt={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let Ut=Tt.mouse,an=class extends Gn.Component{constructor(){super(...arguments),ct(this,"dragging",!1),ct(this,"lastX",NaN),ct(this,"lastY",NaN),ct(this,"touchIdentifier",null),ct(this,"mounted",!1),ct(this,"handleDragStart",s=>{if(this.props.onMouseDown(s),!this.props.allowAnyClick&&typeof s.button=="number"&&s.button!==0)return!1;const r=this.findDOMNode();if(!r||!r.ownerDocument||!r.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:c}=r;if(this.props.disabled||!(s.target instanceof c.defaultView.Node)||this.props.handle&&!(0,rt.matchesSelectorAndParentsTo)(s.target,this.props.handle,r)||this.props.cancel&&(0,rt.matchesSelectorAndParentsTo)(s.target,this.props.cancel,r))return;s.type==="touchstart"&&s.preventDefault();const u=(0,rt.getTouchIdentifier)(s);this.touchIdentifier=u;const f=(0,jt.getControlPosition)(s,u,this);if(f==null)return;const{x:m,y:v}=f,_=(0,jt.createCoreData)(this,m,v);(0,Te.default)("DraggableCore: handleDragStart: %j",_),(0,Te.default)("calling",this.props.onStart),!(this.props.onStart(s,_)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,rt.addUserSelectStyles)(c),this.dragging=!0,this.lastX=m,this.lastY=v,(0,rt.addEvent)(c,Ut.move,this.handleDrag),(0,rt.addEvent)(c,Ut.stop,this.handleDragStop))}),ct(this,"handleDrag",s=>{const r=(0,jt.getControlPosition)(s,this.touchIdentifier,this);if(r==null)return;let{x:c,y:u}=r;if(Array.isArray(this.props.grid)){let v=c-this.lastX,_=u-this.lastY;if([v,_]=(0,jt.snapToGrid)(this.props.grid,v,_),!v&&!_)return;c=this.lastX+v,u=this.lastY+_}const f=(0,jt.createCoreData)(this,c,u);if((0,Te.default)("DraggableCore: handleDrag: %j",f),this.props.onDrag(s,f)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const _=document.createEvent("MouseEvents");_.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(_)}return}this.lastX=c,this.lastY=u}),ct(this,"handleDragStop",s=>{if(!this.dragging)return;const r=(0,jt.getControlPosition)(s,this.touchIdentifier,this);if(r==null)return;let{x:c,y:u}=r;if(Array.isArray(this.props.grid)){let _=c-this.lastX||0,b=u-this.lastY||0;[_,b]=(0,jt.snapToGrid)(this.props.grid,_,b),c=this.lastX+_,u=this.lastY+b}const f=(0,jt.createCoreData)(this,c,u);if(this.props.onStop(s,f)===!1||this.mounted===!1)return!1;const v=this.findDOMNode();v&&this.props.enableUserSelectHack&&(0,rt.removeUserSelectStyles)(v.ownerDocument),(0,Te.default)("DraggableCore: handleDragStop: %j",f),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,v&&((0,Te.default)("DraggableCore: Removing handlers"),(0,rt.removeEvent)(v.ownerDocument,Ut.move,this.handleDrag),(0,rt.removeEvent)(v.ownerDocument,Ut.stop,this.handleDragStop))}),ct(this,"onMouseDown",s=>(Ut=Tt.mouse,this.handleDragStart(s))),ct(this,"onMouseUp",s=>(Ut=Tt.mouse,this.handleDragStop(s))),ct(this,"onTouchStart",s=>(Ut=Tt.touch,this.handleDragStart(s))),ct(this,"onTouchEnd",s=>(Ut=Tt.touch,this.handleDragStop(s)))}componentDidMount(){this.mounted=!0;const s=this.findDOMNode();s&&(0,rt.addEvent)(s,Tt.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const s=this.findDOMNode();if(s){const{ownerDocument:r}=s;(0,rt.removeEvent)(r,Tt.mouse.move,this.handleDrag),(0,rt.removeEvent)(r,Tt.touch.move,this.handleDrag),(0,rt.removeEvent)(r,Tt.mouse.stop,this.handleDragStop),(0,rt.removeEvent)(r,Tt.touch.stop,this.handleDragStop),(0,rt.removeEvent)(s,Tt.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,rt.removeUserSelectStyles)(r)}}findDOMNode(){var s,r;return(s=this.props)!==null&&s!==void 0&&s.nodeRef?(r=this.props)===null||r===void 0||(r=r.nodeRef)===null||r===void 0?void 0:r.current:Qs.default.findDOMNode(this)}render(){return Gn.cloneElement(Gn.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};nn.default=an;ct(an,"displayName","DraggableCore");ct(an,"propTypes",{allowAnyClick:pt.default.bool,children:pt.default.node.isRequired,disabled:pt.default.bool,enableUserSelectHack:pt.default.bool,offsetParent:function(a,s){if(a[s]&&a[s].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:pt.default.arrayOf(pt.default.number),handle:pt.default.string,cancel:pt.default.string,nodeRef:pt.default.object,onStart:pt.default.func,onDrag:pt.default.func,onStop:pt.default.func,onMouseDown:pt.default.func,scale:pt.default.number,className:Vn.dontSetMe,style:Vn.dontSetMe,transform:Vn.dontSetMe});ct(an,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(a){Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"DraggableCore",{enumerable:!0,get:function(){return _.default}}),a.default=void 0;var s=Z(T),r=I(Zo),c=I(ti),u=I(ws),f=J,m=Ot,v=Et,_=I(nn),b=I(on);function I(C){return C&&C.__esModule?C:{default:C}}function E(C){if(typeof WeakMap!="function")return null;var w=new WeakMap,P=new WeakMap;return(E=function(N){return N?P:w})(C)}function Z(C,w){if(C&&C.__esModule)return C;if(C===null||typeof C!="object"&&typeof C!="function")return{default:C};var P=E(w);if(P&&P.has(C))return P.get(C);var N={},Y=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var U in C)if(U!=="default"&&Object.prototype.hasOwnProperty.call(C,U)){var wt=Y?Object.getOwnPropertyDescriptor(C,U):null;wt&&(wt.get||wt.set)?Object.defineProperty(N,U,wt):N[U]=C[U]}return N.default=C,P&&P.set(C,N),N}function B(){return B=Object.assign?Object.assign.bind():function(C){for(var w=1;w<arguments.length;w++){var P=arguments[w];for(var N in P)Object.prototype.hasOwnProperty.call(P,N)&&(C[N]=P[N])}return C},B.apply(this,arguments)}function O(C,w,P){return w=A(w),w in C?Object.defineProperty(C,w,{value:P,enumerable:!0,configurable:!0,writable:!0}):C[w]=P,C}function A(C){var w=G(C,"string");return typeof w=="symbol"?w:String(w)}function G(C,w){if(typeof C!="object"||C===null)return C;var P=C[Symbol.toPrimitive];if(P!==void 0){var N=P.call(C,w||"default");if(typeof N!="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return(w==="string"?String:Number)(C)}class X extends s.Component{static getDerivedStateFromProps(w,P){let{position:N}=w,{prevPropsPosition:Y}=P;return N&&(!Y||N.x!==Y.x||N.y!==Y.y)?((0,b.default)("Draggable: getDerivedStateFromProps %j",{position:N,prevPropsPosition:Y}),{x:N.x,y:N.y,prevPropsPosition:{...N}}):null}constructor(w){super(w),O(this,"onDragStart",(P,N)=>{if((0,b.default)("Draggable: onDragStart: %j",N),this.props.onStart(P,(0,m.createDraggableData)(this,N))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),O(this,"onDrag",(P,N)=>{if(!this.state.dragging)return!1;(0,b.default)("Draggable: onDrag: %j",N);const Y=(0,m.createDraggableData)(this,N),U={x:Y.x,y:Y.y,slackX:0,slackY:0};if(this.props.bounds){const{x:Dt,y:kt}=U;U.x+=this.state.slackX,U.y+=this.state.slackY;const[it,st]=(0,m.getBoundPosition)(this,U.x,U.y);U.x=it,U.y=st,U.slackX=this.state.slackX+(Dt-U.x),U.slackY=this.state.slackY+(kt-U.y),Y.x=U.x,Y.y=U.y,Y.deltaX=U.x-this.state.x,Y.deltaY=U.y-this.state.y}if(this.props.onDrag(P,Y)===!1)return!1;this.setState(U)}),O(this,"onDragStop",(P,N)=>{if(!this.state.dragging||this.props.onStop(P,(0,m.createDraggableData)(this,N))===!1)return!1;(0,b.default)("Draggable: onDragStop: %j",N);const U={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:Dt,y:kt}=this.props.position;U.x=Dt,U.y=kt}this.setState(U)}),this.state={dragging:!1,dragged:!1,x:w.position?w.position.x:w.defaultPosition.x,y:w.position?w.position.y:w.defaultPosition.y,prevPropsPosition:{...w.position},slackX:0,slackY:0,isElementSVG:!1},w.position&&!(w.onDrag||w.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.setState({dragging:!1})}findDOMNode(){var w,P;return(w=(P=this.props)===null||P===void 0||(P=P.nodeRef)===null||P===void 0?void 0:P.current)!==null&&w!==void 0?w:c.default.findDOMNode(this)}render(){const{axis:w,bounds:P,children:N,defaultPosition:Y,defaultClassName:U,defaultClassNameDragging:wt,defaultClassNameDragged:Dt,position:kt,positionOffset:it,scale:st,...rn}=this.props;let gt={},Ce=null;const Rt=!!!kt||this.state.dragging,k=kt||Y,ce={x:(0,m.canDragX)(this)&&Rt?this.state.x:k.x,y:(0,m.canDragY)(this)&&Rt?this.state.y:k.y};this.state.isElementSVG?Ce=(0,f.createSVGTransform)(ce,it):gt=(0,f.createCSSTransform)(ce,it);const D=(0,u.default)(N.props.className||"",U,{[wt]:this.state.dragging,[Dt]:this.state.dragged});return s.createElement(_.default,B({},rn,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),s.cloneElement(s.Children.only(N),{className:D,style:{...N.props.style,...gt},transform:Ce}))}}a.default=X,O(X,"displayName","Draggable"),O(X,"propTypes",{..._.default.propTypes,axis:r.default.oneOf(["both","x","y","none"]),bounds:r.default.oneOfType([r.default.shape({left:r.default.number,right:r.default.number,top:r.default.number,bottom:r.default.number}),r.default.string,r.default.oneOf([!1])]),defaultClassName:r.default.string,defaultClassNameDragging:r.default.string,defaultClassNameDragged:r.default.string,defaultPosition:r.default.shape({x:r.default.number,y:r.default.number}),positionOffset:r.default.shape({x:r.default.oneOfType([r.default.number,r.default.string]),y:r.default.oneOfType([r.default.number,r.default.string])}),position:r.default.shape({x:r.default.number,y:r.default.number}),className:v.dontSetMe,style:v.dontSetMe,transform:v.dontSetMe}),O(X,"defaultProps",{..._.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(aa);const{default:pa,DraggableCore:il}=aa;en.exports=pa;en.exports.default=pa;en.exports.DraggableCore=il;var ol=en.exports;const al=Bo(ol),rl=({pickupLocation:a,dropLocation:s,pickupAddress:r,dropAddress:c,isLoading:u=!1})=>{Xt();const f=T.useRef(null);return!a&&!s?null:x.jsx(al,{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"Draggable","data-component-line":"29","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%7D",handle:".drag-handle",bounds:"parent",nodeRef:f,children:x.jsx("div",{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"div","data-component-line":"30","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%22className%22%3A%22absolute%20z-%5B1000%5D%20max-w-md%22%7D",ref:f,className:"absolute z-[1000] max-w-md",children:x.jsxs(Ho,{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"Card","data-component-line":"31","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%7D",className:Le("p-4 space-y-3 bg-white/95 backdrop-blur-sm shadow-lg transition-all duration-300","hover:shadow-xl border-blue-100/50"),children:[x.jsxs("div",{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"div","data-component-line":"37","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%22className%22%3A%22flex%20items-center%20justify-between%20border-b%20pb-2%20mb-2%20drag-handle%20cursor-move%22%7D",className:"flex items-center justify-between border-b pb-2 mb-2 drag-handle cursor-move",children:[x.jsx("div",{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"div","data-component-line":"38","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%22text%22%3A%22Detalles%20de%20Ubicaci%C3%B3n%22%2C%22className%22%3A%22font-semibold%20text-sm%20text-primary%2F90%22%7D",className:"font-semibold text-sm text-primary/90",children:"Detalles de Ubicación"}),u&&x.jsx(Fo,{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"Loader2","data-component-line":"42","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%22className%22%3A%22w-4%20h-4%20animate-spin%20text-primary%22%7D",className:"w-4 h-4 animate-spin text-primary"})]}),a&&x.jsxs("div",{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"div","data-component-line":"47","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%22className%22%3A%22flex%20items-start%20gap-2%22%7D",className:"flex items-start gap-2",children:[x.jsx(Qn,{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"MapPin","data-component-line":"48","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%20mt-1%20text-green-500%20flex-shrink-0%22%7D",className:"w-5 h-5 mt-1 text-green-500 flex-shrink-0"}),x.jsxs("div",{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"div","data-component-line":"49","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%22className%22%3A%22flex-1%22%7D",className:"flex-1",children:[x.jsx("div",{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"div","data-component-line":"50","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%22text%22%3A%22Punto%20de%20Recogida%22%2C%22className%22%3A%22font-semibold%20text-sm%22%7D",className:"font-semibold text-sm",children:"Punto de Recogida"}),x.jsx("div",{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"div","data-component-line":"51","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%22className%22%3A%22text-sm%20text-gray-600%20break-words%22%7D",className:"text-sm text-gray-600 break-words",children:r||"Cargando dirección..."}),x.jsxs("div",{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"div","data-component-line":"54","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%22text%22%3A%22Coordenadas%3A%20%2C%22%2C%22className%22%3A%22text-xs%20text-gray-500%20mt-1%22%7D",className:"text-xs text-gray-500 mt-1",children:["Coordenadas: ",a.lat.toFixed(6),","," ",a.lng.toFixed(6)]})]})]}),s&&x.jsxs("div",{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"div","data-component-line":"63","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%22className%22%3A%22flex%20items-start%20gap-2%22%7D",className:"flex items-start gap-2",children:[x.jsx(jo,{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"Navigation","data-component-line":"64","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%22className%22%3A%22w-5%20h-5%20mt-1%20text-red-500%20flex-shrink-0%22%7D",className:"w-5 h-5 mt-1 text-red-500 flex-shrink-0"}),x.jsxs("div",{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"div","data-component-line":"65","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%22className%22%3A%22flex-1%22%7D",className:"flex-1",children:[x.jsx("div",{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"div","data-component-line":"66","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%22text%22%3A%22Punto%20de%20Entrega%22%2C%22className%22%3A%22font-semibold%20text-sm%22%7D",className:"font-semibold text-sm",children:"Punto de Entrega"}),x.jsx("div",{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"div","data-component-line":"67","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%22className%22%3A%22text-sm%20text-gray-600%20break-words%22%7D",className:"text-sm text-gray-600 break-words",children:c||"Cargando dirección..."}),x.jsxs("div",{"data-component-path":"src\\components\\map\\RouteStreetInfo.tsx","data-component-name":"div","data-component-line":"70","data-component-file":"RouteStreetInfo.tsx","data-component-content":"%7B%22text%22%3A%22Coordenadas%3A%20%2C%22%2C%22className%22%3A%22text-xs%20text-gray-500%20mt-1%22%7D",className:"text-xs text-gray-500 mt-1",children:["Coordenadas: ",s.lat.toFixed(6),","," ",s.lng.toFixed(6)]})]})]})]})})})},sl=({selectingPickup:a,selectingDrop:s,setSelectingPickup:r,setSelectingDrop:c,pickupLocation:u,dropLocation:f,pickupAddress:m,dropAddress:v,isLoading:_=!1})=>{const{toast:b}=Xt();return x.jsxs("div",{"data-component-path":"src\\components\\map\\MapControlPanel.tsx","data-component-name":"div","data-component-line":"35","data-component-file":"MapControlPanel.tsx","data-component-content":"%7B%22className%22%3A%22px-4%20sm%3Apx-6%20flex%20flex-col%20items-center%20gap-6%20pointer-events-auto%20max-w-3xl%20mx-auto%20w-full%22%7D",className:"px-4 sm:px-6 flex flex-col items-center gap-6 pointer-events-auto max-w-3xl mx-auto w-full",children:[x.jsx(Fn.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full",children:x.jsxs(Ho,{"data-component-path":"src\\components\\map\\MapControlPanel.tsx","data-component-name":"Card","data-component-line":"42","data-component-file":"MapControlPanel.tsx","data-component-content":"%7B%22className%22%3A%22relative%20w-full%20bg-white%2F95%20backdrop-blur-sm%20shadow-lg%20rounded-xl%20p-4%20sm%3Ap-6%20border-blue-100%2F50%20hover%3Ashadow-xl%20transition-all%20duration-300%22%7D",className:"relative w-full bg-white/95 backdrop-blur-sm shadow-lg rounded-xl p-4 sm:p-6 border-blue-100/50 hover:shadow-xl transition-all duration-300",children:[_&&x.jsx(Fn.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-white/50 backdrop-blur-sm flex items-center justify-center z-50 rounded-xl",children:x.jsx(Fo,{"data-component-path":"src\\components\\map\\MapControlPanel.tsx","data-component-name":"Loader2","data-component-line":"50","data-component-file":"MapControlPanel.tsx","data-component-content":"%7B%22className%22%3A%22w-6%20h-6%20animate-spin%20text-primary%22%7D",className:"w-6 h-6 animate-spin text-primary"})}),x.jsx(ys,{"data-component-path":"src\\components\\map\\MapControlPanel.tsx","data-component-name":"MapControls","data-component-line":"53","data-component-file":"MapControlPanel.tsx","data-component-content":"%7B%7D",selectingPickup:a,selectingDrop:s,onPickupClick:()=>{r(!0),c(!1),yo("pickup",{lat:0,lng:0}),b({title:"Seleccionando punto de recogida",description:"Haz clic en el mapa para seleccionar el punto de recogida"})},onDropClick:()=>{c(!0),r(!1),yo("drop",{lat:0,lng:0}),b({title:"Seleccionando punto de entrega",description:"Haz clic en el mapa para seleccionar el punto de entrega"})}})]})}),x.jsx(jr,{"data-component-path":"src\\components\\map\\MapControlPanel.tsx","data-component-name":"AnimatePresence","data-component-line":"80","data-component-file":"MapControlPanel.tsx","data-component-content":"%7B%7D",children:(u||f)&&x.jsx(Fn.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"w-full",children:x.jsx(rl,{"data-component-path":"src\\components\\map\\MapControlPanel.tsx","data-component-name":"RouteStreetInfo","data-component-line":"88","data-component-file":"MapControlPanel.tsx","data-component-content":"%7B%7D",pickupLocation:u,dropLocation:f,pickupAddress:m,dropAddress:v,isLoading:_})})})]})},ll=[{name:"Monterrey - Nuevo Laredo",lat:25.8941,lng:-100.1824,cost:418,description:"Cuota principal hacia Nuevo Laredo",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active",route:"Monterrey - Nuevo Laredo",distance:123.1},{name:"Agualeguas",lat:26.3167,lng:-99.5333,cost:171,description:"Caseta Agualeguas",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active",kilometer:"79+600",route:"Monterrey - Agualeguas",distance:56.9},{name:"Monterrey - La Gloria",lat:25.7833,lng:-100.5667,cost:418,description:"Peaje entre Monterrey y La Gloria",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active",kilometer:"100+000",route:"Monterrey - La Gloria",distance:45.8},{name:"Monterrey - Sabinas",lat:25.4506,lng:-100.9447,cost:231,description:"Peaje entre Monterrey y Sabinas",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active",kilometer:"99+300",route:"Monterrey - Sabinas",distance:77.3},{name:"Sabinas - La Gloria",lat:25.7833,lng:-100.5667,cost:188,description:"Peaje entre Sabinas y La Gloria",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active",kilometer:"100+000",route:"Sabinas - La Gloria",distance:45.8},{name:"Agualeguas - Sabinas",lat:26.3167,lng:-99.5333,cost:60,description:"Peaje entre Agualeguas y Sabinas",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active",kilometer:"79+600",route:"Agualeguas - Sabinas",distance:60},{name:"Detalle por ruta: Monterrey - Saltillo y Libramiento Norponiente de Saltillo",lat:25.4506,lng:-100.9447,cost:492,description:"Coste total del peaje por la ruta mencionada",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active"},{name:"Zacatecas - Monclova",lat:23.9999,lng:-102,cost:133,description:"Peaje entre Zacatecas y Monclova",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active"},{name:"Monclova - Ojo Caliente 1",lat:25.8667,lng:-100.7833,cost:57,description:"Peaje entre Monclova y Ojo Caliente 1",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active"},{name:"Monclova - Ojo Caliente 2",lat:25.8667,lng:-100.7833,cost:102,description:"Peaje entre Monclova y Ojo Caliente 2",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active"},{name:"Ojo Caliente 2 - Morones Prieto",lat:25.8667,lng:-100.7833,cost:257,description:"Peaje entre Ojo Caliente 2 y Morones Prieto",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active"},{name:"El Jónuco - Periférico",lat:25.8667,lng:-100.7833,cost:32,description:"Peaje entre El Jónuco y Periférico",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active"},{name:"El Jónuco - Morones Prieto",lat:25.8667,lng:-100.7833,cost:88,description:"Peaje entre El Jónuco y Morones Prieto",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active"},{name:"Zacatecas - Torreón",lat:25.8667,lng:-100.7833,cost:91,description:"Peaje entre Zacatecas y Torreón",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active"},{name:"Torreón - Monclova",lat:25.8667,lng:-100.7833,cost:42,description:"Peaje entre Torreón y Monclova",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active"},{name:"Ojo Caliente 1 - Ojo Caliente 2",lat:25.8667,lng:-100.7833,cost:45,description:"Peaje entre Ojo Caliente 1 y Ojo Caliente 2",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active"},{name:"Ojo Caliente 2 - Periférico",lat:25.8667,lng:-100.7833,cost:155,description:"Peaje entre Ojo Caliente 2 y Periférico",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active"},{name:"Periférico - Morones Prieto",lat:25.8667,lng:-100.7833,cost:102,description:"Peaje entre Periférico y Morones Prieto",type:"highway",operatingHours:"24/7",acceptedPayments:["cash","card","tag"],vehicleTypes:["car","truck","motorcycle"],lastUpdated:"2024-03-20",status:"active"}],Xe=(a,s)=>{const c=(s.lat-a.lat)*Math.PI/180,u=(s.lng-a.lng)*Math.PI/180,f=Math.sin(c/2)*Math.sin(c/2)+Math.cos(a.lat*Math.PI/180)*Math.cos(s.lat*Math.PI/180)*Math.sin(u/2)*Math.sin(u/2);return 6371*(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)))},Oo=.5,ma=.1,cl=async(a,s)=>{try{const r=await hl(a,s),c=ul(r),u=Do(a,s,c,"outbound"),f=Do(s,Me,c,"return"),m=pl([...u,...f]),v=ml(m);return{tolls:m,totalTollCost:v,routeDetails:r}}catch(r){return console.warn("Error detecting tolls:",r),{tolls:[],totalTollCost:0,routeDetails:null}}},hl=async(a,s)=>{await le(Me,a);const r=await le(a,s),c=await le(s,Me);return{outbound:r,return:c}},ul=a=>{var r,c;const s=[];return(r=a.outbound)!=null&&r.geometry&&s.push(...ko(a.outbound.geometry)),(c=a.return)!=null&&c.geometry&&s.push(...ko(a.return.geometry)),s},Do=(a,s,r,c)=>ll.filter(u=>{const f=Xe(a,u)<=Oo,m=Xe(s,u)<=Oo,v=r.some(b=>Xe({lat:b[0],lng:b[1]},u)<=ma),_=dl(a,s,u);return(f||m||v)&&_}).map(u=>({...u,direction:c,cost:fl(u.cost,c)})),dl=(a,s,r)=>{const c=Math.atan2(s.lat-a.lat,s.lng-a.lng),u=Math.atan2(r.lat-a.lat,r.lng-a.lng);return Math.abs(c-u)<=Math.PI/4},fl=(a,s)=>s==="return"?a*.9:a,pl=a=>a.filter((s,r,c)=>r===c.findIndex(u=>Xe(s,u)<ma)),ml=a=>a.reduce((s,r)=>s+r.cost,0),ko=(a,s=5)=>{let r=0,c=0,u=0,f=[];const m=Math.pow(10,s);for(;r<a.length;){let v=0,_=0,b;do b=a.charCodeAt(r++)-63,v|=(b&31)<<_,_+=5;while(b>=32);const I=v&1?~(v>>1):v>>1;v=0,_=0;do b=a.charCodeAt(r++)-63,v|=(b&31)<<_,_+=5;while(b>=32);const E=v&1?~(v>>1):v>>1;c+=I,u+=E,f.push([c/m,u/m])}return f},Ao=3,Io=1e3,vl=()=>{const[a,s]=T.useState(null),[r,c]=T.useState(null),[u,f]=T.useState(""),[m,v]=T.useState(""),[_,b]=T.useState(!1),[I,E]=T.useState(!1),[Z,B]=T.useState(!1);T.useRef(null);const{toast:O}=Xt(),{updateTollInfo:A,updateLocationInfo:G}=Ro(),X=T.useCallback(async(w,P=0)=>{try{return await w()}catch(N){if(P<Ao)return O({title:"Reintentando...",description:`Intento ${P+1} de ${Ao}`,duration:Io}),await new Promise(Y=>setTimeout(Y,Io)),X(w,P+1);throw N}},[O]);T.useEffect(()=>{(async()=>{if(a&&r)try{B(!0);const P=await X(async()=>await cl(a,r));A(P.tolls,P.totalTollCost),P.tolls.length>0?O({title:"Peajes Detectados",description:`Se detectaron ${P.tolls.length} peajes en la ruta con un costo total de $${P.totalTollCost.toFixed(2)}`,duration:5e3}):O({title:"Sin Peajes",description:"No se detectaron peajes en la ruta seleccionada",duration:3e3})}catch(P){console.error("Error detecting tolls:",P),O({title:"Error al Detectar Peajes",description:"No se pudieron detectar los peajes en la ruta. Por favor, intente nuevamente.",variant:"destructive",duration:5e3})}finally{B(!1)}})()},[a,r,O,A,X]),T.useEffect(()=>{(async()=>{if(a)try{B(!0);const P=await X(async()=>await $e(a.lat,a.lng));f(P),G({pickup:{...a,address:P}})}catch(P){console.error("Error getting pickup address:",P),O({title:"Error de Dirección",description:"No se pudo obtener la dirección de recogida",variant:"destructive",duration:3e3})}finally{B(!1)}})()},[a,O,G,X]),T.useEffect(()=>{(async()=>{if(r)try{B(!0);const P=await X(async()=>await $e(r.lat,r.lng));v(P),G({drop:{...r,address:P}})}catch(P){console.error("Error getting drop address:",P),O({title:"Error de Dirección",description:"No se pudo obtener la dirección de entrega",variant:"destructive",duration:3e3})}finally{B(!1)}})()},[r,O,G,X]);const C=T.useCallback(async w=>{try{_?(s(w),b(!1)):I&&(c(w),E(!1))}catch(P){console.error("Error handling location selection:",P),O({title:"Error de Ubicación",description:"No se pudo procesar la ubicación seleccionada",variant:"destructive",duration:5e3})}finally{B(!1)}},[_,I,O]);return x.jsxs("div",{"data-component-path":"src\\components\\TowMap.tsx","data-component-name":"div","data-component-line":"182","data-component-file":"TowMap.tsx","data-component-content":"%7B%22className%22%3A%22relative%20h-screen%20w-full%22%7D",className:"relative h-screen w-full",children:[x.jsx("div",{"data-component-path":"src\\components\\TowMap.tsx","data-component-name":"div","data-component-line":"183","data-component-file":"TowMap.tsx","data-component-content":"%7B%22className%22%3A%22absolute%20inset-0%20z-0%22%7D",className:"absolute inset-0 z-0",children:x.jsx(oa,{"data-component-path":"src\\components\\TowMap.tsx","data-component-name":"MapContainerComponent","data-component-line":"184","data-component-file":"TowMap.tsx","data-component-content":"%7B%7D",pickupLocation:a,dropLocation:r,selectingPickup:_,selectingDrop:I,onLocationSelect:C,setPickupLocation:s,setDropLocation:c,onRouteCalculated:w=>Wo(w),isLoading:Z})}),x.jsx("div",{"data-component-path":"src\\components\\TowMap.tsx","data-component-name":"div","data-component-line":"197","data-component-file":"TowMap.tsx","data-component-content":"%7B%22className%22%3A%22absolute%20inset-x-0%20top-24%20z-50%20pointer-events-none%22%7D",className:"absolute inset-x-0 top-24 z-50 pointer-events-none",children:x.jsx("div",{"data-component-path":"src\\components\\TowMap.tsx","data-component-name":"div","data-component-line":"198","data-component-file":"TowMap.tsx","data-component-content":"%7B%22className%22%3A%22container%20mx-auto%20px-4%22%7D",className:"container mx-auto px-4",children:x.jsx(sl,{"data-component-path":"src\\components\\TowMap.tsx","data-component-name":"MapControlPanel","data-component-line":"199","data-component-file":"TowMap.tsx","data-component-content":"%7B%7D",selectingPickup:_,selectingDrop:I,setSelectingPickup:b,setSelectingDrop:E,pickupLocation:a,dropLocation:r,pickupAddress:u,dropAddress:m,isLoading:Z})})}),x.jsx("p",{"data-component-path":"src\\components\\TowMap.tsx","data-component-name":"p","data-component-line":"213","data-component-file":"TowMap.tsx","data-component-content":"%7B%22text%22%3A%22Mapa%20interactivo%20para%20seleccionar%20ubicaciones%20de%20recogida%20y%20entrega%20del%5Cn%20%20%20%20%20%20%20%20servicio%20de%20gr%C3%BAa%22%2C%22className%22%3A%22sr-only%22%7D",className:"sr-only",children:"Mapa interactivo para seleccionar ubicaciones de recogida y entrega del servicio de grúa"})]})};export{vl as default};



// C:\Users\israe\Documents\GitHub\recentmap\netlify\functions\hello-world\hello-world.js
// Docs on event and context https://docs.netlify.com/functions/build/#code-your-function-2
const handler = async (event) => {
  try {
    const subject = event.queryStringParameters.name || 'World'
    return {
      statusCode: 200,
      body: JSON.stringify({ message: `Hello ${subject}` }),
      // // more keys you can return:
      // headers: { "headerName": "headerValue", ... },
      // isBase64Encoded: true,
    }
  } catch (error) {
    return { statusCode: 500, body: error.toString() }
  }
}

module.exports = { handler }



// C:\Users\israe\Documents\GitHub\recentmap\netlify\functions\stripe-webhook\stripe-webhook.js
const express = require('express')
const Stripe = require('stripe')

const router = express.Router()
const stripe = new Stripe(process.env.STRIPE_SECRET_KEY, {
  apiVersion: '2023-08-16',
})

router.post('/', async (req, res) => {
  let event

  try {
    event = stripe.webhooks.constructEvent(
      req.body,
      req.headers['stripe-signature'],
      process.env.STRIPE_WEBHOOK_SECRET,
    )
  } catch (err) {
    console.error('Webhook signature verification failed.', err)
    return res.sendStatus(400)
  }

  try {
    switch (event.type) {
      case 'payment_intent.succeeded':
        // Manejar payment_intent.succeeded
        console.log('Payment Intent Succeeded:', event.data.object)
        break
      case 'payment_method.attached':
        // Manejar payment_method.attached
        console.log('Payment Method Attached:', event.data.object)
        break
      // Agregar otros tipos de eventos según sea necesario
      default:
        console.log(`Unhandled event type ${event.type}`)
    }
  } catch (err) {
    console.error('Webhook handler failed.', err)
  }

  res.sendStatus(200)
})

module.exports = router



// C:\Users\israe\Documents\GitHub\recentmap\src\App.tsx
import { QueryClient, QueryClientProvider } from '@tanstack/react-query'
import { StripeProvider } from './providers/StripeProvider'
import { TowingProvider } from './contexts/TowingContext'
import { SidebarProvider } from './contexts/SidebarContext'
import { RouterProvider } from 'react-router-dom'
import { router } from './routes'
import { Toaster } from '@/components/ui/toaster'

const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 5 * 60 * 1000,
      retry: 1,
    },
  },
});

function App() {
  return (
    <QueryClientProvider client={queryClient}>
      <TowingProvider>
        <StripeProvider>
          <SidebarProvider>
            <div className="min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900">
              <div className="absolute inset-0 bg-grid-pattern opacity-5" />
              <div className="relative z-10">
                <RouterProvider router={router} />
              </div>
              <Toaster />
            </div>
          </SidebarProvider>
        </StripeProvider>
      </TowingProvider>
    </QueryClientProvider>
  )
}

export default App



// C:\Users\israe\Documents\GitHub\recentmap\src\main.tsx
import { createRoot } from 'react-dom/client'
import { StrictMode } from 'react'
import App from './App'
import './index.css'

const container = document.getElementById('root')
const root = createRoot(container!)

root.render(
  <StrictMode>
    <App />
  </StrictMode>,
)



// C:\Users\israe\Documents\GitHub\recentmap\src\vite-env.d.ts
/// <reference types="vite/client" />



// C:\Users\israe\Documents\GitHub\recentmap\src\components\CostEstimation.tsx
import { useState, useCallback } from 'react'
import { motion, AnimatePresence } from 'framer-motion'
import { useTowing } from '@/contexts/TowingContext'
import { towTruckTypes } from '@/utils/towTruckPricing'
import { CostHeader } from './cost/CostHeader'
import { CostMetrics } from './cost/CostMetrics'
import { CostBreakdown } from './cost/CostBreakdown'
import { useToast } from '@/hooks/use-toast'
import { TollLocation } from '@/data/tollData'
import { Button } from './ui/button'
import {
  Dialog,
  DialogContent,
  DialogTrigger,
  DialogTitle,
  DialogDescription,
} from './ui/dialog'
import { TermsAndConditions } from './legal/TermsAndConditions'
import { ScrollArea } from './ui/scroll-area'
import { Info, AlertTriangle } from 'lucide-react'

interface CostEstimationProps {
  onShowPayment: () => void
}

export const CostEstimation = ({ onShowPayment }: CostEstimationProps) => {
  const {
    totalDistance,
    detectedTolls,
    totalTollCost,
    truckType,
    requiresManeuver,
    updateManeuverRequired,
    selectedVehicleModel,
  } = useTowing()

  const [showBreakdown, setShowBreakdown] = useState(false)
  const [requiresInvoice, setRequiresInvoice] = useState(false)
  const { toast } = useToast()

  const selectedTruck = towTruckTypes[truckType || 'A']
  const baseCost = totalDistance * selectedTruck.perKm
  const flagDropFee = selectedTruck.flagDropFee
  const maneuverCost = requiresManeuver ? selectedTruck.maneuverCharge : 0
  const subtotal = baseCost + flagDropFee + maneuverCost + totalTollCost
  const tax = requiresInvoice ? subtotal * 0.16 : 0
  const finalCost = subtotal + tax

  console.log('Cost Calculation:', {
    baseCost,
    flagDropFee,
    maneuverCost,
    totalTollCost,
    subtotal,
    tax,
    finalCost,
    detectedTolls,
  })

  const handleBreakdownToggle = useCallback(
    (value: boolean) => {
      setShowBreakdown(value)
      if (value) {
        toast({
          title: 'Desglose de costos',
          description: 'Ahora puedes ver el detalle de los costos del servicio',
        })
      }
    },
    [toast],
  )

  const processedTolls = detectedTolls.map((toll: TollLocation) => ({
    ...toll,
    direction: toll.direction || 'outbound',
  }))

  const showHighCostWarning = finalCost > 5000

  return (
    <motion.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      className="space-y-4 w-full max-w-2xl mx-auto"
    >
      <div className="bg-gradient-to-br from-white/95 via-blue-50/30 to-white backdrop-blur-sm rounded-lg shadow-lg p-4 space-y-4 border border-blue-100/50 hover:shadow-xl transition-all duration-300">
        <div className="flex justify-between items-center">
          <Dialog>
            <DialogTrigger asChild>
              <Button
                variant="outline"
                size="sm"
                className="flex items-center gap-2 text-primary hover:text-primary/80"
              >
                <Info className="w-4 h-4" />
                Términos y Condiciones
              </Button>
            </DialogTrigger>
            <DialogContent className="max-w-4xl h-[80vh]">
              <DialogTitle>Términos y Condiciones del Servicio</DialogTitle>
              <DialogDescription>
                Por favor, lea cuidadosamente los términos y condiciones antes
                de proceder.
              </DialogDescription>
              <ScrollArea className="h-full pr-4">
                <TermsAndConditions />
              </ScrollArea>
            </DialogContent>
          </Dialog>
        </div>

        {showHighCostWarning && (
          <motion.div
            initial={{ opacity: 0, x: -20 }}
            animate={{ opacity: 1, x: 0 }}
            className="bg-yellow-50 border border-yellow-200 rounded-lg p-3 flex items-center gap-2 text-yellow-800"
          >
            <AlertTriangle className="w-5 h-5 text-yellow-600" />
            <span className="text-sm">
              Este servicio tiene un costo elevado. Considere verificar los
              detalles.
            </span>
          </motion.div>
        )}

        <CostHeader
          showBreakdown={showBreakdown}
          setShowBreakdown={handleBreakdownToggle}
          finalCost={finalCost}
          truckType={truckType}
          selectedTruck={selectedTruck}
        />

        <AnimatePresence>
          {showBreakdown && (
            <motion.div
              initial={{ opacity: 0, height: 0 }}
              animate={{ opacity: 1, height: 'auto' }}
              exit={{ opacity: 0, height: 0 }}
              className="space-y-4"
            >
              <CostMetrics
                totalDistance={totalDistance}
                requiresInvoice={requiresInvoice}
                setRequiresInvoice={setRequiresInvoice}
                requiresManeuver={requiresManeuver}
                onManeuverChange={updateManeuverRequired}
                selectedTruck={selectedTruck}
              />

              <CostBreakdown
                baseCost={baseCost}
                flagDropFee={flagDropFee}
                tax={tax}
                totalDistance={totalDistance}
                totalTollCost={totalTollCost}
                finalCost={finalCost}
                detectedTolls={processedTolls}
                requiresInvoice={requiresInvoice}
                setShowPaymentWindow={onShowPayment}
                maneuverCost={maneuverCost}
                requiresManeuver={requiresManeuver}
                selectedTruck={selectedTruck}
                subtotal={subtotal}
                selectedVehicleModel={selectedVehicleModel}
              />
            </motion.div>
          )}
        </AnimatePresence>
      </div>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\FloatingQuestionsPanel.tsx
import { useState } from 'react'
import { FloatingPanel } from './map/FloatingPanel'
import { Button } from './ui/button'
import { ChevronLeft, ChevronRight } from 'lucide-react'
import { VehicleForm } from './VehicleForm'
import { CostEstimation } from './CostEstimation'
import { RouteDisplay } from './map/RouteDisplay'
import { motion, AnimatePresence } from 'framer-motion'
import { useTowing } from '@/contexts/TowingContext'
import PaymentWindow from './payment/PaymentWindow'
import { ScrollArea } from './ui/scroll-area'

interface QuestionPage {
  id: number
  title: string
  component: React.ReactNode
}

interface LocationData {
  lat: number
  lng: number
}

interface FloatingQuestionsPanelProps {
  pickupLocation: LocationData | null
  dropLocation: LocationData | null
  pickupAddress: string
  dropAddress: string
  onPickupSelect: (location: {
    lat: number
    lng: number
    address: string
  }) => void
  onDropSelect: (location: {
    lat: number
    lng: number
    address: string
  }) => void
  onSelectingPickup: () => void
  onSelectingDrop: () => void
  className?: string
}

export const FloatingQuestionsPanel = ({
  pickupLocation,
  dropLocation,
  pickupAddress,
  dropAddress,
  onPickupSelect,
  onDropSelect,
  onSelectingPickup,
  onSelectingDrop,
  className,
}: FloatingQuestionsPanelProps) => {
  const [currentPage, setCurrentPage] = useState(0)
  const [showPaymentWindow, setShowPaymentWindow] = useState(false)
  const { totalDistance, truckType, requiresManeuver, totalTollCost } =
    useTowing()

  const handlePaymentSubmit = async (result: {
    success: boolean
    error?: string
  }) => {
    if (result.success) {
      setShowPaymentWindow(false)
    }
  }

  const pages: QuestionPage[] = [
    {
      id: 1,
      title: 'Detalles del Servicio',
      component: (
        <VehicleForm
          pickupLocation={pickupLocation}
          dropLocation={dropLocation}
          pickupAddress={pickupAddress}
          dropAddress={dropAddress}
          onPickupSelect={onPickupSelect}
          onDropSelect={onDropSelect}
          onSelectingPickup={onSelectingPickup}
          onSelectingDrop={onSelectingDrop}
        />
      ),
    },
    {
      id: 2,
      title: 'Costos y Ruta',
      component: (
        <div className="space-y-6">
          <CostEstimation onShowPayment={() => setShowPaymentWindow(true)} />
          <RouteDisplay
            pickupLocation={pickupLocation}
            dropLocation={dropLocation}
          />
        </div>
      ),
    },
  ]

  const handlePageChange = (direction: 'next' | 'prev') => {
    setCurrentPage((prev) =>
      direction === 'next'
        ? Math.min(pages.length - 1, prev + 1)
        : Math.max(0, prev - 1),
    )
  }

  return (
    <>
      <FloatingPanel
        title={pages[currentPage].title}
        position="right"
        className={`w-full max-w-md mx-auto bg-white/95 backdrop-blur-sm shadow-lg ${className}`}
      >
        <ScrollArea className="h-[calc(100vh-12rem)]">
          <div className="space-y-6 p-6">
            <AnimatePresence mode="wait">
              <motion.div
                key={currentPage}
                initial={{ opacity: 0, x: 20 }}
                animate={{ opacity: 1, x: 0 }}
                exit={{ opacity: 0, x: -20 }}
                transition={{ duration: 0.3 }}
                className="min-h-[50vh]"
              >
                {pages[currentPage].component}
              </motion.div>
            </AnimatePresence>

            <motion.div
              className="flex justify-between mt-4 pt-4 border-t border-gray-200"
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              transition={{ delay: 0.2 }}
            >
              <Button
                variant="outline"
                onClick={() => handlePageChange('prev')}
                disabled={currentPage === 0}
                className="w-24 bg-white/80 hover:bg-white/95 transition-all"
              >
                <ChevronLeft className="w-4 h-4 mr-2" />
                Anterior
              </Button>
              <Button
                variant="outline"
                onClick={() => handlePageChange('next')}
                disabled={currentPage === pages.length - 1}
                className="w-24 bg-white/80 hover:bg-white/95 transition-all"
              >
                Siguiente
                <ChevronRight className="w-4 h-4 ml-2" />
              </Button>
            </motion.div>
          </div>
        </ScrollArea>
      </FloatingPanel>

      <PaymentWindow
        isOpen={showPaymentWindow}
        onClose={() => setShowPaymentWindow(false)}
        amount={totalDistance * (truckType === 'D' ? 32.35 : 18.82)}
        onPaymentSubmit={handlePaymentSubmit}
      />
    </>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\index.ts
export { UserDashboard } from '@/components/user/UserDashboard'
export { UserNavigationMenu } from '@/components/user/UserNavigationMenu'
export { UserNotifications } from '@/components/user/UserNotifications'
export { UserReservations } from '@/components/user/UserReservations'
export { UserSettings } from '@/components/user/UserSettings'



// C:\Users\israe\Documents\GitHub\recentmap\src\components\Sidebar.tsx
import { useState } from 'react'
import { Menu, ChevronLeft, ChevronRight } from 'lucide-react'
import { cn } from '@/lib/utils'
import { Button } from '@/components/ui/button'
import { Sheet, SheetContent, SheetTrigger } from '@/components/ui/sheet'
import { VehicleForm } from './VehicleForm'
import { RouteDisplay } from './map/RouteDisplay'
import { CostEstimation } from './CostEstimation'
import { useSidebar } from '@/contexts/SidebarContext'
import { ScrollArea } from '@/components/ui/scroll-area'

const NavContent = ({
  pickupLocation,
  dropLocation,
  pickupAddress,
  dropAddress,
  onPickupSelect,
  onDropSelect,
  onSelectingPickup,
  onSelectingDrop,
}: {
  pickupLocation?: { lat: number; lng: number } | null
  dropLocation?: { lat: number; lng: number } | null
  pickupAddress?: string
  dropAddress?: string
  onPickupSelect: (location: {
    lat: number
    lng: number
    address: string
  }) => void
  onDropSelect: (location: {
    lat: number
    lng: number
    address: string
  }) => void
  onSelectingPickup: (selecting: boolean) => void
  onSelectingDrop: (selecting: boolean) => void
}) => (
  <>
    <div className="sticky top-0 z-10 p-4 border-b bg-gradient-to-r from-primary/10 to-primary/5 backdrop-blur-sm">
      <h1 className="text-xl md:text-2xl lg:text-3xl font-heading font-bold text-primary text-center">
        MRGruas
      </h1>
    </div>

    <ScrollArea className="h-[calc(100vh-4rem)] p-4 md:p-6">
      <div className="space-y-4 md:space-y-6 flex flex-col items-center pb-20">
        <VehicleForm
          pickupLocation={pickupLocation}
          dropLocation={dropLocation}
          pickupAddress={pickupAddress}
          dropAddress={dropAddress}
          serviceType="standard"
          onPickupSelect={onPickupSelect}
          onDropSelect={onDropSelect}
          onSelectingPickup={onSelectingPickup}
          onSelectingDrop={onSelectingDrop}
        />
        <CostEstimation />
        <RouteDisplay
          pickupLocation={pickupLocation}
          dropLocation={dropLocation}
        />
      </div>
    </ScrollArea>
  </>
)

const Sidebar = () => {
  const [isMobileOpen, setIsMobileOpen] = useState(false)
  const { isOpen: isDesktopSidebarVisible, toggle: toggleDesktopSidebar } =
    useSidebar()
  const [pickupLocation, setPickupLocation] = useState<{
    lat: number
    lng: number
  } | null>(null)
  const [dropLocation, setDropLocation] = useState<{
    lat: number
    lng: number
  } | null>(null)
  const [pickupAddress, setPickupAddress] = useState('')
  const [dropAddress, setDropAddress] = useState('')
  const [selectingPickup, setSelectingPickup] = useState(false)
  const [selectingDrop, setSelectingDrop] = useState(false)

  const handlePickupSelect = (location: {
    lat: number
    lng: number
    address: string
  }) => {
    setPickupLocation({ lat: location.lat, lng: location.lng })
    setPickupAddress(location.address)
    setSelectingPickup(false)
  }

  const handleDropSelect = (location: {
    lat: number
    lng: number
    address: string
  }) => {
    setDropLocation({ lat: location.lat, lng: location.lng })
    setDropAddress(location.address)
    setSelectingDrop(false)
  }

  return (
    <>
      <div className="lg:hidden fixed top-4 left-4 z-[1000]">
        <Sheet open={isMobileOpen} onOpenChange={setIsMobileOpen}>
          <SheetTrigger asChild>
            <Button
              variant="outline"
              size="icon"
              className="bg-white/95 backdrop-blur-sm shadow-lg hover:shadow-xl transition-all"
            >
              <Menu className="h-4 w-4" />
            </Button>
          </SheetTrigger>
          <SheetContent side="left" className="w-full sm:w-[400px] p-0">
            <NavContent
              pickupLocation={pickupLocation}
              dropLocation={dropLocation}
              pickupAddress={pickupAddress}
              dropAddress={dropAddress}
              onPickupSelect={handlePickupSelect}
              onDropSelect={handleDropSelect}
              onSelectingPickup={setSelectingPickup}
              onSelectingDrop={setSelectingDrop}
            />
          </SheetContent>
        </Sheet>
      </div>

      <Button
        variant="outline"
        size="icon"
        onClick={toggleDesktopSidebar}
        className={cn(
          'fixed bottom-4 left-4 z-[1000] hidden lg:flex',
          'bg-white/95 backdrop-blur-sm shadow-lg hover:shadow-xl transition-all',
        )}
      >
        {isDesktopSidebarVisible ? (
          <ChevronLeft className="h-4 w-4" />
        ) : (
          <ChevronRight className="h-4 w-4" />
        )}
      </Button>

      <aside
        className={cn(
          'hidden lg:flex flex-col fixed left-0 top-0 h-screen',
          'bg-white/95 backdrop-blur-sm border-r shadow-lg z-[1000]',
          'transition-all duration-300 ease-in-out',
          isDesktopSidebarVisible ? 'w-[400px]' : 'w-0 overflow-hidden',
        )}
      >
        <NavContent
          pickupLocation={pickupLocation}
          dropLocation={dropLocation}
          pickupAddress={pickupAddress}
          dropAddress={dropAddress}
          onPickupSelect={handlePickupSelect}
          onDropSelect={handleDropSelect}
          onSelectingPickup={setSelectingPickup}
          onSelectingDrop={setSelectingDrop}
        />
      </aside>

      <div
        className={cn(
          'transition-all duration-300 ease-in-out',
          isDesktopSidebarVisible ? 'lg:pl-[400px]' : 'lg:pl-0',
        )}
      />
    </>
  )
}

export default Sidebar



// C:\Users\israe\Documents\GitHub\recentmap\src\components\TollInfoDisplay.tsx
import { Card } from '@/components/ui/card'
import { Ticket, Clock, CreditCard } from 'lucide-react'
import { TollLocation } from '@/data/tollData'
import { Separator } from '@/components/ui/separator'

interface TollInfoDisplayProps {
  tolls: TollLocation[]
  totalCost: number
}

export const TollInfoDisplay = ({ tolls, totalCost }: TollInfoDisplayProps) => {
  if (tolls.length === 0) return null

  return (
    <Card className="p-3 md:p-4 bg-yellow-50/80 border border-yellow-200 space-y-3">
      <div className="flex items-center justify-between">
        <div className="flex items-center gap-2">
          <Ticket className="w-4 h-4 text-yellow-700" />
          <h3 className="text-sm md:text-base lg:text-lg font-semibold text-yellow-700">
            Peajes en la Ruta
          </h3>
        </div>
        <div className="text-xs md:text-sm font-semibold text-yellow-700 bg-yellow-100 px-2 md:px-3 py-1 rounded-full">
          Total: ${totalCost.toFixed(2)}
        </div>
      </div>

      <Separator className="bg-yellow-200/50" />

      <div className="space-y-2">
        {tolls.map((toll, index) => (
          <div
            key={index}
            className="bg-white/50 rounded-lg p-2 md:p-3 space-y-2 hover:bg-white/70 transition-colors"
          >
            <div className="flex justify-between items-center">
              <span className="text-xs md:text-sm font-medium text-yellow-800">
                {toll.name}
              </span>
              <span className="text-xs md:text-sm font-semibold text-yellow-700 bg-yellow-100 px-2 py-0.5 rounded-full">
                ${toll.cost.toFixed(2)}
              </span>
            </div>
            <div className="flex items-center gap-3 md:gap-4 text-[10px] md:text-xs text-gray-600">
              <div className="flex items-center gap-1">
                <Clock className="w-3 h-3" />
                <span>{toll.operatingHours}</span>
              </div>
              <div className="flex items-center gap-1">
                <CreditCard className="w-3 h-3" />
                <span>{toll.acceptedPayments.join(', ')}</span>
              </div>
            </div>
          </div>
        ))}
      </div>
    </Card>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\TowingWrapper.tsx
import { ReactNode } from 'react'
import { TowingProvider } from '../contexts/TowingContext'

interface TowingWrapperProps {
  children: ReactNode
}

export const TowingWrapper = ({ children }: TowingWrapperProps) => {
  return <TowingProvider>{children}</TowingProvider>
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\TowMap.tsx
import { useRef, useState, useEffect, useCallback } from 'react';
import { Map } from 'leaflet';
import 'leaflet/dist/leaflet.css';
import { showRouteNotification } from '@/utils/notificationUtils';
import { MapContainerComponent } from './map/MapContainer';
import { MapControlPanel } from './map/MapControlPanel';
import { useToast } from '@/hooks/use-toast';
import { detectTollsOnRoute } from '@/utils/tollCalculator';
import { useTowing } from '@/contexts/TowingContext';
import { getAddressFromCoordinates } from '@/services/geocodingService';

const MAX_RETRIES = 3;
const RETRY_DELAY = 1000;

const TowMap = () => {
  const [pickupLocation, setPickupLocation] = useState<{ lat: number; lng: number } | null>(null);
  const [dropLocation, setDropLocation] = useState<{ lat: number; lng: number } | null>(null);
  const [pickupAddress, setPickupAddress] = useState('');
  const [dropAddress, setDropAddress] = useState('');
  const [selectingPickup, setSelectingPickup] = useState(false);
  const [selectingDrop, setSelectingDrop] = useState(false);
  const [isLoading, setIsLoading] = useState(false);

  const mapRef = useRef<Map | null>(null);
  const { toast } = useToast();
  const { updateTollInfo, updateLocationInfo } = useTowing();

  const retryWithDelay = useCallback(
    async (fn: () => Promise<any>, attempt: number = 0): Promise<any> => {
      try {
        return await fn();
      } catch (error) {
        if (attempt < MAX_RETRIES) {
          toast({
            title: 'Reintentando...',
            description: `Intento ${attempt + 1} de ${MAX_RETRIES}`,
            duration: RETRY_DELAY,
          });
          await new Promise((resolve) => setTimeout(resolve, RETRY_DELAY));
          return retryWithDelay(fn, attempt + 1);
        }
        throw error;
      }
    },
    [toast],
  );

  useEffect(() => {
    const updateTolls = async () => {
      if (pickupLocation && dropLocation) {
        try {
          setIsLoading(true);
          const tollInfo = await retryWithDelay(async () => {
            return await detectTollsOnRoute(pickupLocation, dropLocation);
          });

          updateTollInfo(tollInfo.tolls, tollInfo.totalTollCost);

          if (tollInfo.tolls.length > 0) {
            toast({
              title: 'Peajes Detectados',
              description: `Se detectaron ${tollInfo.tolls.length} peajes en la ruta con un costo total de $${tollInfo.totalTollCost.toFixed(2)}`,
              duration: 5000,
            });
          } else {
            toast({
              title: 'Sin Peajes',
              description: 'No se detectaron peajes en la ruta seleccionada',
              duration: 3000,
            });
          }
        } catch (error) {
          console.error('Error detecting tolls:', error);
          toast({
            title: 'Error al Detectar Peajes',
            description: 'No se pudieron detectar los peajes en la ruta. Por favor, intente nuevamente.',
            variant: 'destructive',
            duration: 5000,
          });
        } finally {
          setIsLoading(false);
        }
      }
    };

    updateTolls();
  }, [pickupLocation, dropLocation, toast, updateTollInfo, retryWithDelay]);

  // New useEffect hooks for address synchronization
  useEffect(() => {
    const updatePickupAddress = async () => {
      if (pickupLocation) {
        try {
          setIsLoading(true);
          const address = await retryWithDelay(async () => {
            return await getAddressFromCoordinates(pickupLocation.lat, pickupLocation.lng);
          });

          setPickupAddress(address);
          updateLocationInfo({ pickup: { ...pickupLocation, address } });
        } catch (error) {
          console.error('Error getting pickup address:', error);
          toast({
            title: 'Error de Dirección',
            description: 'No se pudo obtener la dirección de recogida',
            variant: 'destructive',
            duration: 3000,
          });
        } finally {
          setIsLoading(false);
        }
      }
    };

    updatePickupAddress();
  }, [pickupLocation, toast, updateLocationInfo, retryWithDelay]);

  useEffect(() => {
    const updateDropAddress = async () => {
      if (dropLocation) {
        try {
          setIsLoading(true);
          const address = await retryWithDelay(async () => {
            return await getAddressFromCoordinates(dropLocation.lat, dropLocation.lng);
          });

          setDropAddress(address);
          updateLocationInfo({ drop: { ...dropLocation, address } });
        } catch (error) {
          console.error('Error getting drop address:', error);
          toast({
            title: 'Error de Dirección',
            description: 'No se pudo obtener la dirección de entrega',
            variant: 'destructive',
            duration: 3000,
          });
        } finally {
          setIsLoading(false);
        }
      }
    };

    updateDropAddress();
  }, [dropLocation, toast, updateLocationInfo, retryWithDelay]);

  const handleLocationSelect = useCallback(
    async (location: { lat: number; lng: number }) => {
      try {
        if (selectingPickup) {
          setPickupLocation(location);
          setSelectingPickup(false);
        } else if (selectingDrop) {
          setDropLocation(location);
          setSelectingDrop(false);
        }
      } catch (error) {
        console.error('Error handling location selection:', error);
        toast({
          title: 'Error de Ubicación',
          description: 'No se pudo procesar la ubicación seleccionada',
          variant: 'destructive',
          duration: 5000,
        });
      } finally {
        setIsLoading(false);
      }
    },
    [selectingPickup, selectingDrop, toast],
  );

  return (
    <div className="relative h-screen w-full">
      <div className="absolute inset-0 z-0">
        <MapContainerComponent
          pickupLocation={pickupLocation}
          dropLocation={dropLocation}
          selectingPickup={selectingPickup}
          selectingDrop={selectingDrop}
          onLocationSelect={handleLocationSelect}
          setPickupLocation={setPickupLocation}
          setDropLocation={setDropLocation}
          onRouteCalculated={(distance) => showRouteNotification(distance)}
          isLoading={isLoading}
          mapRef={mapRef}
        />
      </div>

      <div className="absolute inset-x-0 top-24 z-50 pointer-events-none">
        <div className="container mx-auto px-4">
          <MapControlPanel
            selectingPickup={selectingPickup}
            selectingDrop={selectingDrop}
            setSelectingPickup={setSelectingPickup}
            setSelectingDrop={setSelectingDrop}
            pickupLocation={pickupLocation}
            dropLocation={dropLocation}
            pickupAddress={pickupAddress}
            dropAddress={dropAddress}
            isLoading={isLoading}
          />
        </div>
      </div>

      <p className="sr-only">
        Mapa interactivo para seleccionar ubicaciones de recogida y entrega del
        servicio de grúa
      </p>
    </div>
  );
};

export default TowMap;


// C:\Users\israe\Documents\GitHub\recentmap\src\components\UserPage.tsx
import { UserDashboard } from '@/components/user/UserDashboard'

const UserPage = () => {
  return <UserDashboard />
}

export default UserPage



// C:\Users\israe\Documents\GitHub\recentmap\src\components\VehicleForm.tsx
import { useForm } from 'react-hook-form'
import { zodResolver } from '@hookform/resolvers/zod'
import { Form } from '@/components/ui/form'
import { VehicleSelector } from './form/VehicleSelector'
import { TowTruckSelector } from './form/TowTruckSelector'
import { LocationSelector } from './form/LocationSelector'
import { UserInfoFields } from './form/UserInfoFields'
import { VehicleBasicFields } from './form/VehicleBasicFields'
import { ManeuverField } from './form/ManeuverField'
import { FormData, formSchema } from '@/types/form'
import { Card } from './ui/card'
import { useTowing } from '@/contexts/TowingContext'
import { useToast } from '@/hooks/use-toast'
import { useState } from 'react'
import { motion } from 'framer-motion'
import { VehicleFormCopyButton } from './form/VehicleFormCopyButton'

interface VehicleFormProps {
  pickupLocation?: { lat: number; lng: number } | null
  dropLocation?: { lat: number; lng: number } | null
  pickupAddress?: string
  dropAddress?: string
  serviceType?: string
  onPickupSelect?: (location: {
    lat: number
    lng: number
    address: string
  }) => void
  onDropSelect?: (location: {
    lat: number
    lng: number
    address: string
  }) => void
  onSelectingPickup?: (selecting: boolean) => void
  onSelectingDrop?: (selecting: boolean) => void
}

export const VehicleForm = ({
  pickupLocation,
  dropLocation,
  pickupAddress,
  dropAddress,
  serviceType = 'standard',
  onPickupSelect,
  onDropSelect,
  onSelectingPickup,
  onSelectingDrop,
}: VehicleFormProps) => {
  const { updateSelectedVehicleModel, updateTruckType } = useTowing()
  const { toast } = useToast()
  const [isPending, setIsPending] = useState(false)

  const form = useForm<FormData>({
    resolver: zodResolver(formSchema),
    defaultValues: {
      userName: '',
      phone: '',
      vehicleMake: '',
      vehicleModel: '',
      vehicleYear: '',
      vehicleColor: '',
      truckType: 'A',
      requiresManeuver: false,
      issueDescription: '',
    },
    mode: 'onChange',
  })

  const handleVehicleModelChange = (value: string) => {
    updateSelectedVehicleModel(value)
    toast({
      title: 'Modelo de Vehículo Actualizado',
      description: `Modelo seleccionado: ${value}`,
    })
  }

  const handleTruckTypeChange = (value: 'A' | 'B' | 'C' | 'D') => {
    form.setValue('truckType', value, { shouldDirty: true })
    updateTruckType(value)
    toast({
      title: 'Tipo de Grúa Actualizado',
      description: `Tipo de grúa seleccionado: ${value}`,
    })
  }

  const onSubmit = form.handleSubmit(async (data) => {
    setIsPending(true)
    try {
      toast({
        title: 'Formulario Enviado',
        description: 'Los detalles del vehículo y ubicación han sido guardados',
      })
    } finally {
      setIsPending(false)
    }
  })

  return (
    <Form {...form}>
      <form onSubmit={onSubmit} className="space-y-8 w-full">
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.5 }}
        >
          <Card className="p-6 bg-gradient-to-br from-white/95 to-blue-50/30 shadow-lg hover:shadow-xl transition-all duration-300">
            <LocationSelector
              form={form}
              pickupLocation={pickupLocation}
              dropLocation={dropLocation}
              pickupAddress={pickupAddress}
              dropAddress={dropAddress}
              onPickupSelect={onPickupSelect}
              onDropSelect={onDropSelect}
              onSelectingPickup={onSelectingPickup}
              onSelectingDrop={onSelectingDrop}
            />
          </Card>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.5, delay: 0.2 }}
        >
          <Card className="p-6 bg-gradient-to-br from-white/95 to-blue-50/30 shadow-lg hover:shadow-xl transition-all duration-300">
            <div className="space-y-6">
              <UserInfoFields form={form} />
              <VehicleBasicFields
                form={form}
                onVehicleModelChange={handleVehicleModelChange}
              />
              <ManeuverField form={form} />
            </div>
          </Card>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ duration: 0.5, delay: 0.4 }}
        >
          <Card className="p-6 bg-gradient-to-br from-white/95 to-blue-50/30 shadow-lg hover:shadow-xl transition-all duration-300">
            <TowTruckSelector
              form={form}
              selectedModel={form.watch('vehicleModel')}
              onTruckTypeChange={handleTruckTypeChange}
            />
          </Card>
        </motion.div>

        <VehicleFormCopyButton
          form={form}
          pickupAddress={pickupAddress}
          dropAddress={dropAddress}
          pickupLocation={pickupLocation}
          dropLocation={dropLocation}
          isPending={isPending}
        />
      </form>
    </Form>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\admin\AdminMetrics.tsx
import { Card } from '@/components/ui/card'
import { ServiceSummary } from '../analytics/ServiceSummary'

export const AdminMetrics = () => {
  return (
    <div className="space-y-6">
      <ServiceSummary />

      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
        <Card className="p-4">
          <h3 className="font-semibold text-gray-700">Average Response Time</h3>
          <p className="text-2xl font-bold text-primary">15 mins</p>
        </Card>

        <Card className="p-4">
          <h3 className="font-semibold text-gray-700">Customer Satisfaction</h3>
          <p className="text-2xl font-bold text-primary">4.8/5.0</p>
        </Card>

        <Card className="p-4">
          <h3 className="font-semibold text-gray-700">Active Drivers</h3>
          <p className="text-2xl font-bold text-primary">8</p>
        </Card>
      </div>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\admin\AdminNavigationMenu.tsx
import {
  NavigationMenu,
  NavigationMenuContent,
  NavigationMenuItem,
  NavigationMenuLink,
  NavigationMenuList,
  NavigationMenuTrigger,
} from '@/components/ui/navigation-menu'
import { ClipboardList, Users, BarChart3, Settings } from 'lucide-react'
import { useNavigate } from 'react-router-dom'

export const AdminNavigationMenu = () => {
  const navigate = useNavigate()

  return (
    <NavigationMenu>
      <NavigationMenuList className="space-x-2">
        <NavigationMenuItem>
          <NavigationMenuTrigger className="bg-white/80 hover:bg-white/95">
            <ClipboardList className="w-4 h-4 mr-2" />
            Reservas
          </NavigationMenuTrigger>
          <NavigationMenuContent>
            <div className="grid gap-3 p-4 w-[400px]">
              <NavigationMenuLink
                className="block select-none space-y-1 rounded-md p-3 leading-none no-underline outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground"
                onClick={() => navigate('/admin/reservations')}
              >
                <div className="text-sm font-medium leading-none">
                  Ver Reservas
                </div>
                <p className="line-clamp-2 text-sm leading-snug text-muted-foreground">
                  Gestiona todas las reservas activas y completadas
                </p>
              </NavigationMenuLink>
            </div>
          </NavigationMenuContent>
        </NavigationMenuItem>

        <NavigationMenuItem>
          <NavigationMenuTrigger className="bg-white/80 hover:bg-white/95">
            <Users className="w-4 h-4 mr-2" />
            Usuarios
          </NavigationMenuTrigger>
          <NavigationMenuContent>
            <div className="grid gap-3 p-4 w-[400px]">
              <NavigationMenuLink
                className="block select-none space-y-1 rounded-md p-3 leading-none no-underline outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground"
                onClick={() => navigate('/admin/users')}
              >
                <div className="text-sm font-medium leading-none">
                  Gestión de Usuarios
                </div>
                <p className="line-clamp-2 text-sm leading-snug text-muted-foreground">
                  Administra las cuentas de usuarios y permisos
                </p>
              </NavigationMenuLink>
            </div>
          </NavigationMenuContent>
        </NavigationMenuItem>

        <NavigationMenuItem>
          <NavigationMenuTrigger className="bg-white/80 hover:bg-white/95">
            <BarChart3 className="w-4 h-4 mr-2" />
            Reportes
          </NavigationMenuTrigger>
          <NavigationMenuContent>
            <div className="grid gap-3 p-4 w-[400px]">
              <NavigationMenuLink
                className="block select-none space-y-1 rounded-md p-3 leading-none no-underline outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground"
                onClick={() => navigate('/admin/reports')}
              >
                <div className="text-sm font-medium leading-none">
                  Métricas y Estadísticas
                </div>
                <p className="line-clamp-2 text-sm leading-snug text-muted-foreground">
                  Accede a reportes detallados del servicio
                </p>
              </NavigationMenuLink>
            </div>
          </NavigationMenuContent>
        </NavigationMenuItem>

        <NavigationMenuItem>
          <NavigationMenuTrigger className="bg-white/80 hover:bg-white/95">
            <Settings className="w-4 h-4 mr-2" />
            Configuración
          </NavigationMenuTrigger>
          <NavigationMenuContent>
            <div className="grid gap-3 p-4 w-[400px]">
              <NavigationMenuLink
                className="block select-none space-y-1 rounded-md p-3 leading-none no-underline outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground"
                onClick={() => navigate('/admin/settings')}
              >
                <div className="text-sm font-medium leading-none">
                  Ajustes del Sistema
                </div>
                <p className="line-clamp-2 text-sm leading-snug text-muted-foreground">
                  Configura precios y tipos de grúas
                </p>
              </NavigationMenuLink>
            </div>
          </NavigationMenuContent>
        </NavigationMenuItem>
      </NavigationMenuList>
    </NavigationMenu>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\admin\AdminPanel.tsx
import { Card } from '@/components/ui/card'
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'
import { ReservationManagement } from './ReservationManagement'
import { AdminMetrics } from './AdminMetrics'
import { useToast } from '@/hooks/use-toast'
import { motion, AnimatePresence } from 'framer-motion'
import { Search, RefreshCw, Settings, Users } from 'lucide-react'
import { Input } from '@/components/ui/input'
import { Button } from '@/components/ui/button'
import { useState, useEffect } from 'react'
import { ScrollArea } from '@/components/ui/scroll-area'

export const AdminPanel = () => {
  const { toast } = useToast()
  const [searchQuery, setSearchQuery] = useState('')
  const [isRefreshing, setIsRefreshing] = useState(false)
  const [activeUsers, setActiveUsers] = useState(45)
  const [totalReservations, setTotalReservations] = useState(156)
  const [totalRevenue, setTotalRevenue] = useState(15690)

  const handleRefresh = async () => {
    setIsRefreshing(true)
    try {
      // Simulate API call
      await new Promise((resolve) => setTimeout(resolve, 1000))

      // Update stats with random variations
      setActiveUsers((prev) =>
        Math.max(30, Math.min(60, prev + Math.floor(Math.random() * 10) - 5)),
      )
      setTotalReservations((prev) => prev + Math.floor(Math.random() * 5))
      setTotalRevenue((prev) => prev + Math.floor(Math.random() * 1000))

      toast({
        title: 'Panel Actualizado',
        description: 'Los datos han sido actualizados correctamente',
      })
    } catch (error) {
      toast({
        title: 'Error al actualizar',
        description: 'No se pudieron actualizar los datos',
        variant: 'destructive',
      })
    } finally {
      setIsRefreshing(false)
    }
  }

  useEffect(() => {
    handleRefresh()
    const interval = setInterval(handleRefresh, 300000) // Refresh every 5 minutes
    return () => clearInterval(interval)
  }, [])

  const quickStats = [
    {
      label: 'Reservas Totales',
      value: totalReservations.toString(),
      icon: Users,
    },
    {
      label: 'Ingresos',
      value: `$${totalRevenue.toLocaleString()}`,
      icon: RefreshCw,
    },
    {
      label: 'Usuarios Activos',
      value: activeUsers.toString(),
      icon: Settings,
    },
  ]

  return (
    <motion.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      className="container mx-auto p-6 space-y-6"
    >
      <div className="glass-card p-6 rounded-xl border border-primary/10">
        <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
          <div className="flex items-center gap-3">
            <h1 className="text-3xl font-bold gradient-text">
              Panel de Administración
            </h1>
            <Button
              variant="outline"
              size="icon"
              onClick={handleRefresh}
              className={`${isRefreshing ? 'animate-spin' : ''}`}
              disabled={isRefreshing}
            >
              <RefreshCw className="h-4 w-4" />
            </Button>
          </div>

          <div className="relative w-full sm:w-64">
            <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 h-4 w-4" />
            <Input
              type="text"
              placeholder="Buscar..."
              value={searchQuery}
              onChange={(e) => setSearchQuery(e.target.value)}
              className="pl-10"
            />
          </div>
        </div>

        <AnimatePresence mode="wait">
          <motion.div
            key="stats"
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            exit={{ opacity: 0, y: -20 }}
            className="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6"
          >
            {quickStats.map((stat, index) => {
              const Icon = stat.icon
              return (
                <motion.div
                  key={index}
                  initial={{ opacity: 0, x: -20 }}
                  animate={{ opacity: 1, x: 0 }}
                  transition={{ delay: index * 0.1 }}
                >
                  <Card className="p-4 glass-card hover:shadow-lg transition-all duration-300">
                    <div className="flex items-center gap-3">
                      <div className="p-2 bg-primary/10 rounded-lg">
                        <Icon className="h-5 w-5 text-primary" />
                      </div>
                      <div>
                        <h3 className="text-sm text-gray-500">{stat.label}</h3>
                        <p className="text-2xl font-bold text-primary">
                          {stat.value}
                        </p>
                      </div>
                    </div>
                  </Card>
                </motion.div>
              )
            })}
          </motion.div>
        </AnimatePresence>

        <Tabs defaultValue="reservations" className="w-full">
          <TabsList className="grid w-full grid-cols-2 glass-card">
            <TabsTrigger value="reservations">Reservas</TabsTrigger>
            <TabsTrigger value="metrics">Métricas</TabsTrigger>
          </TabsList>

          <TabsContent value="reservations" className="mt-6">
            <Card className="glass-card">
              <ScrollArea className="h-[calc(100vh-20rem)]">
                <ReservationManagement searchQuery={searchQuery} />
              </ScrollArea>
            </Card>
          </TabsContent>

          <TabsContent value="metrics" className="mt-6">
            <Card className="glass-card">
              <ScrollArea className="h-[calc(100vh-20rem)]">
                <AdminMetrics />
              </ScrollArea>
            </Card>
          </TabsContent>
        </Tabs>
      </div>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\admin\ReservationManagement.tsx
import { useState } from 'react'
import { Card } from '@/components/ui/card'
import { ServiceRequest } from '@/types/service'
import { DownloadButtons } from '../form/DownloadButtons'
import { useToast } from '@/hooks/use-toast'
import { motion, AnimatePresence } from 'framer-motion'
import { Loader2 } from 'lucide-react'
import { ReservationList } from '@/features/reservations/components/ReservationList'
import { ReservationFilters } from '@/features/reservations/components/ReservationFilters'

interface ReservationManagementProps {
  searchQuery?: string
}

export const ReservationManagement = ({
  searchQuery = '',
}: ReservationManagementProps) => {
  const [selectedDate, setSelectedDate] = useState<Date | undefined>(new Date())
  const [localSearchQuery, setLocalSearchQuery] = useState(searchQuery)
  const [isLoading, setIsLoading] = useState(false)
  const [sortDirection, setSortDirection] = useState<'asc' | 'desc'>('desc')
  const { toast } = useToast()

  const mockReservations: ServiceRequest[] = [
    {
      id: '1',
      status: 'pending',
      createdAt: new Date(),
      username: 'John Doe',
      vehicleMake: 'Toyota',
      vehicleModel: 'Camry',
      vehicleYear: 2020,
      vehicleColor: 'Blue',
      truckType: 'standard',
      issueDescription: 'Flat tire',
      serviceType: 'standard',
      requiresManeuver: false,
      tollFees: 0,
    },
  ]

  const handleDownload = async (format: 'csv' | 'txt') => {
    setIsLoading(true)
    try {
      const data = mockReservations
      const content =
        format === 'csv'
          ? `ID,Status,Created At,Username\n${data.map((r) => `${r.id},${r.status},${r.createdAt},${r.username}`).join('\n')}`
          : JSON.stringify(data, null, 2)

      const blob = new Blob([content], {
        type: format === 'csv' ? 'text/csv' : 'text/plain',
      })
      const url = window.URL.createObjectURL(blob)
      const a = document.createElement('a')
      a.href = url
      a.download = `reservations.${format}`
      a.click()
      window.URL.revokeObjectURL(url)

      toast({
        title: 'Descarga Completada',
        description: `Reservas exportadas como ${format.toUpperCase()}`,
      })
    } catch (error) {
      toast({
        title: 'Error en la Exportación',
        description: 'No se pudieron exportar las reservas',
        variant: 'destructive',
      })
    } finally {
      setIsLoading(false)
    }
  }

  const handleSort = () => {
    setSortDirection((prev) => (prev === 'asc' ? 'desc' : 'asc'))
    toast({
      title: 'Lista Ordenada',
      description: `Ordenado por fecha ${sortDirection === 'asc' ? 'descendente' : 'ascendente'}`,
    })
  }

  const filteredReservations = mockReservations
    .filter(
      (res) =>
        res.username.toLowerCase().includes(localSearchQuery.toLowerCase()) ||
        res.vehicleMake
          .toLowerCase()
          .includes(localSearchQuery.toLowerCase()) ||
        res.vehicleModel.toLowerCase().includes(localSearchQuery.toLowerCase()),
    )
    .sort((a, b) => {
      const dateA = new Date(a.createdAt).getTime()
      const dateB = new Date(b.createdAt).getTime()
      return sortDirection === 'asc' ? dateA - dateB : dateB - dateA
    })

  return (
    <Card className="p-6">
      <motion.div
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        className="space-y-6"
      >
        <div className="flex justify-between items-center mb-6">
          <h2 className="text-2xl font-bold text-gray-900">
            Gestión de Reservas
          </h2>
          <DownloadButtons onDownload={handleDownload} />
        </div>

        <ReservationFilters
          searchQuery={localSearchQuery}
          onSearchChange={setLocalSearchQuery}
          selectedDate={selectedDate}
          onDateSelect={setSelectedDate}
          sortDirection={sortDirection}
          onSortChange={handleSort}
        />

        <AnimatePresence mode="wait">
          {isLoading ? (
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
              className="flex justify-center items-center py-8"
            >
              <Loader2 className="h-8 w-8 animate-spin text-primary" />
            </motion.div>
          ) : (
            <ReservationList
              reservations={filteredReservations}
              isLoading={isLoading}
            />
          )}
        </AnimatePresence>
      </motion.div>
    </Card>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\analytics\ServiceSummary.tsx
import { Card } from '@/components/ui/card'
import {
  BarChart,
  Bar,
  XAxis,
  YAxis,
  Tooltip,
  ResponsiveContainer,
} from 'recharts'
import { ServiceRequest } from '@/types/service'

const mockData = [
  { name: 'Ene', servicios: 4 },
  { name: 'Feb', servicios: 6 },
  { name: 'Mar', servicios: 8 },
  { name: 'Abr', servicios: 5 },
  { name: 'May', servicios: 7 },
]

export const ServiceSummary = () => {
  return (
    <Card className="p-6 space-y-6">
      <h2 className="text-2xl font-bold text-gray-900">Resumen de Servicios</h2>

      <div className="h-[300px] w-full">
        <ResponsiveContainer width="100%" height="100%">
          <BarChart data={mockData}>
            <XAxis dataKey="name" />
            <YAxis />
            <Tooltip />
            <Bar dataKey="servicios" fill="#4f46e5" />
          </BarChart>
        </ResponsiveContainer>
      </div>

      <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
        <Card className="p-4 bg-blue-50">
          <h3 className="text-lg font-semibold text-blue-900">
            Total Servicios
          </h3>
          <p className="text-3xl font-bold text-blue-600">30</p>
        </Card>
        <Card className="p-4 bg-green-50">
          <h3 className="text-lg font-semibold text-green-900">Completados</h3>
          <p className="text-3xl font-bold text-green-600">25</p>
        </Card>
        <Card className="p-4 bg-purple-50">
          <h3 className="text-lg font-semibold text-purple-900">En Proceso</h3>
          <p className="text-3xl font-bold text-purple-600">5</p>
        </Card>
      </div>
    </Card>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\auth\AuthGuard.tsx
import { Navigate, useLocation } from 'react-router-dom'
import { useToast } from '@/hooks/use-toast'

type UserRole = 'admin' | 'user'

interface AuthGuardProps {
  children: React.ReactNode
  requiredRole?: UserRole
}

export const AuthGuard = ({
  children,
  requiredRole = 'user',
}: AuthGuardProps) => {
  const { toast } = useToast()
  const location = useLocation()

  // This is a mock authentication check. Replace with your actual auth logic
  const isAuthenticated = true // Replace with actual auth check
  const userRole: UserRole = 'user' // Replace with actual user role

  if (!isAuthenticated) {
    toast({
      title: 'Acceso Denegado',
      description: 'Por favor inicia sesión para continuar',
      variant: 'destructive',
    })
    return <Navigate to="/login" state={{ from: location }} replace />
  }

  if (requiredRole === 'admin' && userRole === 'user') {
    toast({
      title: 'Acceso Restringido',
      description: 'No tienes permisos para acceder a esta sección',
      variant: 'destructive',
    })
    return <Navigate to="/" replace />
  }

  return <>{children}</>
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\cost\CostBreakdown.tsx
import { TowTruckType } from '@/utils/towTruckPricing'
import { formatCurrency } from '@/utils/priceCalculator'
import { Card } from '@/components/ui/card'
import {
  Receipt,
  Truck,
  TrendingUp,
  Flag,
  ArrowRight,
  ArrowLeft,
} from 'lucide-react'
import { motion, AnimatePresence } from 'framer-motion'
import { Button } from '@/components/ui/button'
import { CostFormulaDisplay } from './CostFormulaDisplay'
import { CostItemDisplay } from './CostItemDisplay'
import { TruckInfoHeader } from './TruckInfoHeader'
import { Separator } from '@/components/ui/separator'

interface CostBreakdownProps {
  baseCost: number
  flagDropFee: number
  tax: number
  totalDistance: number
  totalTollCost: number
  finalCost: number
  detectedTolls: Array<{
    name: string
    cost: number
    direction: 'outbound' | 'return'
  }>
  requiresInvoice: boolean
  setShowPaymentWindow: (show: boolean) => void
  maneuverCost: number
  requiresManeuver: boolean
  selectedTruck: TowTruckType
  subtotal: number
  selectedVehicleModel: string
}

export const CostBreakdown = ({
  baseCost,
  flagDropFee,
  tax,
  totalDistance,
  totalTollCost,
  finalCost,
  detectedTolls,
  requiresInvoice,
  setShowPaymentWindow,
  maneuverCost,
  requiresManeuver,
  selectedTruck,
  subtotal,
  selectedVehicleModel,
}: CostBreakdownProps) => {
  const outboundTolls = detectedTolls.filter(
    (toll) => toll.direction === 'outbound',
  )
  const returnTolls = detectedTolls.filter(
    (toll) => toll.direction === 'return',
  )

  return (
    <Card className="p-4 space-y-4 bg-white/50">
      <div className="space-y-2">
        <motion.div
          key={selectedTruck.name}
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          className="space-y-2"
        >
          <TruckInfoHeader
            selectedTruck={selectedTruck}
            selectedVehicleModel={selectedVehicleModel}
          />
          <CostFormulaDisplay
            selectedTruck={selectedTruck}
            requiresManeuver={requiresManeuver}
            requiresInvoice={requiresInvoice}
          />
        </motion.div>

        <AnimatePresence mode="wait">
          <div className="space-y-3 border-t pt-3 mt-2">
            <CostItemDisplay
              label={`Banderazo ${selectedTruck.name}`}
              amount={flagDropFee}
              icon={<Flag className="w-4 h-4 text-primary" />}
              description={`Cargo inicial por servicio de grúa ${selectedTruck.name}`}
            />

            <CostItemDisplay
              label={`Servicio base ${selectedTruck.name}`}
              amount={baseCost}
              icon={<TrendingUp className="w-4 h-4 text-primary" />}
              description={`${totalDistance.toFixed(2)} km × ${formatCurrency(selectedTruck.perKm)}/km`}
            />

            {requiresManeuver && (
              <CostItemDisplay
                label={`Cargo por maniobra especial (${selectedTruck.name})`}
                amount={selectedTruck.maneuverCharge}
                icon={<Truck className="w-4 h-4 text-orange-500" />}
                description="Cargo adicional por maniobras especiales requeridas"
              />
            )}

            {(outboundTolls.length > 0 || returnTolls.length > 0) && (
              <motion.div
                key={`tolls-${selectedTruck.name}`}
                initial={{ opacity: 0 }}
                animate={{ opacity: 1 }}
                className="space-y-3"
              >
                <div className="text-sm text-gray-600 font-medium flex items-center gap-2">
                  <Receipt className="w-4 h-4 text-primary" />
                  Peajes detectados en la ruta:
                </div>

                {outboundTolls.length > 0 && (
                  <div className="space-y-2">
                    <div className="flex items-center gap-2 text-sm text-blue-600">
                      <ArrowRight className="w-4 h-4" />
                      <span>Peajes de ida:</span>
                    </div>
                    {outboundTolls.map((toll, index) => (
                      <CostItemDisplay
                        key={`outbound-toll-${index}`}
                        label={toll.name}
                        amount={toll.cost}
                        indent
                      />
                    ))}
                  </div>
                )}

                {returnTolls.length > 0 && (
                  <div className="space-y-2">
                    <div className="flex items-center gap-2 text-sm text-blue-600">
                      <ArrowLeft className="w-4 h-4" />
                      <span>Peajes de regreso:</span>
                    </div>
                    {returnTolls.map((toll, index) => (
                      <CostItemDisplay
                        key={`return-toll-${index}`}
                        label={toll.name}
                        amount={toll.cost}
                        indent
                      />
                    ))}
                  </div>
                )}

                <div className="pt-2">
                  <CostItemDisplay
                    label="Total peajes (ida y vuelta)"
                    amount={totalTollCost}
                    className="font-medium"
                  />
                </div>
              </motion.div>
            )}

            <motion.div
              key={`subtotal-${selectedTruck.name}`}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              className="border-t pt-2 mt-2"
            >
              <CostItemDisplay
                label="Subtotal"
                amount={subtotal}
                description={`Suma de todos los cargos para grúa ${selectedTruck.name}`}
              />

              {requiresInvoice && (
                <CostItemDisplay
                  label="IVA (16%)"
                  amount={tax}
                  icon={<Receipt className="w-4 h-4 text-green-500" />}
                  description="Impuesto al Valor Agregado"
                />
              )}
            </motion.div>

            <motion.div
              key={`total-${selectedTruck.name}`}
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              className="border-t pt-3 text-lg font-bold flex justify-between items-center"
            >
              <span>Total Final</span>
              <span
                className={`${selectedTruck.name === 'Tipo D' ? 'text-orange-500' : 'text-primary'}`}
              >
                {formatCurrency(finalCost)}
              </span>
            </motion.div>
          </div>
        </AnimatePresence>
      </div>

      <Button
        className={`w-full ${
          selectedTruck.name === 'Tipo D'
            ? 'bg-orange-500 hover:bg-orange-600'
            : 'bg-primary hover:bg-primary/90'
        }`}
        onClick={() => setShowPaymentWindow(true)}
      >
        Proceder al pago
      </Button>
    </Card>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\cost\CostFormulaDisplay.tsx
import { Calculator } from 'lucide-react'
import { motion } from 'framer-motion'
import { formatCurrency } from '@/utils/priceCalculator'
import { TowTruckType } from '@/utils/towTruckPricing'

interface CostFormulaDisplayProps {
  selectedTruck: TowTruckType
  requiresManeuver: boolean
  requiresInvoice: boolean
}

export const CostFormulaDisplay = ({
  selectedTruck,
  requiresManeuver,
  requiresInvoice,
}: CostFormulaDisplayProps) => {
  return (
    <motion.div
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      className="text-sm text-gray-600 bg-blue-50/50 p-3 rounded-lg mt-2"
    >
      <div className="flex items-center gap-2 mb-2">
        <Calculator className="w-4 h-4 text-primary" />
        <span className="font-medium">
          Fórmula de cálculo para {selectedTruck.name}:
        </span>
      </div>
      <div className="pl-6 space-y-1">
        <p>
          • Distancia × {formatCurrency(selectedTruck.perKm)}/km (tarifa{' '}
          {selectedTruck.name})
        </p>
        <p>
          • Banderazo inicial {selectedTruck.name}:{' '}
          {formatCurrency(selectedTruck.flagDropFee)}
        </p>
        {requiresManeuver && (
          <p>
            • Cargo por maniobra {selectedTruck.name}:{' '}
            {formatCurrency(selectedTruck.maneuverCharge)}
          </p>
        )}
        {requiresInvoice && <p>• IVA: 16% del subtotal</p>}
      </div>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\cost\CostHeader.tsx
import { ChevronDown, ChevronUp, Info } from 'lucide-react'
import { Button } from '@/components/ui/button'
import { formatCurrency } from '@/utils/priceCalculator'
import { motion } from 'framer-motion'
import { TowTruckType } from '@/utils/towTruckPricing'
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from '@/components/ui/tooltip'

export interface CostHeaderProps {
  showBreakdown: boolean
  setShowBreakdown: (show: boolean) => void
  finalCost: number
  truckType: 'A' | 'B' | 'C' | 'D'
  selectedTruck: TowTruckType
}

export const CostHeader = ({
  showBreakdown,
  setShowBreakdown,
  finalCost,
  truckType,
  selectedTruck,
}: CostHeaderProps) => {
  console.log('CostHeader rendered:', {
    showBreakdown,
    finalCost,
    truckType,
  })

  return (
    <div className="flex justify-between items-center bg-white/50 p-4 rounded-lg backdrop-blur-sm border border-primary/10">
      <div>
        <h2 className="text-xl font-semibold text-gray-800">Costo Estimado</h2>
        <TooltipProvider>
          <Tooltip>
            <TooltipTrigger asChild>
              <p className="text-sm text-gray-600 flex items-center gap-2 cursor-help">
                {selectedTruck.name} - {selectedTruck.capacity}
                <Info className="h-4 w-4 text-primary/60" />
              </p>
            </TooltipTrigger>
            <TooltipContent>
              <p>Capacidad máxima: {selectedTruck.maxWeight}kg</p>
            </TooltipContent>
          </Tooltip>
        </TooltipProvider>
      </div>
      <div className="flex items-center gap-4">
        <motion.div
          key={finalCost}
          initial={{ scale: 0.95, opacity: 0 }}
          animate={{ scale: 1, opacity: 1 }}
          className={`text-2xl font-bold ${truckType === 'D' ? 'text-orange-500' : 'text-primary'}`}
        >
          {formatCurrency(finalCost)}
        </motion.div>
        <Button
          variant="ghost"
          size="icon"
          onClick={() => setShowBreakdown(!showBreakdown)}
          className="hover:bg-primary/10"
        >
          {showBreakdown ? (
            <ChevronUp className="h-4 w-4" />
          ) : (
            <ChevronDown className="h-4 w-4" />
          )}
        </Button>
      </div>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\cost\CostItemDisplay.tsx
import { motion } from 'framer-motion'
import { formatCurrency } from '@/utils/priceCalculator'

interface CostItemDisplayProps {
  label: string
  amount: number
  icon?: React.ReactNode
  indent?: boolean
  description?: string
  className?: string
}

export const CostItemDisplay = ({
  label,
  amount,
  icon,
  indent = false,
  description,
  className = '',
}: CostItemDisplayProps) => {
  return (
    <motion.div
      initial={{ opacity: 0, x: -20 }}
      animate={{ opacity: 1, x: 0 }}
      exit={{ opacity: 0, x: 20 }}
      className={`flex flex-col gap-1 ${indent ? 'pl-4' : ''} ${className}`}
    >
      <div className="flex justify-between items-center text-sm text-gray-600">
        <div className="flex items-center gap-2">
          {icon}
          <span>{label}</span>
        </div>
        <span className="font-medium">{formatCurrency(amount)}</span>
      </div>
      {description && (
        <p className="text-xs text-gray-500 italic">{description}</p>
      )}
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\cost\CostMetrics.tsx
import { Switch } from '@/components/ui/switch'
import { Label } from '@/components/ui/label'
import { TowTruckType } from '@/utils/towTruckPricing'
import { motion } from 'framer-motion'

export interface CostMetricsProps {
  totalDistance: number
  requiresInvoice: boolean
  setRequiresInvoice: (requires: boolean) => void
  requiresManeuver: boolean
  onManeuverChange: (checked: boolean) => void
  selectedTruck: TowTruckType
}

export const CostMetrics = ({
  totalDistance,
  requiresInvoice,
  setRequiresInvoice,
  requiresManeuver,
  onManeuverChange,
  selectedTruck,
}: CostMetricsProps) => {
  return (
    <motion.div
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      className="grid grid-cols-1 md:grid-cols-2 gap-4"
    >
      <div className="flex items-center justify-between space-x-2 p-4 bg-white/50 rounded-lg">
        <Label htmlFor="invoice" className="text-sm">
          Requiere factura (IVA 16%)
          <span className="block text-xs text-gray-500">
            Para {selectedTruck.name}
          </span>
        </Label>
        <Switch
          id="invoice"
          checked={requiresInvoice}
          onCheckedChange={setRequiresInvoice}
        />
      </div>

      <div className="flex items-center justify-between space-x-2 p-4 bg-white/50 rounded-lg">
        <Label htmlFor="maneuver" className="text-sm">
          Requiere maniobra especial
          <span className="block text-xs text-gray-500">
            +{selectedTruck.maneuverCharge.toFixed(2)} MXN para{' '}
            {selectedTruck.name}
          </span>
        </Label>
        <Switch
          id="maneuver"
          checked={requiresManeuver}
          onCheckedChange={onManeuverChange}
        />
      </div>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\cost\TruckInfoHeader.tsx
import { Truck } from 'lucide-react'
import { motion } from 'framer-motion'
import { TowTruckType } from '@/utils/towTruckPricing'

interface TruckInfoHeaderProps {
  selectedTruck: TowTruckType
  selectedVehicleModel: string
}

export const TruckInfoHeader = ({
  selectedTruck,
  selectedVehicleModel,
}: TruckInfoHeaderProps) => {
  return (
    <div className="space-y-2">
      <div className="text-lg font-semibold text-gray-800 flex items-center gap-2">
        <Truck
          className={`w-5 h-5 ${selectedTruck.name === 'Tipo D' ? 'text-orange-500' : 'text-primary'}`}
        />
        <span>
          {selectedTruck.name} - Capacidad:{' '}
          {selectedTruck.maxWeight.toLocaleString()} kg
        </span>
      </div>
      {selectedVehicleModel && (
        <motion.p
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          className="text-sm text-gray-600 ml-7"
        >
          Vehículo seleccionado: {selectedVehicleModel}
        </motion.p>
      )}
    </div>
  )
}

import { MapControls } from './MapControls'
import { RouteStreetInfo } from './RouteStreetInfo'
import { useToast } from '@/hooks/use-toast'
import { motion, AnimatePresence } from 'framer-motion'
import { Card } from '@/components/ui/card'
import { Loader2 } from 'lucide-react'
import { useMapNotifications } from '../hooks/useMapNotifications'

interface MapControlPanelProps {
  selectingPickup: boolean
  selectingDrop: boolean
  setSelectingPickup: (value: boolean) => void
  setSelectingDrop: (value: boolean) => void
  pickupLocation: { lat: number; lng: number } | null
  dropLocation: { lat: number; lng: number } | null
  pickupAddress?: string
  dropAddress?: string
  isLoading?: boolean
}

export const MapControlPanel = ({
  selectingPickup,
  selectingDrop,
  setSelectingPickup,
  setSelectingDrop,
  pickupLocation,
  dropLocation,
  pickupAddress,
  dropAddress,
  isLoading = false,
}: MapControlPanelProps) => {
  const { toast } = useToast()
  const { showLocationSelectionNotification } = useMapNotifications()

  const handlePickupClick = () => {
    setSelectingPickup(true)
    setSelectingDrop(false)
    showLocationSelectionNotification('pickup')
  }

  const handleDropClick = () => {
    setSelectingDrop(true)
    setSelectingPickup(false)
    showLocationSelectionNotification('drop')
  }

  return (
    <div className="fixed top-16 left-1/2 transform -translate-x-1/2 z-50 w-full max-w-2xl px-3 sm:px-4">
      <motion.div
        initial={{ opacity: 0, y: -20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.3 }}
        className="w-full"
      >
        <Card className="relative w-full bg-white/95 backdrop-blur-md shadow-md rounded-lg p-4 border border-primary/10 hover:border-primary/20 transition-all duration-300">
          {isLoading && (
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
              className="absolute inset-0 bg-white/70 backdrop-blur-sm flex items-center justify-center z-50 rounded-lg"
            >
              <Loader2 className="w-6 h-6 animate-spin text-primary" />
            </motion.div>
          )}
          <MapControls
            selectingPickup={selectingPickup}
            selectingDrop={selectingDrop}
            onPickupClick={handlePickupClick}
            onDropClick={handleDropClick}
          />
        </Card>
      </motion.div>

      <AnimatePresence>
        {(pickupLocation || dropLocation) && (
          <motion.div
            initial={{ opacity: 0, y: 10, scale: 0.95 }}
            animate={{ opacity: 1, y: 0, scale: 1 }}
            exit={{ opacity: 0, y: -10, scale: 0.95 }}
            transition={{ duration: 0.2 }}
            className="mt-3 w-full"
          >
            <RouteStreetInfo
              pickupLocation={pickupLocation}
              dropLocation={dropLocation}
              pickupAddress={pickupAddress}
              dropAddress={dropAddress}
              isLoading={isLoading}
            />
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\features\map\components\MapControls.tsx
import { MapPin, Navigation } from 'lucide-react'
import { Button } from '@/components/ui/button'
import { cn } from '@/lib/utils'

interface MapControlsProps {
  selectingPickup: boolean
  selectingDrop: boolean
  onPickupClick: () => void
  onDropClick: () => void
}

export const MapControls = ({
  selectingPickup,
  selectingDrop,
  onPickupClick,
  onDropClick,
}: MapControlsProps) => {
  return (
    <div className="flex flex-col sm:flex-row gap-3">
      <Button
        variant="outline"
        size="lg"
        onClick={onPickupClick}
        className={cn(
          'flex items-center gap-2 transition-all duration-300',
          selectingPickup
            ? 'bg-green-50 border-green-200 text-green-700'
            : 'hover:bg-green-50',
        )}
      >
        <MapPin className="h-4 w-4" />
        <span className="hidden sm:inline">Punto de Recogida</span>
      </Button>

      <Button
        variant="outline"
        size="lg"
        onClick={onDropClick}
        className={cn(
          'flex items-center gap-2 transition-all duration-300',
          selectingDrop
            ? 'bg-blue-50 border-blue-200 text-blue-700'
            : 'hover:bg-blue-50',
        )}
      >
        <Navigation className="h-4 w-4" />
        <span className="hidden sm:inline">Punto de Entrega</span>
      </Button>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\features\map\components\RouteStreetInfo.tsx
import { Card } from '@/components/ui/card'
import { MapPin, Navigation, Loader2 } from 'lucide-react'
import Draggable from 'react-draggable'
import { useRef } from 'react'

interface RouteStreetInfoProps {
  pickupLocation: { lat: number; lng: number } | null
  dropLocation: { lat: number; lng: number } | null
  pickupAddress?: string
  dropAddress?: string
  isLoading?: boolean
}

export const RouteStreetInfo = ({
  pickupLocation,
  dropLocation,
  pickupAddress,
  dropAddress,
  isLoading = false,
}: RouteStreetInfoProps) => {
  const nodeRef = useRef(null)

  if (!pickupLocation && !dropLocation) return null

  return (
    <Draggable handle=".drag-handle" bounds="parent" nodeRef={nodeRef}>
      <div ref={nodeRef} className="absolute z-[1000] max-w-md">
        <Card className="p-4 space-y-3 bg-white/95 backdrop-blur-sm shadow-lg transition-all duration-300 hover:shadow-xl border-blue-100/50">
          <div className="flex items-center justify-between border-b pb-2 mb-2 drag-handle cursor-move">
            <div className="font-semibold text-sm text-primary/90">
              Detalles de Ubicación
            </div>
            {isLoading && (
              <Loader2 className="w-4 h-4 animate-spin text-primary" />
            )}
          </div>

          {pickupLocation && (
            <div className="flex items-start gap-2">
              <MapPin className="w-5 h-5 mt-1 text-green-500 flex-shrink-0" />
              <div className="flex-1">
                <div className="font-semibold text-sm">Punto de Recogida</div>
                <div className="text-sm text-gray-600 break-words">
                  {pickupAddress || 'Cargando dirección...'}
                </div>
                <div className="text-xs text-gray-500 mt-1">
                  Coordenadas: {pickupLocation.lat.toFixed(6)},{' '}
                  {pickupLocation.lng.toFixed(6)}
                </div>
              </div>
            </div>
          )}

          {dropLocation && (
            <div className="flex items-start gap-2">
              <Navigation className="w-5 h-5 mt-1 text-red-500 flex-shrink-0" />
              <div className="flex-1">
                <div className="font-semibold text-sm">Punto de Entrega</div>
                <div className="text-sm text-gray-600 break-words">
                  {dropAddress || 'Cargando dirección...'}
                </div>
                <div className="text-xs text-gray-500 mt-1">
                  Coordenadas: {dropLocation.lat.toFixed(6)},{' '}
                  {dropLocation.lng.toFixed(6)}
                </div>
              </div>
            </div>
          )}
        </Card>
      </div>
    </Draggable>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\features\map\hooks\useMapNotifications.tsx
import { useToast } from '@/hooks/use-toast'
import { MapPin } from 'lucide-react'
import { ReactNode } from 'react'
import { ToastActionElement, ToastProps } from '@/components/ui/toast'

type ToasterToast = {
  id: string
  title?: React.ReactNode
  description?: React.ReactNode
  action?: ToastActionElement
  icon?: ReactNode
  className?: string
  variant?: 'default' | 'destructive'
}

export const useMapNotifications = () => {
  const { toast } = useToast()

  const showLocationSelectionNotification = (type: 'pickup' | 'drop'): void => {
    toast({
      title:
        type === 'pickup'
          ? 'Seleccionando punto de recogida'
          : 'Seleccionando punto de entrega',
      description: `Haz clic en el mapa para seleccionar el punto de ${type === 'pickup' ? 'recogida' : 'entrega'}`,
      className:
        type === 'pickup'
          ? 'bg-green-50 border-green-200'
          : 'bg-blue-50 border-blue-200',
    })
  }

  const showRouteCalculationError = (error: string): void => {
    toast({
      title: 'Error al calcular la ruta',
      description: error,
      variant: 'destructive',
    })
  }

  const showLocationUpdateSuccess = (
    type: 'pickup' | 'drop',
    address: string,
  ): void => {
    toast({
      title: `${type === 'pickup' ? 'Punto de recogida' : 'Punto de entrega'} actualizado`,
      description: address,
      className:
        type === 'pickup'
          ? 'bg-green-50 border-green-200'
          : 'bg-blue-50 border-blue-200',
    })
  }

  return {
    showLocationSelectionNotification,
    showRouteCalculationError,
    showLocationUpdateSuccess,
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\features\map\hooks\useMapState.ts
import { useState } from 'react'
import { useToast } from '@/hooks/use-toast'
import { useMapNotifications } from './useMapNotifications'
import { getAddressFromCoordinates } from '@/services/geocodingService'

interface Location {
  lat: number
  lng: number
}

export const useMapState = () => {
  const [pickupLocation, setPickupLocation] = useState<Location | null>(null)
  const [dropLocation, setDropLocation] = useState<Location | null>(null)
  const [pickupAddress, setPickupAddress] = useState('')
  const [dropAddress, setDropAddress] = useState('')
  const [selectingPickup, setSelectingPickup] = useState(false)
  const [selectingDrop, setSelectingDrop] = useState(false)
  const [isLoading, setIsLoading] = useState(false)

  const { showLocationUpdateSuccess } = useMapNotifications()

  const handleLocationSelect = async (
    location: Location,
    type: 'pickup' | 'drop',
  ) => {
    setIsLoading(true)
    try {
      const address = await getAddressFromCoordinates(
        location.lat,
        location.lng,
      )

      if (type === 'pickup') {
        setPickupLocation(location)
        setPickupAddress(address)
        setSelectingPickup(false)
      } else {
        setDropLocation(location)
        setDropAddress(address)
        setSelectingDrop(false)
      }

      showLocationUpdateSuccess(type, address)
    } catch (error) {
      console.error('Error getting address:', error)
    } finally {
      setIsLoading(false)
    }
  }

  return {
    pickupLocation,
    dropLocation,
    pickupAddress,
    dropAddress,
    selectingPickup,
    selectingDrop,
    isLoading,
    setSelectingPickup,
    setSelectingDrop,
    handleLocationSelect,
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\features\reservations\components\ReservationFilters.tsx
import { Input } from '@/components/ui/input'
import { Button } from '@/components/ui/button'
import { Calendar } from '@/components/ui/calendar'
import { Filter, SortAsc, SortDesc } from 'lucide-react'
import { motion } from 'framer-motion'

interface ReservationFiltersProps {
  searchQuery: string
  onSearchChange: (value: string) => void
  selectedDate: Date | undefined
  onDateSelect: (date: Date | undefined) => void
  sortDirection: 'asc' | 'desc'
  onSortChange: () => void
}

export const ReservationFilters = ({
  searchQuery,
  onSearchChange,
  selectedDate,
  onDateSelect,
  sortDirection,
  onSortChange,
}: ReservationFiltersProps) => {
  return (
    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
      <div className="space-y-2">
        <div className="flex items-center gap-2">
          <Filter className="h-4 w-4 text-gray-500" />
          <span className="text-sm font-medium text-gray-700">
            Filtrar Reservas
          </span>
        </div>
        <Input
          placeholder="Buscar reservas..."
          value={searchQuery}
          onChange={(e) => onSearchChange(e.target.value)}
          className="w-full"
        />
      </div>
      <div className="space-y-2">
        <div className="flex items-center gap-2">
          <Filter className="h-4 w-4 text-gray-500" />
          <span className="text-sm font-medium text-gray-700">
            Filtrar por Fecha
          </span>
        </div>
        <div className="flex items-center gap-2">
          <Calendar
            mode="single"
            selected={selectedDate}
            onSelect={onDateSelect}
            className="rounded-md border"
          />
          <Button
            variant="outline"
            size="icon"
            onClick={onSortChange}
            className="relative group"
          >
            {sortDirection === 'asc' ? (
              <SortAsc className="h-4 w-4" />
            ) : (
              <SortDesc className="h-4 w-4" />
            )}
          </Button>
        </div>
      </div>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\features\reservations\components\ReservationList.tsx
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from '@/components/ui/table'
import { Button } from '@/components/ui/button'
import { useToast } from '@/hooks/use-toast'
import { ServiceRequest } from '@/types/service'
import { motion } from 'framer-motion'

interface ReservationListProps {
  reservations: ServiceRequest[]
  isLoading: boolean
}

export const ReservationList = ({
  reservations,
  isLoading,
}: ReservationListProps) => {
  const { toast } = useToast()

  return (
    <motion.div
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      exit={{ opacity: 0 }}
      className="rounded-md border"
    >
      <Table>
        <TableHeader>
          <TableRow>
            <TableHead>ID</TableHead>
            <TableHead>Status</TableHead>
            <TableHead>Created</TableHead>
            <TableHead>Customer</TableHead>
            <TableHead>Vehicle</TableHead>
            <TableHead>Actions</TableHead>
          </TableRow>
        </TableHeader>
        <TableBody>
          {reservations.map((reservation) => (
            <TableRow key={reservation.id}>
              <TableCell>{reservation.id}</TableCell>
              <TableCell>
                <span
                  className={`px-2 py-1 rounded-full text-xs ${
                    reservation.status === 'completed'
                      ? 'bg-green-100 text-green-800'
                      : 'bg-yellow-100 text-yellow-800'
                  }`}
                >
                  {reservation.status}
                </span>
              </TableCell>
              <TableCell>
                {reservation.createdAt.toLocaleDateString()}
              </TableCell>
              <TableCell>{reservation.username}</TableCell>
              <TableCell>{`${reservation.vehicleYear} ${reservation.vehicleMake} ${reservation.vehicleModel}`}</TableCell>
              <TableCell>
                <Button
                  variant="outline"
                  size="sm"
                  onClick={() => {
                    toast({
                      title: 'Ver Detalles',
                      description: `Viendo reserva ${reservation.id}`,
                    })
                  }}
                >
                  Ver
                </Button>
              </TableCell>
            </TableRow>
          ))}
        </TableBody>
      </Table>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\AddressFields.tsx
import { LocationSearch } from './LocationSearch'
import { Card } from '@/components/ui/card'
import { MapPin, Navigation } from 'lucide-react'
import { Separator } from '@/components/ui/separator'
import { Button } from '@/components/ui/button'
import { getAddressFromCoordinates } from '@/services/geocodingService'
import { detectTollsOnRoute } from '@/utils/tollCalculator'
import { motion } from 'framer-motion'
import { useToast } from '@/components/ui/use-toast'

interface AddressFieldsProps {
  pickupLocation: { lat: number; lng: number } | null
  dropLocation: { lat: number; lng: number } | null
  pickupAddress: string
  dropAddress: string
  onPickupSelect: (location: {
    lat: number
    lng: number
    address: string
  }) => void
  onDropSelect: (location: {
    lat: number
    lng: number
    address: string
  }) => void
  onTollUpdate?: (tollCost: number) => void
  onSelectingPickup: (selecting: boolean) => void
  onSelectingDrop: (selecting: boolean) => void
  className?: string
}

export const AddressFields = ({
  pickupLocation,
  dropLocation,
  pickupAddress,
  dropAddress,
  onPickupSelect,
  onDropSelect,
  onTollUpdate,
  onSelectingPickup,
  onSelectingDrop,
  className = '',
}: AddressFieldsProps) => {
  const { toast } = useToast()

  const handleLocationSelect = async (
    location: { lat: number; lng: number; address: string },
    type: 'pickup' | 'drop',
  ) => {
    try {
      if (type === 'pickup') {
        onPickupSelect(location)
        onSelectingPickup(false)
      } else {
        onDropSelect(location)
        onSelectingDrop(false)
      }

      if (pickupLocation && dropLocation) {
        const tollInfo = await detectTollsOnRoute(
          type === 'pickup'
            ? { lat: location.lat, lng: location.lng }
            : pickupLocation,
          type === 'drop'
            ? { lat: location.lat, lng: location.lng }
            : dropLocation,
        )
        onTollUpdate?.(tollInfo.totalTollCost)

        if (tollInfo.tolls.length > 0) {
          toast({
            title: 'Peajes detectados',
            description: `Se han detectado ${tollInfo.tolls.length} peajes en la ruta`,
          })
        }
      }
    } catch (error) {
      toast({
        title: 'Error',
        description: 'No se pudo procesar la ubicación',
        variant: 'destructive',
      })
    }
  }

  return (
    <Card
      className={`p-6 space-y-6 bg-gradient-to-br from-white/95 to-blue-50/95 border-blue-100 shadow-lg hover:shadow-xl transition-all duration-300 ${className}`}
    >
      <motion.div
        className="space-y-6"
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
      >
        <div className="relative">
          <div className="flex items-center justify-between gap-2 mb-4">
            <div className="flex items-center gap-2">
              <MapPin className="h-5 w-5 text-green-500" />
              <h3 className="font-semibold text-lg text-gray-800">
                Punto de Recogida
              </h3>
            </div>
            <Button
              variant="outline"
              size="sm"
              onClick={() => onSelectingPickup(true)}
              className="text-sm hover:bg-green-50 hover:text-green-600 transition-colors"
            >
              <MapPin className="h-4 w-4 mr-2 text-green-500" />
              Seleccionar en Mapa
            </Button>
          </div>
          <LocationSearch
            label=""
            placeholder="Ingrese dirección de recogida"
            currentAddress={pickupAddress}
            currentLocation={pickupLocation}
            onLocationSelect={(loc) =>
              handleLocationSelect({ ...loc, address: loc.address }, 'pickup')
            }
            icon={<MapPin className="h-4 w-4 text-green-500" />}
          />
        </div>

        <Separator className="my-4" />

        <div className="relative">
          <div className="flex items-center justify-between gap-2 mb-4">
            <div className="flex items-center gap-2">
              <Navigation className="h-5 w-5 text-red-500" />
              <h3 className="font-semibold text-lg text-gray-800">
                Punto de Entrega
              </h3>
            </div>
            <Button
              variant="outline"
              size="sm"
              onClick={() => onSelectingDrop(true)}
              className="text-sm hover:bg-red-50 hover:text-red-600 transition-colors"
            >
              <Navigation className="h-4 w-4 mr-2 text-red-500" />
              Seleccionar en Mapa
            </Button>
          </div>
          <LocationSearch
            label=""
            placeholder="Ingrese dirección de entrega"
            currentAddress={dropAddress}
            currentLocation={dropLocation}
            onLocationSelect={(loc) =>
              handleLocationSelect({ ...loc, address: loc.address }, 'drop')
            }
            icon={<Navigation className="h-4 w-4 text-red-500" />}
          />
        </div>
      </motion.div>
    </Card>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\DownloadButtons.tsx
import { Button } from '@/components/ui/button'
import { Download, FileText } from 'lucide-react'
import { downloadServiceInfo } from '@/utils/downloadUtils'

interface DownloadButtonsProps {
  onDownload: (format: 'csv' | 'txt') => Promise<void>
}

export const DownloadButtons = ({ onDownload }: DownloadButtonsProps) => {
  return (
    <div className="flex gap-2 flex-1">
      <Button
        type="button"
        variant="outline"
        onClick={() => onDownload('csv')}
        className="flex-1 bg-gradient-to-r from-emerald-50 to-teal-50 border-emerald-200 hover:border-emerald-300 hover:bg-emerald-100 transition-all duration-300"
      >
        <Download className="w-4 h-4 mr-2 text-emerald-600" />
        CSV
      </Button>
      <Button
        type="button"
        variant="outline"
        onClick={() => onDownload('txt')}
        className="flex-1 bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200 hover:border-blue-300 hover:bg-blue-100 transition-all duration-300"
      >
        <FileText className="w-4 h-4 mr-2 text-blue-600" />
        TXT
      </Button>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\EnhancedFormActions.tsx
import { Button } from '@/components/ui/button'
import { CreditCard, Copy, CheckCircle2 } from 'lucide-react'
import { motion } from 'framer-motion'

interface EnhancedFormActionsProps {
  onCopy: () => void
  isCopied: boolean
  isPending: boolean
}

export const EnhancedFormActions = ({
  onCopy,
  isCopied,
  isPending,
}: EnhancedFormActionsProps) => {
  return (
    <motion.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.5, delay: 0.6 }}
      className="space-y-4"
    >
      <div className="flex gap-2">
        <Button
          variant="outline"
          size="lg"
          onClick={onCopy}
          className="flex-1 bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200 hover:border-blue-300 hover:bg-blue-100 transition-all duration-300 group relative overflow-hidden"
        >
          <span className="flex items-center justify-center gap-2">
            {isCopied ? (
              <CheckCircle2 className="h-5 w-5 text-green-500" />
            ) : (
              <Copy className="h-5 w-5 text-blue-500 group-hover:scale-110 transition-transform" />
            )}
            {isCopied ? '¡Copiado!' : 'Copiar Información'}
          </span>
          <span className="absolute inset-0 bg-white/10 transform -skew-x-12 group-hover:translate-x-full transition-transform duration-700 ease-out" />
        </Button>
        <Button
          type="submit"
          size="lg"
          disabled={isPending}
          className="flex-1 bg-gradient-to-r from-primary to-primary-dark hover:from-primary-dark hover:to-primary text-white shadow-lg hover:shadow-xl transition-all duration-300 group relative overflow-hidden"
        >
          {isPending ? (
            <span className="flex items-center justify-center gap-3">
              <div className="w-5 h-5 border-3 border-white/30 border-t-white rounded-full animate-spin" />
              Procesando...
            </span>
          ) : (
            <span className="flex items-center justify-center gap-3">
              <CreditCard className="h-5 w-5 group-hover:scale-110 transition-transform" />
              Continuar al Pago
              <span className="absolute inset-0 bg-white/10 transform -skew-x-12 group-hover:translate-x-full transition-transform duration-700 ease-out" />
            </span>
          )}
        </Button>
      </div>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\EnhancedFormHeader.tsx
import { motion } from 'framer-motion'
import { FileText, Info } from 'lucide-react'
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from '@/components/ui/tooltip'

export const EnhancedFormHeader = () => {
  return (
    <motion.div
      className="space-y-4"
      initial={{ opacity: 0, y: -20 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.5 }}
    >
      <div className="flex items-center justify-between">
        <div className="flex items-center gap-3">
          <div className="p-2 bg-primary/10 rounded-lg">
            <FileText className="w-6 h-6 text-primary" />
          </div>
          <div>
            <h2 className="text-2xl font-semibold text-gray-800">
              Información del Servicio
            </h2>
            <p className="text-gray-600 text-sm">
              Complete los detalles del vehículo y servicio requerido
            </p>
          </div>
        </div>
        <TooltipProvider>
          <Tooltip>
            <TooltipTrigger asChild>
              <button className="p-2 hover:bg-gray-100 rounded-full transition-colors">
                <Info className="w-5 h-5 text-gray-500" />
              </button>
            </TooltipTrigger>
            <TooltipContent>
              <p>Todos los campos son requeridos para procesar su solicitud</p>
            </TooltipContent>
          </Tooltip>
        </TooltipProvider>
      </div>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\FloatingPanel.tsx
import { ReactNode, useState } from 'react'
import { cn } from '@/lib/utils'
import {
  ChevronUp,
  ChevronDown,
  X,
  GripVertical,
  Maximize2,
  Minimize2,
} from 'lucide-react'
import { Button } from '@/components/ui/button'
import Draggable from 'react-draggable'
import { useToast } from '@/hooks/use-toast'

interface FloatingPanelProps {
  children: ReactNode
  className?: string
  position?: 'left' | 'right' | 'top' | 'bottom'
  title?: string
}

export const FloatingPanel = ({
  children,
  className,
  position = 'right',
  title = 'Panel',
}: FloatingPanelProps) => {
  const [isCollapsed, setIsCollapsed] = useState(false)
  const [isVisible, setIsVisible] = useState(true)
  const [isDragging, setIsDragging] = useState(false)
  const [isMaximized, setIsMaximized] = useState(false)
  const { toast } = useToast()

  const handleDragStart = () => {
    setIsDragging(true)
    toast({
      title: 'Panel móvil',
      description: 'Puedes mover este panel a cualquier parte de la pantalla',
      duration: 2000,
    })
  }

  const handleDragStop = () => {
    setIsDragging(false)
  }

  if (!isVisible) {
    return (
      <Button
        variant="secondary"
        size="sm"
        onClick={() => setIsVisible(true)}
        className={cn(
          'fixed z-[1000] bg-white/95 shadow-lg backdrop-blur-sm',
          'transition-all duration-300 ease-in-out hover:scale-105',
          position === 'right' && 'right-4 top-20',
          position === 'left' && 'left-4 top-20',
          position === 'top' && 'top-4 right-4',
          position === 'bottom' && 'bottom-4 right-4',
        )}
      >
        <Maximize2 className="w-4 h-4 mr-2" />
        Mostrar {title}
      </Button>
    )
  }

  return (
    <Draggable
      handle=".drag-handle"
      onStart={handleDragStart}
      onStop={handleDragStop}
      bounds="parent"
      disabled={isMaximized}
    >
      <div
        className={cn(
          'fixed bg-white/95 rounded-lg shadow-xl backdrop-blur-sm transition-all duration-300',
          isMaximized
            ? 'inset-4 !transform-none'
            : cn(
                position === 'right' && 'right-6 top-24',
                position === 'left' && 'left-6 top-24',
                position === 'top' && 'top-6 inset-x-6',
                position === 'bottom' && 'bottom-6 inset-x-6',
              ),
          'z-[1000]',
          isDragging && 'cursor-grabbing shadow-2xl scale-[1.02]',
          !isMaximized && 'hover:shadow-lg hover:shadow-primary/5',
          className,
        )}
      >
        <div
          className={cn(
            'flex items-center justify-between p-3 border-b',
            'bg-gradient-to-r from-primary/5 to-primary/10',
            'rounded-t-lg',
          )}
        >
          <div className="flex items-center gap-2">
            {!isMaximized && (
              <div className="drag-handle cursor-grab active:cursor-grabbing p-1.5 hover:bg-primary/10 rounded-md">
                <GripVertical className="h-4 w-4 text-primary/70" />
              </div>
            )}
            <h3 className="font-semibold text-sm text-primary/90">{title}</h3>
          </div>
          <div className="flex gap-1">
            <Button
              variant="ghost"
              size="sm"
              onClick={() => setIsCollapsed(!isCollapsed)}
              className="p-1.5 h-8 w-8 hover:bg-primary/10"
            >
              {isCollapsed ? (
                <ChevronUp className="h-4 w-4 text-primary/70" />
              ) : (
                <ChevronDown className="h-4 w-4 text-primary/70" />
              )}
            </Button>
            <Button
              variant="ghost"
              size="sm"
              onClick={() => setIsMaximized(!isMaximized)}
              className="p-1.5 h-8 w-8 hover:bg-primary/10"
            >
              {isMaximized ? (
                <Minimize2 className="h-4 w-4 text-primary/70" />
              ) : (
                <Maximize2 className="h-4 w-4 text-primary/70" />
              )}
            </Button>
            <Button
              variant="ghost"
              size="sm"
              onClick={() => {
                setIsVisible(false)
                toast({
                  title: 'Panel oculto',
                  description: "Haz clic en 'Mostrar Panel' para restaurar",
                  duration: 2000,
                })
              }}
              className="p-1.5 h-8 w-8 hover:bg-primary/10"
            >
              <X className="h-4 w-4 text-primary/70" />
            </Button>
          </div>
        </div>
        <div
          className={cn(
            'transition-all duration-300 overflow-hidden',
            isCollapsed ? 'h-0' : isMaximized ? 'p-6' : 'p-4',
            !isCollapsed && 'animate-in fade-in-50',
          )}
        >
          {children}
        </div>
      </div>
    </Draggable>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\LocationSearch.tsx
import { useState, useCallback, useEffect } from 'react'
import { useToast } from '@/hooks/use-toast'
import { debounce } from 'lodash'
import { LocationSearchInput } from './LocationSearchInput'
import { LocationSuggestions } from './LocationSuggestions'
import { searchAddresses } from '@/services/geocodingService'
import { calculateDistance } from '@/utils/distanceUtils'
import { COMPANY_LOCATION } from '@/services/routeService'
import { MapPin, Navigation } from 'lucide-react'
import { motion } from 'framer-motion'

interface LocationSearchProps {
  label: string
  onLocationSelect: (location: {
    lat: number
    lng: number
    address: string
  }) => void
  placeholder?: string
  currentAddress?: string
  currentLocation?: { lat: number; lng: number } | null
  icon?: React.ReactNode
  type?: 'pickup' | 'drop'
}

export const LocationSearch = ({
  label,
  onLocationSelect,
  placeholder = 'Buscar dirección...',
  currentAddress = '',
  currentLocation,
  icon = <MapPin className="h-4 w-4 text-primary" />,
  type = 'pickup',
}: LocationSearchProps) => {
  const [searchQuery, setSearchQuery] = useState(currentAddress || '')
  const [suggestions, setSuggestions] = useState<
    Array<{
      address: string
      lat: number
      lon: number
      distance: number
    }>
  >([])
  const [isSearching, setIsSearching] = useState(false)
  const [error, setError] = useState<string | null>(null)
  const [isMarking, setIsMarking] = useState(false)
  const { toast } = useToast()

  useEffect(() => {
    if (currentAddress && currentAddress !== searchQuery) {
      setSearchQuery(currentAddress)
    }
  }, [currentAddress])

  const debouncedSearch = useCallback(
    debounce(async (query: string) => {
      if (query.length < 2) {
        setSuggestions([])
        setError(null)
        return
      }

      setIsSearching(true)
      setError(null)

      try {
        const results = await searchAddresses(query, {
          fuzzyMatch: true,
          limit: 5,
          countryCode: 'MX',
          proximity: COMPANY_LOCATION,
        })

        const resultsWithDistance = results
          .map((result) => ({
            ...result,
            distance: calculateDistance(
              { lat: COMPANY_LOCATION.lat, lng: COMPANY_LOCATION.lng },
              { lat: result.lat, lng: result.lon },
            ),
          }))
          .sort((a, b) => {
            const relevanceA = a.address
              .toLowerCase()
              .includes(query.toLowerCase())
              ? 0
              : 1
            const relevanceB = b.address
              .toLowerCase()
              .includes(query.toLowerCase())
              ? 0
              : 1
            return relevanceA !== relevanceB
              ? relevanceA - relevanceB
              : a.distance - b.distance
          })

        setSuggestions(resultsWithDistance)

        if (results.length === 0) {
          setError(
            'No se encontraron direcciones. Intente con una búsqueda diferente.',
          )
        }
      } catch (error) {
        setError('Error al buscar direcciones. Por favor, inténtelo de nuevo.')
      } finally {
        setIsSearching(false)
      }
    }, 300),
    [],
  )

  const handleSuggestionSelect = async (suggestion: {
    address: string
    lat: number
    lon: number
  }) => {
    setIsMarking(true)
    try {
      const location = {
        lat: suggestion.lat,
        lng: suggestion.lon,
        address: suggestion.address,
      }

      setSearchQuery(suggestion.address)
      setSuggestions([])
      setError(null)

      onLocationSelect(location)

      toast({
        title:
          type === 'pickup'
            ? 'Punto de recogida seleccionado'
            : 'Punto de entrega seleccionado',
        description: suggestion.address,
      })
    } catch (error) {
      toast({
        title: 'Error',
        description: 'Error al seleccionar la ubicación',
        variant: 'destructive',
      })
    } finally {
      setIsMarking(false)
    }
  }

  const handleSearchClick = () => {
    if (searchQuery.length >= 2) {
      debouncedSearch(searchQuery)
    }
  }

  return (
    <motion.div
      className="space-y-2"
      initial={{ opacity: 0, y: 5 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.3 }}
    >
      <div className="flex-1">
        <LocationSearchInput
          searchQuery={searchQuery}
          isSearching={isSearching}
          error={error}
          onSearchChange={(value) => {
            setSearchQuery(value)
            if (value.length >= 2) {
              debouncedSearch(value)
            } else {
              setSuggestions([])
              setError(null)
            }
          }}
          onSearchClick={handleSearchClick}
          placeholder={placeholder}
          icon={
            type === 'pickup' ? (
              <MapPin className="h-4 w-4 text-green-500" />
            ) : (
              <Navigation className="h-4 w-4 text-red-500" />
            )
          }
        />
      </div>

      <LocationSuggestions
        suggestions={suggestions}
        error={error}
        isMarking={isMarking}
        onSuggestionSelect={handleSuggestionSelect}
      />
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\LocationSearchInput.tsx
import { Input } from '@/components/ui/input'
import { Search, Loader2, MapPin } from 'lucide-react'
import { Button } from '@/components/ui/button'
import { motion, AnimatePresence } from 'framer-motion'

interface LocationSearchInputProps {
  searchQuery: string
  isSearching: boolean
  error: string | null
  onSearchChange: (value: string) => void
  onSearchClick: () => void
  placeholder?: string
  icon?: React.ReactNode
}

export const LocationSearchInput = ({
  searchQuery,
  isSearching,
  error,
  onSearchChange,
  onSearchClick,
  placeholder = 'Buscar dirección...',
  icon = <MapPin className="h-4 w-4 text-primary" />,
}: LocationSearchInputProps) => {
  return (
    <motion.div
      className="relative"
      initial={{ opacity: 0, y: 10 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.3 }}
    >
      <div className="relative flex items-center group">
        <div className="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 transition-colors group-hover:text-primary/70">
          {icon}
        </div>
        <Input
          value={searchQuery}
          onChange={(e) => onSearchChange(e.target.value)}
          placeholder={placeholder}
          className={`
            pl-10 pr-10 h-12 bg-white/95 backdrop-blur-sm 
            border-gray-200 hover:border-primary/50 focus:border-primary
            focus:ring-2 focus:ring-primary/20 
            placeholder:text-gray-400 transition-all duration-200
            ${error ? 'border-red-300 focus:border-red-400 focus:ring-red-200' : ''}
            ${isSearching ? 'pr-16' : ''}
          `}
          onKeyDown={(e) => {
            if (e.key === 'Enter') {
              e.preventDefault()
              onSearchClick()
            }
          }}
        />
        <AnimatePresence>
          {isSearching ? (
            <motion.div
              initial={{ opacity: 0, scale: 0.8 }}
              animate={{ opacity: 1, scale: 1 }}
              exit={{ opacity: 0, scale: 0.8 }}
              className="absolute right-3 top-1/2 -translate-y-1/2"
            >
              <Loader2 className="h-5 w-5 animate-spin text-primary" />
            </motion.div>
          ) : (
            <Button
              type="button"
              variant="ghost"
              size="sm"
              className="absolute right-1 top-1/2 -translate-y-1/2 h-8 hover:bg-primary/10 transition-colors"
              onClick={onSearchClick}
              disabled={isSearching || searchQuery.length < 3}
            >
              <Search className="h-4 w-4 text-primary" />
            </Button>
          )}
        </AnimatePresence>
      </div>
      <AnimatePresence>
        {error && (
          <motion.p
            className="text-sm text-red-500 mt-1 ml-1"
            initial={{ opacity: 0, y: -10 }}
            animate={{ opacity: 1, y: 0 }}
            exit={{ opacity: 0, y: -10 }}
          >
            {error}
          </motion.p>
        )}
      </AnimatePresence>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\LocationSelector.tsx
import {
  FormField,
  FormItem,
  FormLabel,
  FormControl,
} from '@/components/ui/form'
import { UseFormReturn } from 'react-hook-form'
import { FormData } from '@/types/form'
import { LocationSearch } from './LocationSearch'
import { MapPin, Navigation } from 'lucide-react'
import { useToast } from '@/hooks/use-toast'
import { useEffect } from 'react'

export interface LocationSelectorProps {
  form: UseFormReturn<FormData>
  pickupLocation?: { lat: number; lng: number } | null
  dropLocation?: { lat: number; lng: number } | null
  pickupAddress?: string
  dropAddress?: string
  onPickupSelect?: (location: {
    lat: number
    lng: number
    address: string
  }) => void
  onDropSelect?: (location: {
    lat: number
    lng: number
    address: string
  }) => void
  onSelectingPickup?: (selecting: boolean) => void
  onSelectingDrop?: (selecting: boolean) => void
}

export const LocationSelector = ({
  form,
  pickupLocation,
  dropLocation,
  pickupAddress,
  dropAddress,
  onPickupSelect,
  onDropSelect,
  onSelectingPickup,
  onSelectingDrop,
}: LocationSelectorProps) => {
  const { toast } = useToast()

  // Sincronizar direcciones con el formulario
  useEffect(() => {
    if (pickupAddress) {
      form.setValue('pickupLocation', {
        lat: pickupLocation?.lat || 0,
        lng: pickupLocation?.lng || 0,
        address: pickupAddress,
      })
    }
  }, [pickupAddress, pickupLocation, form])

  useEffect(() => {
    if (dropAddress) {
      form.setValue('dropoffLocation', {
        lat: dropLocation?.lat || 0,
        lng: dropLocation?.lng || 0,
        address: dropAddress,
      })
    }
  }, [dropAddress, dropLocation, form])

  const handleLocationSelect = async (
    location: { lat: number; lng: number; address: string },
    type: 'pickup' | 'drop',
  ) => {
    if (type === 'pickup') {
      form.setValue('pickupLocation', location)
      onPickupSelect?.(location)
      onSelectingPickup?.(false)
    } else {
      form.setValue('dropoffLocation', location)
      onDropSelect?.(location)
      onSelectingDrop?.(false)
    }

    toast({
      title:
        type === 'pickup'
          ? 'Ubicación de recogida actualizada'
          : 'Ubicación de entrega actualizada',
      description: location.address,
    })
  }

  return (
    <div className="space-y-6">
      <FormField
        control={form.control}
        name="pickupLocation"
        render={({ field }) => (
          <FormItem>
            <FormLabel className="text-lg font-semibold">
              Ubicación de Recogida
            </FormLabel>
            <FormControl>
              <LocationSearch
                label="Ubicación de Recogida"
                placeholder="Ingrese dirección de recogida..."
                icon={<MapPin className="h-4 w-4 text-primary" />}
                currentAddress={pickupAddress}
                currentLocation={pickupLocation}
                onLocationSelect={(location) =>
                  handleLocationSelect(location, 'pickup')
                }
                type="pickup"
              />
            </FormControl>
          </FormItem>
        )}
      />

      <FormField
        control={form.control}
        name="dropoffLocation"
        render={({ field }) => (
          <FormItem>
            <FormLabel className="text-lg font-semibold">
              Ubicación de Entrega
            </FormLabel>
            <FormControl>
              <LocationSearch
                label="Ubicación de Entrega"
                placeholder="Ingrese dirección de entrega..."
                icon={<Navigation className="h-4 w-4 text-primary" />}
                currentAddress={dropAddress}
                currentLocation={dropLocation}
                onLocationSelect={(location) =>
                  handleLocationSelect(location, 'drop')
                }
                type="drop"
              />
            </FormControl>
          </FormItem>
        )}
      />
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\LocationSuggestions.tsx
import { motion, AnimatePresence } from 'framer-motion'
import { MapPin, Target, Loader2, Navigation, AlertCircle } from 'lucide-react'
import { Alert, AlertDescription } from '@/components/ui/alert'
import { Card } from '@/components/ui/card'
import { Badge } from '@/components/ui/badge'

interface Suggestion {
  address: string
  lat: number
  lon: number
  distance: number
  city?: string
  state?: string
  zip?: string
}

interface LocationSuggestionsProps {
  suggestions: Suggestion[]
  error: string | null
  isMarking: boolean
  onSuggestionSelect: (suggestion: Suggestion) => void
  type?: 'pickup' | 'drop'
}

export const LocationSuggestions = ({
  suggestions,
  error,
  isMarking,
  onSuggestionSelect,
  type = 'pickup',
}: LocationSuggestionsProps) => {
  return (
    <AnimatePresence>
      {error && (
        <motion.div
          initial={{ opacity: 0, y: -10 }}
          animate={{ opacity: 1, y: 0 }}
          exit={{ opacity: 0, y: -10 }}
        >
          <Alert variant="destructive" className="mt-2">
            <AlertCircle className="h-4 w-4" />
            <AlertDescription>{error}</AlertDescription>
          </Alert>
        </motion.div>
      )}

      {suggestions.length > 0 && (
        <motion.div
          initial={{ opacity: 0, y: -10 }}
          animate={{ opacity: 1, y: 0 }}
          exit={{ opacity: 0, y: -10 }}
          className="absolute z-50 w-full mt-1"
        >
          <Card className="p-2 space-y-1 bg-white/95 backdrop-blur-sm shadow-lg border-blue-100/50">
            {suggestions.map((suggestion, index) => (
              <motion.button
                key={index}
                initial={{ opacity: 0, x: -5 }}
                animate={{ opacity: 1, x: 0 }}
                exit={{ opacity: 0, x: -5 }}
                transition={{ delay: index * 0.05 }}
                className="w-full p-3 text-left hover:bg-primary/5 rounded-lg flex items-center gap-3 transition-all duration-300 group relative"
                onClick={() => !isMarking && onSuggestionSelect(suggestion)}
                disabled={isMarking}
              >
                {isMarking ? (
                  <Target className="h-4 w-4 text-primary animate-pulse flex-shrink-0" />
                ) : type === 'pickup' ? (
                  <MapPin className="h-4 w-4 text-green-500 group-hover:text-green-600 flex-shrink-0" />
                ) : (
                  <Navigation className="h-4 w-4 text-blue-500 group-hover:text-blue-600 flex-shrink-0" />
                )}

                <div className="flex flex-col flex-1">
                  <span className="text-sm text-gray-700 group-hover:text-gray-900 line-clamp-2">
                    {suggestion.address}, {suggestion.city}, {suggestion.state}
                  </span>
                  <div className="flex items-center gap-2 mt-1">
                    <Badge variant="secondary" className="text-xs">
                      {suggestion.distance.toFixed(1)} km
                    </Badge>
                  </div>
                </div>

                {isMarking && (
                  <motion.div
                    initial={{ scale: 0 }}
                    animate={{ scale: 1 }}
                    className="absolute inset-0 bg-primary/5 flex items-center justify-center rounded-lg"
                  >
                    <Loader2 className="h-6 w-6 animate-spin text-primary" />
                  </motion.div>
                )}
              </motion.button>
            ))}
          </Card>
        </motion.div>
      )}

      {suggestions.length === 0 && !isMarking && !error && (
        <div className="mt-4 text-gray-500">No suggestions available</div>
      )}
    </AnimatePresence>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\ManeuverField.tsx
import {
  FormField,
  FormItem,
  FormLabel,
  FormControl,
} from '@/components/ui/form'
import { Textarea } from '@/components/ui/textarea'
import { UseFormReturn } from 'react-hook-form'
import { FormData } from '@/types/form'
import { Card } from '@/components/ui/card'

interface ManeuverFieldProps {
  form: UseFormReturn<FormData>
  onManeuverChange?: () => void
}

export const ManeuverField = ({
  form,
  onManeuverChange,
}: ManeuverFieldProps) => {
  return (
    <Card className="p-4 space-y-4">
      <FormField
        control={form.control}
        name="issueDescription"
        render={({ field }) => (
          <FormItem>
            <FormLabel className="text-base font-semibold">
              Descripción del Problema
            </FormLabel>
            <FormControl>
              <Textarea
                placeholder="Describa el problema o situación especial del vehículo (ej: no enciende, llanta ponchada, etc.)"
                className="min-h-[100px] resize-none"
                {...field}
                onChange={(e) => {
                  field.onChange(e)
                  if (e.target.value.length > 0) {
                    form.setValue('requiresManeuver', true)
                    onManeuverChange?.()
                  }
                }}
              />
            </FormControl>
          </FormItem>
        )}
      />
    </Card>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\ServiceRequirements.tsx
import {
  FormField,
  FormItem,
  FormLabel,
  FormControl,
  FormMessage,
} from '@/components/ui/form'
import { Textarea } from '@/components/ui/textarea'
import { Wrench } from 'lucide-react'
import { UseFormReturn } from 'react-hook-form'
import { FormData } from '@/types/form'
import { motion } from 'framer-motion'

export interface ServiceRequirementsProps {
  form: UseFormReturn<FormData>
  requiresManeuver?: boolean
  onManeuverChange?: (checked: boolean) => void
}

export const ServiceRequirements = ({
  form,
  requiresManeuver,
  onManeuverChange,
}: ServiceRequirementsProps) => {
  return (
    <motion.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.5 }}
      className="space-y-4"
    >
      <div className="flex items-center gap-2 text-lg font-semibold text-gray-700">
        <Wrench className="w-5 h-5 text-primary animate-spin-slow" />
        <h2>Requerimientos del Servicio</h2>
      </div>

      <FormField
        control={form.control}
        name="issueDescription"
        render={({ field }) => (
          <FormItem>
            <FormLabel className="text-gray-700 font-medium">
              Descripción del Problema
            </FormLabel>
            <FormControl>
              <Textarea
                {...field}
                value={field.value || ''}
                placeholder="Por favor, proporcione información detallada sobre el problema de su vehículo."
                className="bg-white/80 border-gray-300 focus:ring-2 ring-primary/20 min-h-[120px] text-gray-800 resize-none"
              />
            </FormControl>
            <FormMessage className="text-sm text-red-500 mt-1" />
          </FormItem>
        )}
      />
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\TowTruckSelector.tsx
import { useEffect } from 'react'
import {
  FormField,
  FormItem,
  FormLabel,
  FormControl,
} from '@/components/ui/form'
import { RadioGroup, RadioGroupItem } from '@/components/ui/radio-group'
import { towTruckTypes, getTruckTypeForVehicle } from '@/utils/towTruckPricing'
import { Truck, AlertTriangle } from 'lucide-react'
import { UseFormReturn } from 'react-hook-form'
import { FormData } from '@/types/form'
import { motion } from 'framer-motion'
import { useTowing } from '@/contexts/TowingContext'
import { useToast } from '@/hooks/use-toast'

interface TowTruckSelectorProps {
  form: UseFormReturn<FormData>
  onTruckTypeChange?: (type: 'A' | 'B' | 'C' | 'D') => void
  onTollFeesChange?: (fees: number) => void
  selectedModel: string
}

export const TowTruckSelector = ({
  form,
  onTruckTypeChange,
  onTollFeesChange,
  selectedModel,
}: TowTruckSelectorProps) => {
  const { updateTruckType } = useTowing()
  const { toast } = useToast()

  useEffect(() => {
    if (selectedModel) {
      const recommendedType = getTruckTypeForVehicle(selectedModel)
      form.setValue('truckType', recommendedType)
      onTruckTypeChange?.(recommendedType)
      updateTruckType(recommendedType)

      const truckInfo = towTruckTypes[recommendedType]
      toast({
        title: 'Tipo de grúa recomendado',
        description: `Se ha seleccionado ${truckInfo.name} para ${selectedModel} (capacidad: ${truckInfo.maxWeight.toLocaleString()} kg)`,
        duration: 5000,
      })
    }
  }, [selectedModel, form, onTruckTypeChange, updateTruckType])

  return (
    <motion.div
      initial={{ opacity: 0, y: 10 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.3 }}
      className="space-y-4"
    >
      <FormField
        control={form.control}
        name="truckType"
        render={({ field }) => (
          <FormItem>
            <FormLabel className="text-lg font-semibold flex items-center gap-2">
              <Truck className="w-5 h-5 text-primary" />
              Tipo de Grúa
            </FormLabel>
            <FormControl>
              <RadioGroup
                onValueChange={(value) => {
                  const truckType = value as 'A' | 'B' | 'C' | 'D'
                  field.onChange(truckType)
                  onTruckTypeChange?.(truckType)
                  updateTruckType(truckType)

                  const selectedTruckInfo = towTruckTypes[truckType]
                  toast({
                    title: `${selectedTruckInfo.name} seleccionada`,
                    description: `Capacidad máxima: ${selectedTruckInfo.maxWeight.toLocaleString()} kg - Tarifa: ${selectedTruckInfo.perKm.toFixed(2)} MXN/km`,
                  })
                }}
                value={field.value}
                className="flex flex-col space-y-3"
              >
                {Object.entries(towTruckTypes).map(([key, type]) => (
                  <motion.div
                    key={key}
                    initial={{ opacity: 0, x: -10 }}
                    animate={{ opacity: 1, x: 0 }}
                    transition={{
                      duration: 0.2,
                      delay: Number(key.charCodeAt(0) - 65) * 0.1,
                    }}
                    className="flex items-center space-x-3 p-3 rounded-lg hover:bg-primary/5 transition-colors"
                  >
                    <RadioGroupItem
                      value={key}
                      id={key}
                      className="border-primary"
                    />
                    <div className="flex items-center gap-2">
                      <Truck
                        className={`w-5 h-5 ${key === 'D' ? 'text-orange-500' : 'text-primary'}`}
                      />
                      <span className="font-medium">
                        {type.name} (hasta {type.maxWeight.toLocaleString()}kg)
                      </span>
                    </div>
                  </motion.div>
                ))}
              </RadioGroup>
            </FormControl>
          </FormItem>
        )}
      />
      <div className="flex items-center gap-2 p-3 bg-yellow-50/50 rounded-lg text-sm text-yellow-700">
        <AlertTriangle className="w-4 h-4" />
        <p>
          El tipo de grúa se recomienda según el modelo del vehículo
          seleccionado
        </p>
      </div>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\UserInfoFields.tsx
import {
  FormField,
  FormItem,
  FormLabel,
  FormControl,
} from '@/components/ui/form'
import { Input } from '@/components/ui/input'
import { UseFormReturn } from 'react-hook-form'
import { FormData } from '@/types/form'

interface UserInfoFieldsProps {
  form: UseFormReturn<FormData>
}

export const UserInfoFields = ({ form }: UserInfoFieldsProps) => {
  return (
    <div className="space-y-6">
      <FormField
        control={form.control}
        name="userName"
        render={({ field }) => (
          <FormItem>
            <FormLabel>User Name</FormLabel>
            <FormControl>
              <Input {...field} placeholder="Enter your name" />
            </FormControl>
          </FormItem>
        )}
      />

      <FormField
        control={form.control}
        name="phone"
        render={({ field }) => (
          <FormItem>
            <FormLabel>Phone Number</FormLabel>
            <FormControl>
              <Input
                {...field}
                type="tel"
                placeholder="Enter your phone number"
              />
            </FormControl>
          </FormItem>
        )}
      />
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\VehicleBasicFields.tsx
import {
  FormField,
  FormItem,
  FormLabel,
  FormControl,
} from '@/components/ui/form'
import { Input } from '@/components/ui/input'
import { UseFormReturn } from 'react-hook-form'
import { FormData } from '@/types/form'
import { VehicleDetails } from './VehicleDetails'

interface VehicleBasicFieldsProps {
  form: UseFormReturn<FormData>
  onVehicleModelChange: (value: string) => void
}

export const VehicleBasicFields = ({
  form,
  onVehicleModelChange,
}: VehicleBasicFieldsProps) => {
  return (
    <div className="space-y-6">
      <VehicleDetails
        onBrandChange={(brand) => {
          form.setValue('vehicleMake', brand)
        }}
        onModelChange={(model) => {
          form.setValue('vehicleModel', model)
          onVehicleModelChange(model)
        }}
        onYearChange={(year) => {
          form.setValue('vehicleYear', year)
        }}
        onColorChange={(color) => {
          form.setValue('vehicleColor', color)
        }}
      />
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\VehicleDetails.tsx
import { UseFormReturn } from 'react-hook-form'
import { FormData } from '@/types/form'
import {
  FormField,
  FormItem,
  FormLabel,
  FormControl,
} from '@/components/ui/form'
import { Input } from '@/components/ui/input'

interface VehicleDetailsProps {
  onBrandChange: (brand: string) => void
  onModelChange: (model: string) => void
  onYearChange: (year: string) => void
  onColorChange: (color: string) => void
}

export const VehicleDetails = ({
  onBrandChange,
  onModelChange,
  onYearChange,
  onColorChange,
}: VehicleDetailsProps) => {
  return (
    <div className="space-y-4">
      <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <div>
          <label className="text-sm font-medium">Marca del Vehículo</label>
          <Input
            placeholder="Ej: Toyota"
            onChange={(e) => onBrandChange(e.target.value)}
            className="mt-1"
          />
        </div>
        <div>
          <label className="text-sm font-medium">Modelo</label>
          <Input
            placeholder="Ej: Corolla"
            onChange={(e) => onModelChange(e.target.value)}
            className="mt-1"
          />
        </div>
      </div>
      <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <div>
          <label className="text-sm font-medium">Año</label>
          <Input
            placeholder="Ej: 2020"
            onChange={(e) => onYearChange(e.target.value)}
            className="mt-1"
          />
        </div>
        <div>
          <label className="text-sm font-medium">Color</label>
          <Input
            placeholder="Ej: Rojo"
            onChange={(e) => onColorChange(e.target.value)}
            className="mt-1"
          />
        </div>
      </div>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\VehicleFormActions.tsx
import { Button } from '@/components/ui/button'
import { CopyButton } from '@/components/ui/copy-button'
import { Download, CreditCard } from 'lucide-react'

interface VehicleFormActionsProps {
  onDownload: (format: 'csv' | 'txt') => Promise<void>
  onCopy: () => void
  onSubmit: () => void
  isPending: boolean
  formData: string
}

export const VehicleFormActions = ({
  onDownload,
  onCopy,
  onSubmit,
  isPending,
  formData,
}: VehicleFormActionsProps) => {
  return (
    <div className="flex flex-wrap gap-4">
      <Button
        type="button"
        variant="outline"
        onClick={() => onDownload('csv')}
        className="flex-1 bg-gradient-to-r from-emerald-50 to-teal-50"
      >
        <Download className="w-4 h-4 mr-2" />
        CSV
      </Button>
      <Button
        type="button"
        variant="outline"
        onClick={() => onDownload('txt')}
        className="flex-1 bg-gradient-to-r from-blue-50 to-indigo-50"
      >
        <Download className="w-4 h-4 mr-2" />
        TXT
      </Button>
      <CopyButton
        text={formData}
        onCopy={onCopy}
        className="flex-1 bg-white hover:bg-gray-50"
      />
      <Button
        type="submit"
        disabled={isPending}
        onClick={onSubmit}
        className="flex-1 bg-gradient-to-r from-blue-600 to-indigo-600"
      >
        {isPending ? (
          <span className="flex items-center gap-2">
            <div className="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin" />
            Procesando...
          </span>
        ) : (
          <span className="flex items-center gap-2">
            <CreditCard className="h-4 w-4" />
            Continuar al Pago
          </span>
        )}
      </Button>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\VehicleFormCopyButton.tsx
import { UseFormReturn } from 'react-hook-form'
import { FormData } from '@/types/form'
import { useState } from 'react'
import { useToast } from '@/hooks/use-toast'
import { useTowing } from '@/contexts/TowingContext'
import { EnhancedFormActions } from './EnhancedFormActions'

interface VehicleFormCopyButtonProps {
  form: UseFormReturn<FormData>
  pickupAddress?: string
  dropAddress?: string
  pickupLocation?: { lat: number; lng: number } | null
  dropLocation?: { lat: number; lng: number } | null
  isPending: boolean
}

export const VehicleFormCopyButton = ({
  form,
  pickupAddress,
  dropAddress,
  pickupLocation,
  dropLocation,
  isPending,
}: VehicleFormCopyButtonProps) => {
  const [isCopied, setIsCopied] = useState(false)
  const { toast } = useToast()
  const { tollInfo } = useTowing()

  const handleCopyInfo = () => {
    const formData = form.getValues()
    const info = `
📋 DETALLES DEL SERVICIO DE GRÚA
══════════════════════════════

👤 INFORMACIÓN DEL CLIENTE
------------------------
• Nombre: ${formData.userName}
• Teléfono: ${formData.phone}

🚗 DETALLES DEL VEHÍCULO
------------------------
• Marca: ${formData.vehicleMake}
• Modelo: ${formData.vehicleModel}
• Año: ${formData.vehicleYear}
• Color: ${formData.vehicleColor}

📍 UBICACIONES
------------------------
• Punto de Recogida: ${pickupAddress || 'No especificado'}
  Coordenadas: ${pickupLocation ? `${pickupLocation.lat}, ${pickupLocation.lng}` : 'No especificado'}

• Punto de Entrega: ${dropAddress || 'No especificado'}
  Coordenadas: ${dropLocation ? `${dropLocation.lat}, ${dropLocation.lng}` : 'No especificado'}

🔧 DETALLES DEL SERVICIO
------------------------
• Tipo de Grúa: ${formData.truckType}
• Descripción del Problema:
${formData.issueDescription || 'No especificado'}

💰 INFORMACIÓN DE COSTOS
------------------------
• Peajes en Ruta: ${tollInfo?.totalTollCost ? `$${tollInfo.totalTollCost}` : 'No hay peajes'}
• Cantidad de Peajes: ${tollInfo?.tolls?.length || 0}

Generado automáticamente - ${new Date().toLocaleString()}
    `

    navigator.clipboard.writeText(info).then(() => {
      setIsCopied(true)
      toast({
        title: 'Información Copiada',
        description:
          'Los detalles del servicio han sido copiados al portapapeles',
      })
      setTimeout(() => setIsCopied(false), 2000)
    })
  }

  return (
    <EnhancedFormActions
      onCopy={handleCopyInfo}
      isCopied={isCopied}
      isPending={isPending}
    />
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\VehicleFormFields.tsx
import { UseFormReturn } from 'react-hook-form'
import { FormData } from '@/types/form'
import { Card } from '@/components/ui/card'
import { motion } from 'framer-motion'
import { UserInfoFields } from './UserInfoFields'
import { VehicleBasicFields } from './VehicleBasicFields'
import { ManeuverField } from './ManeuverField'
import { TowTruckSelector } from './TowTruckSelector'

interface VehicleFormFieldsProps {
  form: UseFormReturn<FormData>
  onVehicleModelChange: (value: string) => void
  onTruckTypeChange: (value: 'A' | 'B' | 'C' | 'D') => void
}

export const VehicleFormFields = ({
  form,
  onVehicleModelChange,
  onTruckTypeChange,
}: VehicleFormFieldsProps) => {
  return (
    <>
      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.5, delay: 0.2 }}
      >
        <Card className="p-6 bg-gradient-to-br from-white/95 to-blue-50/30 shadow-lg hover:shadow-xl transition-all duration-300">
          <div className="space-y-6">
            <UserInfoFields form={form} />
            <VehicleBasicFields
              form={form}
              onVehicleModelChange={onVehicleModelChange}
            />
            <ManeuverField form={form} />
          </div>
        </Card>
      </motion.div>

      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.5, delay: 0.4 }}
      >
        <Card className="p-6 bg-gradient-to-br from-white/95 to-blue-50/30 shadow-lg hover:shadow-xl transition-all duration-300">
          <TowTruckSelector
            form={form}
            selectedModel={form.watch('vehicleModel')}
            onTruckTypeChange={onTruckTypeChange}
          />
        </Card>
      </motion.div>
    </>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\VehicleFormHeader.tsx
import { motion } from 'framer-motion'

export const VehicleFormHeader = () => {
  return (
    <motion.div
      className="mb-6"
      initial={{ opacity: 0, y: -20 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.5 }}
    >
      <h2 className="text-2xl font-semibold text-gray-800 mb-2">
        Información del Servicio
      </h2>
      <p className="text-gray-600">
        Complete los detalles del vehículo y servicio requerido
      </p>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\form\VehicleSelector.tsx
import {
  FormField,
  FormItem,
  FormLabel,
  FormControl,
} from '@/components/ui/form'
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from '@/components/ui/select'
import { Car } from 'lucide-react'
import { UseFormReturn } from 'react-hook-form'
import { FormData } from '@/types/form'
import { motion } from 'framer-motion'

export interface VehicleSelectorProps {
  form: UseFormReturn<FormData>
  onVehicleModelChange: (value: string) => void
}

export const VehicleSelector = ({
  form,
  onVehicleModelChange,
}: VehicleSelectorProps) => {
  const vehicles = [
    { value: 'sedan', label: 'Sedán' },
    { value: 'suv', label: 'SUV' },
    { value: 'pickup', label: 'Pickup' },
    { value: 'van', label: 'Van' },
    { value: 'truck', label: 'Camión' },
  ]

  return (
    <motion.div
      initial={{ opacity: 0, y: 10 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.3 }}
      className="space-y-4"
    >
      <FormField
        control={form.control}
        name="vehicleModel"
        render={({ field }) => (
          <FormItem>
            <FormLabel className="text-lg font-semibold flex items-center gap-2">
              <Car className="w-5 h-5 text-primary" />
              Tipo de Vehículo
            </FormLabel>
            <FormControl>
              <Select
                onValueChange={(value) => {
                  field.onChange(value)
                  onVehicleModelChange(value)
                }}
                defaultValue={field.value}
              >
                <SelectTrigger className="w-full">
                  <SelectValue placeholder="Selecciona el tipo de vehículo" />
                </SelectTrigger>
                <SelectContent>
                  {vehicles.map((vehicle) => (
                    <SelectItem key={vehicle.value} value={vehicle.value}>
                      {vehicle.label}
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </FormControl>
          </FormItem>
        )}
      />
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\landing\Header.tsx
import React from 'react'
import { Navigation } from './Navigation'
import { Button } from '../ui/button'
import { Phone, MapIcon } from 'lucide-react'
import { useNavigate } from 'react-router-dom'

export const Header = (): JSX.Element => {
  const navigate = useNavigate()

  return (
    <header className="fixed top-0 w-full bg-white/80 backdrop-blur-sm dark:bg-gray-900/80 border-b border-gray-200 dark:border-gray-800 z-50 transition-all duration-300">
      <div className="container mx-auto px-4 py-3 flex items-center justify-between">
        <div className="flex-shrink-0">
          <h1 className="text-2xl md:text-3xl font-heading font-bold bg-gradient-to-r from-primary via-secondary to-primary bg-clip-text text-transparent">
            <a href="#intro" className="hover:opacity-80 transition-opacity">
              M.R. Grúas
            </a>
          </h1>
        </div>

        <Navigation />

        <div className="hidden md:flex items-center gap-3">
          <Button
            variant="outline"
            size="sm"
            onClick={() => navigate('/map')}
            className="group"
          >
            <MapIcon className="mr-2 h-4 w-4 group-hover:rotate-12 transition-transform" />
            Solicitar Servicio
          </Button>

          <Button
            variant="default"
            size="sm"
            className="animate-pulse hover:animate-none group"
            onClick={() => (window.location.href = 'tel:+5218180107110')}
          >
            <Phone className="mr-2 h-4 w-4 group-hover:rotate-12 transition-transform" />
            Llámanos
          </Button>
        </div>
      </div>
    </header>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\landing\Hero.tsx
import { motion } from 'framer-motion'
import { MapIcon } from 'lucide-react'
import { Button } from '../ui/button'
import { useNavigate } from 'react-router-dom'

export const Hero = () => {
  const navigate = useNavigate()

  return (
    <section className="relative min-h-[80vh] flex items-center justify-center overflow-hidden">
      <div className="absolute inset-0 z-0">
        <motion.img
          initial={{ scale: 1.1 }}
          animate={{ scale: 1 }}
          transition={{ duration: 0.7 }}
          src="https://mrgruas.imgix.net/call-to-action-bg.png"
          alt="Hero background"
          className="w-full h-full object-cover brightness-50"
        />
        <div className="absolute inset-0 bg-gradient-to-r from-black/70 to-black/50" />
      </div>

      <div className="relative z-10 container mx-auto px-4 text-center text-white">
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.2 }}
          className="space-y-6"
        >
          <h1 className="text-4xl md:text-6xl font-bold font-heading">
            Servicio de Grúas Profesional
          </h1>
          <p className="text-xl md:text-2xl text-gray-200 max-w-2xl mx-auto">
            Asistencia vehicular 24/7 en toda la región
          </p>
          <div className="flex flex-col sm:flex-row gap-4 justify-center">
            <Button
              size="lg"
              className="bg-primary hover:bg-primary/90 text-white"
              onClick={() => navigate('/map')}
            >
              <MapIcon className="mr-2 h-5 w-5" />
              Solicitar Servicio
            </Button>
            <Button
              size="lg"
              variant="outline"
              className="border-white text-white hover:bg-white hover:text-black"
              onClick={() => (window.location.href = 'tel:+5218180107110')}
            >
              Llamar Ahora
            </Button>
          </div>
        </motion.div>
      </div>
    </section>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\landing\MetaTags.tsx
import React from 'react'

export const MetaTags = (): JSX.Element => {
  return (
    <>
      <meta charSet="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />
      <title>M R Grúas</title>
      <link rel="icon" href="https://mrgruas.imgix.net/1logo.png" />
      <meta name="twitter:card" content="summary" />
      <meta
        name="twitter:title"
        content="Servicios de grúa en Autopista Monterrey - Nuevo Laredo las 24/7"
      />
      <meta name="twitter:site" content="@israelrys" />
      <meta
        name="twitter:image"
        content="https://mrgruas.imgix.net/1logo.png"
      />
      <meta name="twitter:creator" content="@israelrys" />
      <meta property="og:url" content="https://mrgruas.github.io/" />
      <meta
        property="og:title"
        content="Asistencia Vial Tel: +52 1 81 8010 7110 M.R."
      />
      <meta
        property="og:description"
        content="Servicios de grúa en Autopista Monterrey - Nuevo Laredo las 24/7"
      />
      <meta property="og:type" content="website" />
      <meta
        property="og:image"
        content="https://mrgruas.github.io/img/6.webp"
      />
      <meta property="og:image:width" content="auto" />
      <meta property="og:image:height" content="auto" />
      <meta property="og:site_name" content="M.R. Grúas" />
      <link
        rel="stylesheet"
        href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css"
      />
      <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
      />
      <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i|Montserrat:300,400,500,700"
        rel="stylesheet"
      />
      <link rel="stylesheet" href="dist/styles.css" />
      <link href="css/style.css" rel="stylesheet" />
    </>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\landing\Navigation.tsx
import React from 'react'
import { motion } from 'framer-motion'

const navItems = [
  { href: '#intro', label: 'Inicio' },
  { href: '#about', label: 'Nosotros' },
  { href: '#Servicios', label: 'Servicios' },
  { href: '#call-to-action', label: 'Llámanos' },
  { href: '#contact', label: 'Contacto' },
]

export const Navigation = (): JSX.Element => {
  return (
    <nav className="hidden md:block">
      <ul className="flex items-center space-x-8">
        {navItems.map((item, index) => (
          <motion.li
            key={item.href}
            initial={{ opacity: 0, y: -20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ delay: index * 0.1 }}
          >
            <a
              href={item.href}
              className="relative text-gray-700 dark:text-gray-300 hover:text-primary dark:hover:text-primary transition-colors py-2 px-1"
            >
              <span className="relative z-10">{item.label}</span>
              <span className="absolute bottom-0 left-0 w-full h-0.5 bg-primary transform scale-x-0 transition-transform origin-left hover:scale-x-100" />
            </a>
          </motion.li>
        ))}
      </ul>
    </nav>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\landing\Services.tsx
import React from 'react'
import { motion } from 'framer-motion'
import { Truck, Link, Warehouse, Car, Shield, Wrench, Route, BaggageClaim, BusFront } from 'lucide-react'
import { Card, CardContent, CardHeader, CardTitle } from '../ui/card'

const services = [
  { icon: Truck, title: 'Grúas de plataforma' },
  { icon: BaggageClaim, title: 'Grúas de arrastre' },
  { icon: BusFront, title: 'Grúas carga pesada' },
  { icon: Route, title: 'Arrastre' },
  { icon: Shield, title: 'Resguardo de vehículos' },
  { icon: Wrench, title: 'Servicios adicionales' },
]

export const Services = (): JSX.Element => {
  return (
    <section
      id="Servicios"
      className="py-20 bg-gradient-to-br from-gray-50 to-white dark:from-gray-900 dark:to-gray-800"
    >
      <div className="container mx-auto px-4">
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          whileInView={{ opacity: 1, y: 0 }}
          viewport={{ once: true }}
          className="text-center mb-16"
        >
          <h3 className="text-4xl font-heading font-bold bg-gradient-to-r from-primary via-secondary to-primary bg-clip-text text-transparent mb-6">
            Servicios
          </h3>
          <p className="text-gray-600 dark:text-gray-300 max-w-2xl mx-auto">
            Brindamos el mejor servicio a tiempo a un precio razonable porque
            sabemos lo importante que es su tiempo.
          </p>
        </motion.div>

        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          {services.map((service, index) => (
            <motion.div
              key={service.title}
              initial={{ opacity: 0, y: 20 }}
              whileInView={{ opacity: 1, y: 0 }}
              viewport={{ once: true }}
              transition={{ delay: index * 0.1 }}
            >
              <Card className="group hover:shadow-lg transition-all duration-300 bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm border-gray-200/50 dark:border-gray-700/50">
                <CardHeader className="text-center">
                  <div className="mx-auto mb-4 p-3 rounded-full bg-primary/10 group-hover:bg-primary/20 transition-colors">
                    <service.icon className="w-8 h-8 text-primary" />
                  </div>
                  <CardTitle className="text-xl font-heading group-hover:text-primary transition-colors">
                    {service.title}
                  </CardTitle>
                </CardHeader>
                <CardContent className="text-center text-gray-600 dark:text-gray-300">
                  <p>Servicio disponible 24/7</p>
                </CardContent>
              </Card>
            </motion.div>
          ))}
        </div>
      </div>
    </section>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\legal\PrivacyPolicy.tsx
import { Card } from '@/components/ui/card'
import { ScrollArea } from '@/components/ui/scroll-area'

export const PrivacyPolicy = () => {
  return (
    <Card className="p-6 max-w-4xl mx-auto bg-white/95 backdrop-blur-sm">
      <ScrollArea className="h-[70vh] pr-4">
        <div className="space-y-6">
          <h2 className="text-2xl font-bold text-primary">
            Aviso de Privacidad
          </h2>

          <section className="space-y-4">
            <h3 className="text-lg font-semibold">
              1. Identidad y Domicilio del Responsable
            </h3>
            <p className="text-gray-600">
              [MrGrùas], con domicilio en [ Agualeguas Km 6+100 #200 Ebano,
              65336 Sabinas Hidalgo, N.L.], es responsable del tratamiento de
              sus datos personales.
            </p>
          </section>

          <section className="space-y-4">
            <h3 className="text-lg font-semibold">
              2. Datos Personales Recopilados
            </h3>
            <p className="text-gray-600">
              Para la prestación de nuestros servicios de grúa, recopilamos los
              siguientes datos personales:
            </p>
            <ul className="list-disc pl-6 text-gray-600 space-y-2">
              <li>Nombre completo</li>
              <li>Dirección</li>
              <li>Teléfono de contacto</li>
              <li>Correo electrónico</li>
              <li>Información del vehículo (marca, modelo, año)</li>
              <li>Ubicación GPS para el servicio</li>
            </ul>
          </section>

          <section className="space-y-4">
            <h3 className="text-lg font-semibold">
              3. Finalidad del Tratamiento de los Datos
            </h3>
            <p className="text-gray-600">
              Sus datos personales son utilizados para:
            </p>
            <ul className="list-disc pl-6 text-gray-600 space-y-2">
              <li>Prestación del servicio de grúa solicitado</li>
              <li>Facturación y cobro</li>
              <li>Seguimiento del servicio</li>
              <li>Comunicación sobre el estado del servicio</li>
              <li>Mejora de nuestros servicios</li>
            </ul>
          </section>

          <section className="space-y-4">
            <h3 className="text-lg font-semibold">4. Transferencia de Datos</h3>
            <p className="text-gray-600">
              Sus datos personales pueden ser compartidos con:
            </p>
            <ul className="list-disc pl-6 text-gray-600 space-y-2">
              <li>Operadores de grúas para la prestación del servicio</li>
              <li>Proveedores de servicios de facturación</li>
              <li>Autoridades competentes cuando sea requerido por ley</li>
            </ul>
          </section>

          <section className="space-y-4">
            <h3 className="text-lg font-semibold">5. Derechos ARCO</h3>
            <p className="text-gray-600">
              Usted tiene derecho a conocer qué datos personales tenemos de
              usted, para qué los utilizamos y las condiciones del uso que les
              damos (Acceso). Asimismo, es su derecho solicitar la corrección de
              su información personal en caso de que esté desactualizada, sea
              inexacta o incompleta (Rectificación); que la eliminemos de
              nuestros registros o bases de datos cuando considere que la misma
              no está siendo utilizada conforme a los principios, deberes y
              obligaciones previstas en la normativa (Cancelación); así como
              oponerse al uso de sus datos personales para fines específicos
              (Oposición).
            </p>
          </section>

          <section className="space-y-4">
            <h3 className="text-lg font-semibold">6. Medidas de Seguridad</h3>
            <p className="text-gray-600">
              Implementamos diversas medidas de seguridad técnicas,
              administrativas y físicas para proteger sus datos personales,
              incluyendo encriptación de datos, acceso restringido a la
              información y políticas internas de privacidad.
            </p>
          </section>

          <section className="space-y-4">
            <h3 className="text-lg font-semibold">7. Uso de Cookies</h3>
            <p className="text-gray-600">
              Utilizamos cookies y otras tecnologías de seguimiento para mejorar
              su experiencia en nuestro sitio web, recordar sus preferencias y
              entender cómo interactúan los usuarios con nuestro servicio.
            </p>
          </section>

          <section className="space-y-4">
            <h3 className="text-lg font-semibold">
              8. Cambios al Aviso de Privacidad
            </h3>
            <p className="text-gray-600">
              Nos reservamos el derecho de efectuar en cualquier momento
              modificaciones o actualizaciones al presente aviso de privacidad.
              Cualquier modificación será notificada a través de nuestro sitio
              web.
            </p>
          </section>
        </div>
      </ScrollArea>
    </Card>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\legal\TermsAndConditions.tsx
import { Card } from '@/components/ui/card'
import { ScrollArea } from '@/components/ui/scroll-area'
import { useRef } from 'react'

export const TermsAndConditions = () => {
  const scrollRef = useRef(null)

  const scrollToTop = () => {
    if (scrollRef.current) {
      scrollRef.current.scrollTo({ top: 0, behavior: 'smooth' })
    }
  }

  const scrollToSection = (sectionId) => {
    const section = document.getElementById(sectionId)
    if (section) {
      section.scrollIntoView({ behavior: 'smooth' })
    }
  }

  return (
    <Card className="p-6 max-w-4xl mx-auto bg-white/95 backdrop-blur-sm shadow-lg rounded-lg">
      <ScrollArea ref={scrollRef} className="h-[70vh] pr-4">
        <div className="space-y-6">
          {/* Navigation Links */}
          <nav className="space-y-2 mb-4">
            <p className="font-semibold text-gray-700">Ir a:</p>
            <ul className="list-disc pl-6 text-blue-600 space-y-1">
              <li>
                <button
                  onClick={() => scrollToSection('acceptance')}
                  className="underline"
                >
                  1. Aceptación de los Términos
                </button>
              </li>
              <li>
                <button
                  onClick={() => scrollToSection('special-maneuvers')}
                  className="underline"
                >
                  2. Maniobras Especiales y Cargos Adicionales
                </button>
              </li>
              <li>
                <button
                  onClick={() => scrollToSection('cancellation')}
                  className="underline"
                >
                  3. Política de Cancelación y Reembolsos
                </button>
              </li>
              <li>
                <button
                  onClick={() => scrollToSection('client-responsibilities')}
                  className="underline"
                >
                  4. Responsabilidades del Cliente
                </button>
              </li>
              <li>
                <button
                  onClick={() => scrollToSection('liability')}
                  className="underline"
                >
                  5. Limitación de Responsabilidad
                </button>
              </li>
              <li>
                <button
                  onClick={() => scrollToSection('modifications')}
                  className="underline"
                >
                  6. Modificaciones
                </button>
              </li>
              <li>
                <button
                  onClick={() => scrollToSection('applicable-law')}
                  className="underline"
                >
                  7. Ley Aplicable
                </button>
              </li>
            </ul>
          </nav>

          <h2 className="text-2xl font-bold text-primary" id="title">
            Términos y Condiciones del Servicio
          </h2>

          {/* Section 1 */}
          <section
            className="space-y-4"
            aria-labelledby="acceptance"
            id="acceptance"
          >
            <h3 className="text-lg font-semibold">
              1. Aceptación de los Términos
            </h3>
            <p className="text-gray-600">
              Al utilizar nuestros servicios de grúa, usted acepta estos
              términos y condiciones en su totalidad. Si no está de acuerdo con
              estos términos, por favor no utilice nuestros servicios.
            </p>
          </section>

          {/* Section 2 */}
          <section
            className="space-y-4 bg-yellow-50/50 p-4 rounded-lg border border-yellow-200"
            aria-labelledby="special-maneuvers"
            id="special-maneuvers"
          >
            <h3 className="text-lg font-semibold text-yellow-800">
              2. Maniobras Especiales y Cargos Adicionales
            </h3>
            <div className="space-y-2 text-gray-700">
              <p>
                <strong>2.1.</strong> El cliente tiene la obligación de informar
                correctamente sobre la necesidad de maniobras especiales al
                momento de solicitar el servicio.
              </p>
              <p>
                <strong>2.2.</strong> En caso de que el cliente no haya
                declarado la necesidad de maniobras especiales al momento de la
                solicitud:
              </p>
              <ul className="list-disc pl-6 space-y-2">
                <li>
                  La empresa se reserva el derecho de cobrar el cargo adicional
                  por maniobra en el lugar del servicio.
                </li>
                <li>
                  El cargo por maniobra especial deberá ser liquidado en su
                  totalidad antes de realizar el servicio.
                </li>
                <li>
                  El cliente acepta que este cargo adicional es independiente
                  del monto inicial cotizado.
                </li>
              </ul>
            </div>
          </section>

          {/* Section 3 */}
          <section
            className="space-y-4 bg-red-50/50 p-4 rounded-lg border border-red-200"
            aria-labelledby="cancellation"
            id="cancellation"
          >
            <h3 className="text-lg font-semibold text-red-800">
              3. Política de Cancelación y Reembolsos
            </h3>
            <div className="space-y-2 text-gray-700">
              <p>
                <strong>3.1.</strong> Una vez realizado el pago del servicio:
              </p>
              <ul className="list-disc pl-6 space-y-2">
                <li>
                  No se realizarán reembolsos por cancelación del servicio.
                </li>
                <li>El monto pagado no es transferible a otros servicios.</li>
                <li>
                  La empresa no está obligada a reprogramar el servicio sin
                  costo adicional.
                </li>
              </ul>
              <p>
                <strong>3.2.</strong> Esta política aplica tanto al cargo base
                como a cualquier cargo adicional por maniobras especiales.
              </p>
            </div>
          </section>

          {/* Section 4 */}
          <section
            className="space-y-4"
            aria-labelledby="client-responsibilities"
            id="client-responsibilities"
          >
            <h3 className="text-lg font-semibold">
              4. Responsabilidades del Cliente
            </h3>
            <div className="space-y-2 text-gray-600">
              <p>El cliente se compromete a:</p>
              <ul className="list-disc pl-6 space-y-2">
                <li>
                  Proporcionar información precisa sobre la ubicación y estado
                  del vehículo.
                </li>
                <li>
                  Informar sobre cualquier condición especial que pueda requerir
                  maniobras adicionales.
                </li>
                <li>
                  Estar presente durante el servicio o designar un representante
                  autorizado.
                </li>
                <li>
                  Realizar el pago acordado según los términos establecidos.
                </li>
              </ul>
            </div>
          </section>

          {/* Section 5 */}
          <section
            className="space-y-4"
            aria-labelledby="liability"
            id="liability"
          >
            <h3 className="text-lg font-semibold">
              5. Limitación de Responsabilidad
            </h3>
            <p className="text-gray-600">
              La empresa no se hace responsable por:
            </p>
            <ul className="list-disc pl-6 text-gray-600 space-y-2">
              <li>Daños preexistentes en el vehículo.</li>
              <li>
                Retrasos causados por condiciones fuera de nuestro control.
              </li>
              <li>
                Costos adicionales derivados de información incorrecta
                proporcionada por el cliente.
              </li>
            </ul>
          </section>

          {/* Section 6 */}
          <section
            className="space-y-4"
            aria-labelledby="modifications"
            id="modifications"
          >
            <h3 className="text-lg font-semibold">6. Modificaciones</h3>
            <p className="text-gray-600">
              Nos reservamos el derecho de modificar estos términos y
              condiciones en cualquier momento. Los cambios entrarán en vigor
              inmediatamente después de su publicación.
            </p>
          </section>

          {/* Section 7 */}
          <section
            className="space-y-4"
            aria-labelledby="applicable-law"
            id="applicable-law"
          >
            <h3 className="text-lg font-semibold">7. Ley Aplicable</h3>
            <p className="text-gray-600">
              Estos términos y condiciones se rigen por las leyes de México.
              Cualquier disputa será resuelta en los tribunales competentes de
              la jurisdicción correspondiente.
            </p>
          </section>
        </div>
      </ScrollArea>

      {/* Back to Top Button */}
      <button
        onClick={scrollToTop}
        className="fixed bottom-6 right-6 bg-primary text-white p-3 rounded-full shadow-md hover:bg-primary-dark"
        aria-label="Scroll back to top"
      >
        ↑
      </button>
    </Card>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\BorderControls.tsx
import { useMap } from 'react-leaflet'

export const BorderControls = () => {
  const map = useMap()

  return (
    <div className="absolute inset-0 pointer-events-none">
      <button
        className="absolute top-0 left-0 w-full h-12 opacity-0 cursor-n-resize pointer-events-auto touch-pan-up"
        onClick={() => map?.panBy([0, -50])}
      />
      <button
        className="absolute bottom-0 left-0 w-full h-12 opacity-0 cursor-s-resize pointer-events-auto touch-pan-down"
        onClick={() => map?.panBy([0, 50])}
      />
      <button
        className="absolute top-0 left-0 h-full w-12 opacity-0 cursor-w-resize pointer-events-auto touch-pan-left"
        onClick={() => map?.panBy([-50, 0])}
      />
      <button
        className="absolute top-0 right-0 h-full w-12 opacity-0 cursor-e-resize pointer-events-auto touch-pan-right"
        onClick={() => map?.panBy([50, 0])}
      />
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\CostDetailsContent.tsx
import { motion } from 'framer-motion'
import { formatCurrency } from '@/utils/priceCalculator'
import { ScrollArea } from '@/components/ui/scroll-area'
import { TollInfoDisplay } from '@/components/TollInfoDisplay'

interface CostDetailsContentProps {
  totalDistance: number
  baseCost: number
  flagDropFee: number
  maneuverCost: number
  requiresManeuver: boolean
  totalTollCost: number
  detectedTolls: any[]
}

export const CostDetailsContent = ({
  totalDistance,
  baseCost,
  flagDropFee,
  maneuverCost,
  requiresManeuver,
  totalTollCost,
  detectedTolls,
}: CostDetailsContentProps) => {
  return (
    <ScrollArea className="h-[calc(100vh-300px)] pr-4">
      <div className="space-y-3">
        <motion.div
          initial={{ opacity: 0, x: -20 }}
          animate={{ opacity: 1, x: 0 }}
          className="p-3 bg-primary/5 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"
        >
          <div className="flex justify-between items-center">
            <span className="text-sm text-gray-700">
              Distancia ({totalDistance.toFixed(1)} km):
            </span>
            <span className="font-medium text-primary">
              {formatCurrency(baseCost)}
            </span>
          </div>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, x: -20 }}
          animate={{ opacity: 1, x: 0 }}
          transition={{ delay: 0.1 }}
          className="p-3 bg-primary/5 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"
        >
          <div className="flex justify-between items-center">
            <span className="text-sm text-gray-700">Banderazo:</span>
            <span className="font-medium text-primary">
              {formatCurrency(flagDropFee)}
            </span>
          </div>
        </motion.div>

        {requiresManeuver && (
          <motion.div
            initial={{ opacity: 0, x: -20 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ delay: 0.2 }}
            className="p-3 bg-orange-50 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"
          >
            <div className="flex justify-between items-center">
              <span className="text-sm text-orange-700">Maniobra:</span>
              <span className="font-medium text-orange-600">
                {formatCurrency(maneuverCost)}
              </span>
            </div>
          </motion.div>
        )}

        {totalTollCost > 0 && (
          <motion.div
            initial={{ opacity: 0, x: -20 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ delay: 0.3 }}
            className="p-3 bg-yellow-50 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"
          >
            <div className="flex justify-between items-center">
              <span className="text-sm text-yellow-700">Peajes:</span>
              <span className="font-medium text-yellow-600">
                {formatCurrency(totalTollCost)}
              </span>
            </div>
          </motion.div>
        )}
      </div>

      {detectedTolls.length > 0 && (
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.4 }}
          className="mt-6"
        >
          <TollInfoDisplay tolls={detectedTolls} totalCost={totalTollCost} />
        </motion.div>
      )}
    </ScrollArea>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\DraggableMarker.tsx
import L from 'leaflet'
import { Marker, Popup } from 'react-leaflet'
import { useEffect, useRef } from 'react'

interface DraggableMarkerProps {
  position: L.LatLngExpression
  onDragEnd: (latlng: L.LatLng) => void
  icon?: L.Icon
  label: string
  draggable?: boolean
}

export const DraggableMarker = ({
  position,
  onDragEnd,
  icon,
  label,
  draggable = true,
}: DraggableMarkerProps) => {
  const markerRef = useRef<L.Marker>(null)

  useEffect(() => {
    if (markerRef.current) {
      markerRef.current.setLatLng(position as L.LatLng)
    }
  }, [position])

  const handleDragEnd = (e: L.DragEndEvent) => {
    const marker = e.target
    onDragEnd(marker.getLatLng())
  }

  return (
    <Marker
      position={position}
      draggable={draggable}
      icon={icon}
      eventHandlers={{
        dragend: handleDragEnd,
      }}
      ref={markerRef}
    >
      <Popup>
        <div className="font-semibold">{label}</div>
      </Popup>
    </Marker>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\FloatingPanel.ts
import { ReactNode, useState, useCallback } from "react"
import { cn } from "@/lib/utils"
import { Menu, Maximize2 } from "lucide-react"
import { Button } from "@/components/ui/button"
import { Sheet, SheetContent, SheetTrigger } from "@/components/ui/sheet"
import { useToast } from "@/hooks/use-toast"
import { motion, AnimatePresence } from "framer-motion"
import Draggable from "react-draggable"
import { useSidebar } from "@/contexts/SidebarContext"
import { RouteDisplay } from "./RouteDisplay"
import { CostEstimation } from "../CostEstimation"
import { FloatingPanelHeader } from "./FloatingPanelHeader"
import { FloatingPanelControls } from "./FloatingPanelControls"
import { ScrollArea } from "@/components/ui/scroll-area"

interface FloatingPanelProps {
    children: ReactNode
    className?: string
    position?: "left" | "right" | "top" | "bottom"
    title?: string
}

export const FloatingPanel = ({
    children,
    className,
    position = "right",
    title = "Panel",
}: FloatingPanelProps) => {
    const [isCollapsed, setIsCollapsed] = useState(false)
    const [isVisible, setIsVisible] = useState(true)
    const [isDragging, setIsDragging] = useState(false)
    const [isMaximized, setIsMaximized] = useState(false)
    const [isMobileOpen, setIsMobileOpen] = useState(false)

    const { isOpen: isDesktopSidebarVisible } = useSidebar()
    const { toast } = useToast()

    // Helpers for state toggling
    const toggleCollapsed = () => setIsCollapsed(!isCollapsed)
    const toggleMaximized = () => setIsMaximized(!isMaximized)
    const resetPanelState = () => {
        setIsCollapsed(false)
        setIsMaximized(false)
        setIsDragging(false)
    }

    const handleDragStart = useCallback(() => {
        setIsDragging(true)
        toast({
            title: "Panel móvil",
            description: "Puedes mover este panel a cualquier parte de la pantalla",
            duration: 2000,
        })
    }, [toast])

    const handleDragStop = useCallback(() => setIsDragging(false), [])

    const handlePanelClose = () => {
        setIsVisible(false)
        toast({
            title: "Panel oculto",
            description: "Haz clic en 'Mostrar Panel' para restaurar",
            duration: 2000,
        })
    }

    const panelContent = (
        <motion.div
            className= "flex flex-col h-full"
    initial = {{ opacity: 0, y: 20 }
}
animate = {{ opacity: 1, y: 0 }}
transition = {{ duration: 0.5 }}
        >
    <FloatingPanelHeader />
    < ScrollArea className = "flex-1 px-6 py-4" >
        <div className="space-y-6" >
            { children }
            < CostEstimation />
            <RouteDisplay pickupLocation={ null } dropLocation = { null} />
                </div>
                </ScrollArea>
                </motion.div>
    )

if (!isVisible) {
    return (
        <Button
                variant= "secondary"
    size = "sm"
    onClick = {() => setIsVisible(true)
}
className = {
    cn(
                    "fixed z-[1000] bg-white/95 shadow-lg backdrop-blur-sm transition-all duration-300 hover:scale-105",
        position === "right" && "right-4 top-20",
    position === "left" && "left-4 top-20",
    position === "top" && "top-4 right-4",
    position === "bottom" && "bottom-4 right-4"
                )}
            >
    <Maximize2 className="w-4 h-4 mr-2" />
        Mostrar { title }
</Button>
        )
    }

return (
    <>
    {/* Mobile View */ }
    < div className = "lg:hidden fixed top-4 left-4 z-[1000]" >
        <Sheet open={ isMobileOpen } onOpenChange = { setIsMobileOpen } >
            <SheetTrigger asChild >
            <Button
                            variant="outline"
size = "icon"
className = "bg-white/95 backdrop-blur-sm shadow-lg hover:shadow-xl transition-all"
    >
    <Menu className="h-4 w-4" />
        </Button>
        </SheetTrigger>
        < SheetContent side = "left" className = "w-80 p-0 bg-white/95 backdrop-blur-sm" >
            { panelContent }
            </SheetContent>
            </Sheet>
            </div>

{/* Desktop View */ }
{/* Desktop View */ }
<Draggable
                handle=".drag-handle"
onStart = { handleDragStart }
onStop = { handleDragStop }
bounds = "parent"
disabled = { isMaximized || isMobileOpen}
defaultPosition = {{ x: 0, y: 0 }}
cancel = ".no-drag"
    >
    <motion.div
                    initial={ { x: position === "right" ? 100 : -100 } }
animate = {{ x: 0 }}
className = {
    cn(
                        "fixed bg-white/95 rounded-lg shadow-xl backdrop-blur-sm transition-all duration-300",
                        "max-h-[80vh] overflow-hidden z-[1000] hidden lg:block",
        isMaximized
            ? "inset-4 !transform-none"
                            : cn(
                position === "right" && "right-6 top-24",
                position === "left" && "left-6 top-24",
                position === "top" && "top-6 inset-x-6",
                position === "bottom" && "bottom-6 inset-x-6"
            ),
    isDragging && "cursor-grabbing shadow-2xl scale-[1.02]",
    !isMaximized && "hover:shadow-lg hover:shadow-primary/5",
    className
                    )}
                >
    <FloatingPanelControls
                        isCollapsed={ isCollapsed }
isMaximized = { isMaximized }
isDragging = { isDragging }
onCollapse = { toggleCollapsed }
onMaximize = { toggleMaximized }
onClose = { handlePanelClose }
title = { title }
    />
    <div
                        className={
    cn(
        "transition-all duration-300",
        isCollapsed ? "h-0" : isMaximized ? "h-[calc(100vh-8rem)]" : "max-h-[calc(80vh-4rem)]",
        !isCollapsed && "animate-in fade-in-50"
    )
}
                    >
    { panelContent }
    </div>
    </motion.div>
    </Draggable>
    </>
    )
}  



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\FloatingPanelControls.tsx
import { useState } from 'react'
import { DollarSign, Info } from 'lucide-react'
import { cn } from '@/lib/utils'
import { FloatingPanelControlsProps } from './types/floating-panel'
import { useTowing } from '@/contexts/TowingContext'
import { formatCurrency } from '@/utils/priceCalculator'
import { towTruckTypes } from '@/utils/towTruckPricing'
import { motion, AnimatePresence } from 'framer-motion'
import { Card } from '@/components/ui/card'
import { FloatingPanelHeader } from './FloatingPanelHeader'
import { CostDetailsContent } from './CostDetailsContent'
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from '@/components/ui/tooltip'

export const FloatingPanelControls = ({
  isCollapsed,
  isMaximized,
  onCollapse,
  onMaximize,
  onClose,
  title,
}: FloatingPanelControlsProps) => {
  const [showCostDetails, setShowCostDetails] = useState(false)
  const {
    totalDistance,
    truckType,
    requiresManeuver,
    totalTollCost,
    detectedTolls,
  } = useTowing()
  const selectedTruck = towTruckTypes[truckType || 'A']
  const baseCost = totalDistance * selectedTruck.perKm
  const flagDropFee = selectedTruck.flagDropFee
  const maneuverCost = requiresManeuver ? selectedTruck.maneuverCharge : 0
  const subtotal = baseCost + flagDropFee + maneuverCost + totalTollCost

  console.log('FloatingPanelControls rendered:', {
    totalDistance,
    truckType,
    subtotal,
    showCostDetails,
  })

  return (
    <motion.div
      initial={{ opacity: 0, y: -20 }}
      animate={{ opacity: 1, y: 0 }}
      className={cn(
        'flex flex-col h-full',
        'bg-gradient-to-br from-white/95 via-primary/5 to-primary/10',
        'backdrop-blur-sm border-t border-primary/20',
      )}
    >
      <FloatingPanelHeader
        title={title}
        isCollapsed={isCollapsed}
        isMaximized={isMaximized}
        onCollapse={onCollapse}
        onMaximize={onMaximize}
        onClose={onClose}
      />

      {!isCollapsed && (
        <div className="flex flex-col justify-between flex-grow">
          <AnimatePresence>
            <motion.div
              initial={{ opacity: 0, height: 0 }}
              animate={{ opacity: 1, height: 'auto' }}
              exit={{ opacity: 0, height: 0 }}
              className="mt-4 space-y-4 px-4"
            >
              <Card className="p-4 bg-white/50 backdrop-blur-sm border border-primary/10 hover:shadow-lg transition-all duration-300">
                <TooltipProvider>
                  <motion.button
                    whileHover={{ scale: 1.01 }}
                    whileTap={{ scale: 0.99 }}
                    onClick={() => setShowCostDetails(!showCostDetails)}
                    className="w-full flex items-center justify-between px-4 py-3 bg-gradient-to-r from-primary/5 to-primary/10 rounded-lg hover:from-primary/10 hover:to-primary/20 transition-all duration-300"
                  >
                    <div className="flex items-center gap-2">
                      <DollarSign className="h-5 w-5 text-primary" />
                      <span className="text-primary font-medium text-lg">
                        Costo Estimado:
                      </span>
                    </div>
                    <Tooltip>
                      <TooltipTrigger asChild>
                        <div className="flex items-center gap-2">
                          <span className="font-bold text-xl text-primary">
                            {formatCurrency(subtotal)}
                          </span>
                          <Info className="h-4 w-4 text-primary/60" />
                        </div>
                      </TooltipTrigger>
                      <TooltipContent>
                        <p>Click para ver desglose de costos</p>
                      </TooltipContent>
                    </Tooltip>
                  </motion.button>
                </TooltipProvider>

                <AnimatePresence>
                  {showCostDetails && (
                    <motion.div
                      initial={{ opacity: 0, y: -10 }}
                      animate={{ opacity: 1, y: 0 }}
                      exit={{ opacity: 0, y: -10 }}
                      className="mt-4"
                    >
                      <CostDetailsContent
                        totalDistance={totalDistance}
                        baseCost={baseCost}
                        flagDropFee={flagDropFee}
                        maneuverCost={maneuverCost}
                        requiresManeuver={requiresManeuver}
                        totalTollCost={totalTollCost}
                        detectedTolls={detectedTolls}
                      />
                    </motion.div>
                  )}
                </AnimatePresence>
              </Card>
            </motion.div>
          </AnimatePresence>
        </div>
      )}
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\FloatingPanelHeader.tsx
import { Truck, MapPin, Phone } from 'lucide-react'

export const FloatingPanelHeader = () => {
  return (
    <div className="p-6 bg-gradient-to-br from-primary/10 via-primary/5 to-transparent border-b">
      <div className="flex items-center gap-3">
        <div className="p-2.5 bg-primary/10 rounded-xl shadow-inner">
          <Truck className="w-6 h-6 text-primary" />
        </div>
        <div>
          <h1 className="text-2xl font-heading font-bold bg-gradient-to-r from-primary to-blue-700 bg-clip-text text-transparent">
            MRGruas
          </h1>
          <p className="text-sm text-gray-600">Servicio Profesional 24/7</p>
        </div>
      </div>
      <div className="mt-4 flex gap-2">
        <div className="flex-1 flex items-center gap-2 bg-green-50 px-3 py-2 rounded-full border border-green-200">
          <MapPin className="w-4 h-4 text-green-600" />
          <span className="text-sm font-medium text-green-700">
            Disponible en tu área
          </span>
        </div>
        <div className="flex-1 flex items-center gap-2 bg-blue-50 px-3 py-2 rounded-full border border-blue-200">
          <Phone className="w-4 h-4 text-blue-600" />
          <span className="text-sm font-medium text-blue-700">
            Soporte 24/7
          </span>
        </div>
      </div>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\LocationMarker.tsx
import { useMapEvents } from 'react-leaflet'
import { useToast } from '@/hooks/use-toast'
import { Marker, Popup } from 'react-leaflet'
import { pickupIcon, dropIcon } from '@/utils/mapUtils'

interface LocationMarkerProps {
  onLocationSelect: (location: { lat: number; lng: number }) => void
  selectingPickup: boolean
  selectingDrop: boolean
  pickupLocation?: { lat: number; lng: number } | null
  dropLocation?: { lat: number; lng: number } | null
}

export const LocationMarker = ({
  onLocationSelect,
  selectingPickup,
  selectingDrop,
  pickupLocation,
  dropLocation,
}: LocationMarkerProps) => {
  const { toast } = useToast()

  useMapEvents({
    click(e) {
      if (selectingPickup || selectingDrop) {
        onLocationSelect(e.latlng)
        toast({
          title: `${selectingPickup ? 'Punto de Recogida' : 'Punto de Entrega'} Seleccionado`,
          description: 'La ubicación ha sido establecida en el mapa',
          duration: 3000,
        })
      }
    },
  })

  return (
    <>
      {pickupLocation && (
        <Marker
          position={[pickupLocation.lat, pickupLocation.lng]}
          icon={pickupIcon}
        >
          <Popup>Punto de Recogida</Popup>
        </Marker>
      )}
      {dropLocation && (
        <Marker position={[dropLocation.lat, dropLocation.lng]} icon={dropIcon}>
          <Popup>Punto de Entrega</Popup>
        </Marker>
      )}
    </>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\MapBottomControls.tsx
import { Button } from '@/components/ui/button'
import { Truck } from 'lucide-react'
import { cn } from '@/lib/utils'

interface MapBottomControlsProps {
  pickupLocation: { lat: number; lng: number } | null
  dropLocation: { lat: number; lng: number } | null
  onRequestTow: () => void
}

export const MapBottomControls = ({
  pickupLocation,
  dropLocation,
  onRequestTow,
}: MapBottomControlsProps) => {
  const hasLocations = pickupLocation && dropLocation

  return (
    <div className="max-w-2xl mx-auto">
      <Button
        className={cn(
          'w-full bg-gradient-to-r from-primary via-blue-600 to-primary',
          'hover:from-primary/90 hover:to-primary/90 text-white',
          'shadow-lg hover:shadow-xl transition-all duration-300',
          'py-4 sm:py-6 text-base sm:text-lg font-semibold',
          'group relative overflow-hidden',
          'active:scale-[0.98]',
          !hasLocations && 'opacity-70 cursor-not-allowed',
        )}
        onClick={onRequestTow}
        disabled={!hasLocations}
        aria-label="Request tow truck service"
      >
        <span
          className="absolute inset-0 bg-white/10 transform -skew-x-12 
                     group-hover:translate-x-full transition-transform duration-700 ease-out"
        />
        <span className="relative flex items-center justify-center gap-2">
          <Truck className="w-5 h-5 sm:w-6 sm:h-6 flex-shrink-0 animate-pulse" />
          <span className="hidden sm:inline">Solicitar Grúa</span>
          <span className="sm:hidden">Solicitar</span>
        </span>
      </Button>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\MapContainer.tsx
import { memo, useEffect, useRef, useMemo, useCallback } from 'react'
import { MapContainer, TileLayer, useMap } from 'react-leaflet'
import { DraggableMarker } from './DraggableMarker'
import { RoutePolyline } from './RoutePolyline'
import { MapLocationHandler } from './MapLocationHandler'
import { enterpriseIcon, pickupIcon, dropIcon } from '@/utils/mapUtils'
import { COMPANY_LOCATION } from '@/services/routeService'
import { Marker, Popup } from 'react-leaflet'
import { getAddressFromCoordinates } from '@/services/geocodingService'
import { LatLngTuple, LatLngBounds } from 'leaflet'
import { useToast } from '@/hooks/use-toast'

interface Location {
  lat: number
  lng: number
}

interface MapUpdaterProps {
  pickupLocation: Location | null
  dropLocation: Location | null
}

const MapUpdater = memo(({ pickupLocation, dropLocation }: MapUpdaterProps) => {
  const map = useMap()
  const { toast } = useToast()
  const lastToastTime = useRef(0)

  useEffect(() => {
    const now = Date.now()
    if (pickupLocation && dropLocation) {
      const bounds = new LatLngBounds(
        [pickupLocation.lat, pickupLocation.lng],
        [dropLocation.lat, dropLocation.lng],
      )
      map.fitBounds(bounds, { padding: [50, 50] })

      if (now - lastToastTime.current > 3000) {
        toast({
          title: 'Ruta actualizada',
          description: 'El mapa se ha ajustado para mostrar la ruta completa',
        })
        lastToastTime.current = now
      }
    } else if (pickupLocation) {
      map.setView([pickupLocation.lat, pickupLocation.lng], 15)
    } else if (dropLocation) {
      map.setView([dropLocation.lat, dropLocation.lng], 15)
    }
  }, [map, pickupLocation, dropLocation, toast])

  return null
})

MapUpdater.displayName = 'MapUpdater'

interface MapContainerComponentProps {
  pickupLocation: Location | null
  dropLocation: Location | null
  selectingPickup: boolean
  selectingDrop: boolean
  onLocationSelect: (location: Location) => void
  setPickupLocation: (location: Location | null) => void
  setDropLocation: (location: Location | null) => void
  onRouteCalculated: (distance: number) => void
  isLoading?: boolean
}

export const MapContainerComponent = memo(
  ({
    pickupLocation,
    dropLocation,
    selectingPickup,
    selectingDrop,
    onLocationSelect,
    setPickupLocation,
    setDropLocation,
    onRouteCalculated,
    isLoading = false,
  }: MapContainerComponentProps) => {
    const { toast } = useToast()
    const lastToastTime = useRef(0)

    const handleLocationSelect = useCallback(
      async (location: Location) => {
        try {
          const now = Date.now()
          const address = await getAddressFromCoordinates(
            location.lat,
            location.lng,
          )

          if (now - lastToastTime.current > 3000) {
            toast({
              title: selectingPickup
                ? 'Punto de recogida seleccionado'
                : 'Punto de entrega seleccionado',
              description: address,
              duration: 3000,
            })
            lastToastTime.current = now
          }

          onLocationSelect(location)
        } catch (error) {
          const now = Date.now()
          if (now - lastToastTime.current > 3000) {
            toast({
              title: 'Error',
              description: 'No se pudo obtener la dirección',
              variant: 'destructive',
              duration: 3000,
            })
            lastToastTime.current = now
          }
        }
      },
      [onLocationSelect, selectingPickup, toast],
    )

    const handleMarkerDragEnd = useCallback(
      async (latlng: L.LatLng, type: 'pickup' | 'drop') => {
        const location = { lat: latlng.lat, lng: latlng.lng }
        if (type === 'pickup') {
          setPickupLocation(location)
        } else {
          setDropLocation(location)
        }
        await handleLocationSelect(location)
      },
      [handleLocationSelect, setPickupLocation, setDropLocation],
    )

    const defaultPosition: LatLngTuple = [25.6866, -100.3161]

    return (
      <MapContainer
        center={defaultPosition}
        zoom={13}
        className="w-full h-full rounded-lg shadow-lg"
        zoomControl={false}
      >
        <TileLayer
          attribution='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'
          url="https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"
          className="brightness-95"
        />

        <MapLocationHandler
          selectingPickup={selectingPickup}
          selectingDrop={selectingDrop}
          handleLocationSelect={handleLocationSelect}
        />

        <MapUpdater
          pickupLocation={pickupLocation}
          dropLocation={dropLocation}
        />

        <Marker
          position={[COMPANY_LOCATION.lat, COMPANY_LOCATION.lng]}
          icon={enterpriseIcon}
        >
          <Popup className="rounded-lg shadow-lg">
            <div className="font-semibold">Empresa de Grúas</div>
            <div className="text-sm text-gray-600">Ubicación Principal</div>
          </Popup>
        </Marker>

        {pickupLocation && (
          <DraggableMarker
            position={[pickupLocation.lat, pickupLocation.lng]}
            onDragEnd={(latlng) => handleMarkerDragEnd(latlng, 'pickup')}
            icon={pickupIcon}
            label="Punto de Recogida"
            draggable={!isLoading}
          />
        )}

        {dropLocation && (
          <DraggableMarker
            position={[dropLocation.lat, dropLocation.lng]}
            onDragEnd={(latlng) => handleMarkerDragEnd(latlng, 'drop')}
            icon={dropIcon}
            label="Punto de Entrega"
            draggable={!isLoading}
          />
        )}

        {pickupLocation && dropLocation && (
          <RoutePolyline
            pickupLocation={pickupLocation}
            dropLocation={dropLocation}
            onRouteCalculated={onRouteCalculated}
          />
        )}
      </MapContainer>
    )
  },
)

MapContainerComponent.displayName = 'MapContainerComponent'



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\MapControlPanel.tsx
import { MapControls } from './MapControls'
import { RouteStreetInfo } from './RouteStreetInfo'
import { showLocationNotification } from '@/utils/notificationUtils'
import { motion, AnimatePresence } from 'framer-motion'
import { Card } from '@/components/ui/card'
import { useToast } from '@/hooks/use-toast'
import { Loader2 } from 'lucide-react'

interface MapControlPanelProps {
  selectingPickup: boolean
  selectingDrop: boolean
  setSelectingPickup: (value: boolean) => void
  setSelectingDrop: (value: boolean) => void
  pickupLocation: { lat: number; lng: number } | null
  dropLocation: { lat: number; lng: number } | null
  pickupAddress?: string
  dropAddress?: string
  isLoading?: boolean
}

export const MapControlPanel = ({
  selectingPickup,
  selectingDrop,
  setSelectingPickup,
  setSelectingDrop,
  pickupLocation,
  dropLocation,
  pickupAddress,
  dropAddress,
  isLoading = false,
}: MapControlPanelProps) => {
  const { toast } = useToast()

  return (
    <div className="px-4 sm:px-6 flex flex-col items-center gap-6 pointer-events-auto max-w-3xl mx-auto w-full">
      <motion.div
        initial={{ opacity: 0, y: -20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.3 }}
        className="w-full"
      >
        <Card className="relative w-full bg-white/95 backdrop-blur-sm shadow-lg rounded-xl p-4 sm:p-6 border-blue-100/50 hover:shadow-xl transition-all duration-300">
          {isLoading && (
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
              className="absolute inset-0 bg-white/50 backdrop-blur-sm flex items-center justify-center z-50 rounded-xl"
            >
              <Loader2 className="w-6 h-6 animate-spin text-primary" />
            </motion.div>
          )}
          <MapControls
            selectingPickup={selectingPickup}
            selectingDrop={selectingDrop}
            onPickupClick={() => {
              setSelectingPickup(true)
              setSelectingDrop(false)
              showLocationNotification('pickup', { lat: 0, lng: 0 })
              toast({
                title: 'Seleccionando punto de recogida',
                description:
                  'Haz clic en el mapa para seleccionar el punto de recogida',
              })
            }}
            onDropClick={() => {
              setSelectingDrop(true)
              setSelectingPickup(false)
              showLocationNotification('drop', { lat: 0, lng: 0 })
              toast({
                title: 'Seleccionando punto de entrega',
                description:
                  'Haz clic en el mapa para seleccionar el punto de entrega',
              })
            }}
          />
        </Card>
      </motion.div>

      <AnimatePresence>
        {(pickupLocation || dropLocation) && (
          <motion.div
            initial={{ opacity: 0, scale: 0.95 }}
            animate={{ opacity: 1, scale: 1 }}
            exit={{ opacity: 0, scale: 0.95 }}
            className="w-full"
          >
            <RouteStreetInfo
              pickupLocation={pickupLocation}
              dropLocation={dropLocation}
              pickupAddress={pickupAddress}
              dropAddress={dropAddress}
              isLoading={isLoading}
            />
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\MapControls.tsx
import { Button } from '@/components/ui/button'
import { MapPin, Navigation } from 'lucide-react'
import { cn } from '@/lib/utils'

interface MapControlsProps {
  selectingPickup: boolean
  selectingDrop: boolean
  onPickupClick: () => void
  onDropClick: () => void
}

export const MapControls = ({
  selectingPickup,
  selectingDrop,
  onPickupClick,
  onDropClick,
}: MapControlsProps) => {
  return (
    <div className="flex flex-col sm:flex-row gap-4">
      <Button
        variant={selectingPickup ? 'secondary' : 'outline'}
        onClick={onPickupClick}
        className={cn(
          'flex-1 flex items-center justify-center gap-3 h-14 text-base font-medium',
          'bg-white/95 backdrop-blur-sm border border-gray-200',
          'hover:bg-primary/10 hover:border-primary/50',
          'active:scale-[0.98] transition-all duration-200',
          'shadow-sm hover:shadow-md',
          selectingPickup && 'bg-primary/10 border-primary text-primary',
        )}
      >
        <MapPin
          className={cn(
            'w-5 h-5 transition-colors',
            selectingPickup ? 'text-primary' : 'text-gray-600',
          )}
        />
        Seleccionar Punto de Recogida
      </Button>
      <Button
        variant={selectingDrop ? 'secondary' : 'outline'}
        onClick={onDropClick}
        className={cn(
          'flex-1 flex items-center justify-center gap-3 h-14 text-base font-medium',
          'bg-white/95 backdrop-blur-sm border border-gray-200',
          'hover:bg-primary/10 hover:border-primary/50',
          'active:scale-[0.98] transition-all duration-200',
          'shadow-sm hover:shadow-md',
          selectingDrop && 'bg-primary/10 border-primary text-primary',
        )}
      >
        <Navigation
          className={cn(
            'w-5 h-5 transition-colors',
            selectingDrop ? 'text-primary' : 'text-gray-600',
          )}
        />
        Seleccionar Punto de Entrega
      </Button>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\MapHeader.tsx
import React, { useState } from 'react'
import { Truck, MapPin, Phone, Menu } from 'lucide-react'
import { Button } from '@/components/ui/button'
import { Sheet, SheetContent, SheetTrigger } from '@/components/ui/sheet'

export const MapHeader = () => {
  const [isOpen, setIsOpen] = useState(false)

  return (
    <div className="absolute inset-x-0 top-0 z-50 bg-gradient-to-r from-white/95 via-blue-50/95 to-white/95 shadow-lg backdrop-blur-sm border-b border-blue-100">
      <nav className="px-4 sm:px-6 py-4 max-w-7xl mx-auto flex items-center justify-between">
        <div className="flex items-center gap-2 sm:gap-3">
          <div className="bg-primary/10 p-2 sm:p-2.5 rounded-xl shadow-inner">
            <Truck className="w-6 h-6 sm:w-7 sm:h-7 text-primary" />
          </div>
          <div>
            <h1 className="text-xl sm:text-2xl font-bold bg-gradient-to-r from-primary to-blue-700 bg-clip-text text-transparent">
              Servicio de asistencia vial
            </h1>
            <p className="text-xs sm:text-sm text-gray-600">
              Asistencia Profesional 24/7
            </p>
          </div>
        </div>

        <div className="sm:hidden">
          <Sheet open={isOpen} onOpenChange={setIsOpen}>
            <SheetTrigger asChild>
              <Button
                variant="ghost"
                size="icon"
                className="relative z-50"
                aria-label="Open menu"
              >
                <Menu className="h-6 w-6" />
              </Button>
            </SheetTrigger>
            <SheetContent
              side="right"
              className="w-[300px] sm:w-[400px] z-[60]"
              onOpenAutoFocus={(e) => e.preventDefault()}
            >
              <div className="flex flex-col gap-4 mt-6">
                <div className="flex items-center gap-2 bg-green-50 px-4 py-3 rounded-full border border-green-200 shadow-sm">
                  <MapPin className="w-4 h-4 text-green-600" />
                  <span className="text-sm font-medium text-green-700">
                    Disponible en todo el país
                  </span>
                </div>
                <div className="flex items-center gap-2 bg-blue-50 px-4 py-3 rounded-full border border-blue-200 shadow-sm">
                  <Phone className="w-4 h-4 text-blue-600" />
                  <span className="text-sm font-medium text-blue-700">
                    Asistencia 24/7
                  </span>
                </div>
              </div>
            </SheetContent>
          </Sheet>
        </div>

        <div className="hidden sm:flex items-center gap-4">
          <div className="flex items-center gap-2 bg-green-50 px-4 py-2 rounded-full border border-green-200 shadow-sm">
            <MapPin className="w-4 h-4 text-green-600" />
            <span className="text-sm font-medium text-green-700">
              Disponible en todo el país
            </span>
          </div>
          <div className="flex items-center gap-2 bg-blue-50 px-4 py-2 rounded-full border border-blue-200 shadow-sm">
            <Phone className="w-4 h-4 text-blue-600" />
            <span className="text-sm font-medium text-blue-700">
              Asistencia 24/7
            </span>
          </div>
        </div>
      </nav>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\MapLayout.tsx
import { ReactNode } from 'react'

interface MapLayoutProps {
  children: ReactNode
}

export const MapLayout = ({ children }: MapLayoutProps) => {
  return (
    <div className="relative h-screen w-full overflow-hidden bg-gradient-to-br from-gray-50 to-gray-100">
      <div className="absolute inset-0 bg-grid-pattern opacity-5" />
      <div className="relative h-full w-full lg:pl-96 transition-all duration-300">
        {children}
      </div>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\MapLocationHandler.tsx
import { useMapEvents } from 'react-leaflet'
import { getAddressFromCoordinates } from '@/services/geocodingService'
import { useToast } from '@/hooks/use-toast'

interface MapLocationHandlerProps {
  selectingPickup: boolean
  selectingDrop: boolean
  handleLocationSelect: (location: {
    lat: number
    lng: number
    address: string
  }) => void
  currentPickupLocation?: { lat: number; lng: number } | null
}

export const MapLocationHandler = ({
  selectingPickup,
  selectingDrop,
  handleLocationSelect,
  currentPickupLocation,
}: MapLocationHandlerProps) => {
  const { toast } = useToast()

  const handleClick = async (e: L.LeafletMouseEvent) => {
    if (selectingPickup || selectingDrop) {
      try {
        const location = {
          lat: e.latlng.lat,
          lng: e.latlng.lng,
          address: await getAddressFromCoordinates(e.latlng.lat, e.latlng.lng),
        }

        handleLocationSelect(location)

        toast({
          title: selectingPickup
            ? 'Punto de recogida marcado'
            : 'Punto de entrega marcado',
          description: location.address,
        })
      } catch (error) {
        toast({
          title: 'Error',
          description:
            'No se pudo obtener la dirección de la ubicación seleccionada',
          variant: 'destructive',
        })
      }
    }
  }

  useMapEvents({
    click: handleClick,
  })

  return null
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\MapMetrics.tsx
import { MapPin, Navigation } from 'lucide-react'

interface MapMetricsProps {
  distance: number
  price: number
}

export const MapMetrics = ({ distance, price }: MapMetricsProps) => {
  return (
    <div className="flex justify-between items-center">
      <div className="flex items-center gap-2">
        <MapPin className="text-green-500" />
        <span className="font-semibold">Distance:</span> {distance.toFixed(2)}{' '}
        km
      </div>
      <div className="flex items-center gap-2">
        <Navigation className="text-primary" />
        <span className="font-semibold">Estimated Cost:</span> ${price}
      </div>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\RouteDisplay.tsx
import { Card } from '@/components/ui/card'
import { Route, Shield } from 'lucide-react'
import { useTowing } from '@/contexts/TowingContext'

interface RouteDisplayProps {
  pickupLocation: { lat: number; lng: number } | null
  dropLocation: { lat: number; lng: number } | null
}

export const RouteDisplay = ({
  pickupLocation,
  dropLocation,
}: RouteDisplayProps) => {
  const { totalDistance } = useTowing()

  if (!pickupLocation || !dropLocation) return null

  return (
    <Card className="p-4 space-y-4 bg-gradient-to-br from-white/95 via-blue-50/95 to-white/95 backdrop-blur-md shadow-xl border border-blue-100/50">
      <div className="flex items-center gap-3 py-2">
        <Route className="w-4 h-4 text-gray-500" />
        <div>
          <p className="text-xs font-medium text-gray-900">Total Distance</p>
          <p className="text-base font-semibold text-primary">
            {totalDistance ? totalDistance.toFixed(2) : '0.00'} km
          </p>
        </div>
      </div>
    </Card>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\RoutePolyline.tsx
import { useEffect, useState } from 'react'
import { Polyline } from 'react-leaflet'
import { decode } from '@mapbox/polyline'
import { showRouteNotification } from '@/utils/notificationUtils'
import { useTowing } from '@/contexts/TowingContext'
import { getRouteDetails } from '@/services/routeService'
import { COMPANY_LOCATION } from '@/utils/priceCalculator'
import { useToast } from '@/hooks/use-toast'

interface RoutePolylineProps {
  pickupLocation: { lat: number; lng: number } | null
  dropLocation: { lat: number; lng: number } | null
  onRouteCalculated?: (distance: number) => void
}

export const RoutePolyline = ({
  pickupLocation,
  dropLocation,
  onRouteCalculated,
}: RoutePolylineProps) => {
  const [companyToPickupRoute, setCompanyToPickupRoute] = useState<
    [number, number][]
  >([])
  const [pickupToDropRoute, setPickupToDropRoute] = useState<
    [number, number][]
  >([])
  const [dropToCompanyRoute, setDropToCompanyRoute] = useState<
    [number, number][]
  >([])
  const { updateTowingInfo } = useTowing()
  const { toast } = useToast()

  useEffect(() => {
    const fetchRoutes = async () => {
      if (pickupLocation && dropLocation) {
        try {
          // Calculate route from company to pickup
          const companyToPickup = await getRouteDetails(
            COMPANY_LOCATION,
            pickupLocation,
          )
          setCompanyToPickupRoute(
            decode(companyToPickup.geometry).map(([lat, lng]) => [lat, lng]),
          )

          // Calculate route from pickup to drop
          const pickupToDrop = await getRouteDetails(
            pickupLocation,
            dropLocation,
          )
          setPickupToDropRoute(
            decode(pickupToDrop.geometry).map(([lat, lng]) => [lat, lng]),
          )

          // Calculate route from drop back to company
          const dropToCompany = await getRouteDetails(
            dropLocation,
            COMPANY_LOCATION,
          )
          setDropToCompanyRoute(
            decode(dropToCompany.geometry).map(([lat, lng]) => [lat, lng]),
          )

          // Calculate total distance including return to company
          const totalDistance =
            companyToPickup.distance +
            pickupToDrop.distance +
            dropToCompany.distance

          // Update global towing context with total distance
          updateTowingInfo(totalDistance)
          onRouteCalculated?.(totalDistance)
          showRouteNotification(totalDistance)
        } catch (error) {
          console.error('Error calculating routes:', error)
          toast({
            title: 'Error al calcular la ruta',
            description:
              error instanceof Error
                ? error.message
                : 'Por favor, intente nuevamente en unos segundos',
            variant: 'destructive',
          })
        }
      }
    }

    fetchRoutes()
  }, [pickupLocation, dropLocation, onRouteCalculated, updateTowingInfo, toast])

  return (
    <>
      {companyToPickupRoute.length > 0 && (
        <Polyline
          positions={companyToPickupRoute}
          color="blue"
          weight={3}
          dashArray="10, 10"
          opacity={0.7}
        />
      )}
      {pickupToDropRoute.length > 0 && (
        <Polyline
          positions={pickupToDropRoute}
          color="green"
          weight={3}
          opacity={0.9}
        />
      )}
      {dropToCompanyRoute.length > 0 && (
        <Polyline
          positions={dropToCompanyRoute}
          color="red"
          weight={3}
          dashArray="10, 10"
          opacity={0.7}
        />
      )}
    </>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\RouteStreetInfo.tsx
import { Card } from '@/components/ui/card'
import { MapPin, Navigation, Loader2 } from 'lucide-react'
import Draggable from 'react-draggable'
import { useToast } from '@/hooks/use-toast'
import { cn } from '@/lib/utils'
import { useRef } from 'react'

interface RouteStreetInfoProps {
  pickupLocation: { lat: number; lng: number } | null
  dropLocation: { lat: number; lng: number } | null
  pickupAddress?: string
  dropAddress?: string
  isLoading?: boolean
}

export const RouteStreetInfo = ({
  pickupLocation,
  dropLocation,
  pickupAddress,
  dropAddress,
  isLoading = false,
}: RouteStreetInfoProps) => {
  const { toast } = useToast()
  const nodeRef = useRef(null)

  if (!pickupLocation && !dropLocation) return null

  return (
    <Draggable handle=".drag-handle" bounds="parent" nodeRef={nodeRef}>
      <div ref={nodeRef} className="absolute z-[1000] max-w-md">
        <Card
          className={cn(
            'p-4 space-y-3 bg-white/95 backdrop-blur-sm shadow-lg transition-all duration-300',
            'hover:shadow-xl border-blue-100/50',
          )}
        >
          <div className="flex items-center justify-between border-b pb-2 mb-2 drag-handle cursor-move">
            <div className="font-semibold text-sm text-primary/90">
              Detalles de Ubicación
            </div>
            {isLoading && (
              <Loader2 className="w-4 h-4 animate-spin text-primary" />
            )}
          </div>

          {pickupLocation && (
            <div className="flex items-start gap-2">
              <MapPin className="w-5 h-5 mt-1 text-green-500 flex-shrink-0" />
              <div className="flex-1">
                <div className="font-semibold text-sm">Punto de Recogida</div>
                <div className="text-sm text-gray-600 break-words">
                  {pickupAddress || 'Cargando dirección...'}
                </div>
                <div className="text-xs text-gray-500 mt-1">
                  Coordenadas: {pickupLocation.lat.toFixed(6)},{' '}
                  {pickupLocation.lng.toFixed(6)}
                </div>
              </div>
            </div>
          )}

          {dropLocation && (
            <div className="flex items-start gap-2">
              <Navigation className="w-5 h-5 mt-1 text-red-500 flex-shrink-0" />
              <div className="flex-1">
                <div className="font-semibold text-sm">Punto de Entrega</div>
                <div className="text-sm text-gray-600 break-words">
                  {dropAddress || 'Cargando dirección...'}
                </div>
                <div className="text-xs text-gray-500 mt-1">
                  Coordenadas: {dropLocation.lat.toFixed(6)},{' '}
                  {dropLocation.lng.toFixed(6)}
                </div>
              </div>
            </div>
          )}
        </Card>
      </div>
    </Draggable>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\types\floating-panel.ts
import { ReactNode } from 'react'

export interface FloatingPanelProps {
  children: ReactNode
  className?: string
  position?: 'left' | 'right' | 'top' | 'bottom'
  title?: string
}

export interface FloatingPanelControlsProps {
  isCollapsed: boolean
  isMaximized: boolean
  isDragging: boolean
  onCollapse: () => void
  onMaximize: () => void
  onClose: () => void
  title: string
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\map\types\FloatingPanelHeader.tsx
import { motion } from 'framer-motion'
import { Button } from '@/components/ui/button'
import {
  GripVertical,
  ChevronUp,
  ChevronDown,
  Maximize2,
  Minimize2,
  X,
} from 'lucide-react'

interface FloatingPanelHeaderProps {
  title: string
  isCollapsed: boolean
  isMaximized: boolean
  onCollapse: () => void
  onMaximize: () => void
  onClose: () => void
}

export const FloatingPanelHeader = ({
  title,
  isCollapsed,
  isMaximized,
  onCollapse,
  onMaximize,
  onClose,
}: FloatingPanelHeaderProps) => {
  return (
    <div className="flex items-center justify-between">
      <div className="flex items-center gap-2">
        {!isMaximized && (
          <motion.div
            whileHover={{ scale: 1.05 }}
            whileTap={{ scale: 0.95 }}
            className="drag-handle cursor-grab active:cursor-grabbing p-1.5 hover:bg-primary/10 rounded-md"
          >
            <GripVertical className="h-4 w-4 text-primary/70" />
          </motion.div>
        )}
        <h3 className="font-heading font-semibold text-primary/90">{title}</h3>
      </div>

      <div className="flex gap-1">
        {[
          {
            onClick: onCollapse,
            icon: isCollapsed ? (
              <ChevronUp className="h-4 w-4 text-primary/70" />
            ) : (
              <ChevronDown className="h-4 w-4 text-primary/70" />
            ),
          },
          {
            onClick: onMaximize,
            icon: isMaximized ? (
              <Minimize2 className="h-4 w-4 text-primary/70" />
            ) : (
              <Maximize2 className="h-4 w-4 text-primary/70" />
            ),
          },
          {
            onClick: onClose,
            icon: <X className="h-4 w-4 text-primary/70" />,
          },
        ].map((control, index) => (
          <motion.div key={index} whileHover={{ scale: 1.05 }}>
            <Button
              variant="ghost"
              size="sm"
              onClick={control.onClick}
              className="p-1.5 h-8 w-8 hover:bg-primary/10 no-drag rounded-full"
            >
              {control.icon}
            </Button>
          </motion.div>
        ))}
      </div>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\payment\CostDetailsContent.tsx
import { motion } from 'framer-motion'
import { formatCurrency } from '@/utils/priceCalculator'
import { ScrollArea } from '@/components/ui/scroll-area'
import { TollInfoDisplay } from '@/components/TollInfoDisplay'

interface CostDetailsContentProps {
  totalDistance: number
  baseCost: number
  flagDropFee: number
  maneuverCost: number
  requiresManeuver: boolean
  totalTollCost: number
  detectedTolls: any[]
}

export const CostDetailsContent = ({
  totalDistance,
  baseCost,
  flagDropFee,
  maneuverCost,
  requiresManeuver,
  totalTollCost,
  detectedTolls,
}: CostDetailsContentProps) => {
  return (
    <ScrollArea className="h-[calc(100vh-300px)] pr-4">
      <div className="space-y-3">
        <motion.div
          initial={{ opacity: 0, x: -20 }}
          animate={{ opacity: 1, x: 0 }}
          className="p-3 bg-primary/5 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"
        >
          <div className="flex justify-between items-center">
            <span className="text-sm text-gray-700">
              Distancia ({totalDistance.toFixed(1)} km):
            </span>
            <span className="font-medium text-primary">
              {formatCurrency(baseCost)}
            </span>
          </div>
        </motion.div>

        <motion.div
          initial={{ opacity: 0, x: -20 }}
          animate={{ opacity: 1, x: 0 }}
          transition={{ delay: 0.1 }}
          className="p-3 bg-primary/5 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"
        >
          <div className="flex justify-between items-center">
            <span className="text-sm text-gray-700">Banderazo:</span>
            <span className="font-medium text-primary">
              {formatCurrency(flagDropFee)}
            </span>
          </div>
        </motion.div>

        {requiresManeuver && (
          <motion.div
            initial={{ opacity: 0, x: -20 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ delay: 0.2 }}
            className="p-3 bg-orange-50 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"
          >
            <div className="flex justify-between items-center">
              <span className="text-sm text-orange-700">Maniobra:</span>
              <span className="font-medium text-orange-600">
                {formatCurrency(maneuverCost)}
              </span>
            </div>
          </motion.div>
        )}

        {totalTollCost > 0 && (
          <motion.div
            initial={{ opacity: 0, x: -20 }}
            animate={{ opacity: 1, x: 0 }}
            transition={{ delay: 0.3 }}
            className="p-3 bg-yellow-50 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200"
          >
            <div className="flex justify-between items-center">
              <span className="text-sm text-yellow-700">Peajes:</span>
              <span className="font-medium text-yellow-600">
                {formatCurrency(totalTollCost)}
              </span>
            </div>
          </motion.div>
        )}
      </div>

      {detectedTolls.length > 0 && (
        <motion.div
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.4 }}
          className="mt-6"
        >
          <TollInfoDisplay tolls={detectedTolls} totalCost={totalTollCost} />
        </motion.div>
      )}
    </ScrollArea>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\payment\PaymentForm.tsx
import { CardElement, useStripe, useElements } from '@stripe/react-stripe-js'
import { Button } from '@/components/ui/button'
import { Shield, Calendar, CheckCircle, Loader2 } from 'lucide-react'
import { cn } from '@/lib/utils'

interface PaymentFormProps {
  amount: number
  isProcessing: boolean
  cardComplete: boolean
  onClose: () => void
  onSubmit: (e: React.FormEvent) => Promise<void>
}

export const PaymentForm = ({
  amount,
  isProcessing,
  cardComplete,
  onClose,
  onSubmit,
}: PaymentFormProps) => {
  return (
    <form onSubmit={onSubmit} className="space-y-6">
      <div className="space-y-4">
        <div className="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
          <CardElement
            options={{
              style: {
                base: {
                  fontSize: '16px',
                  color: '#424770',
                  '::placeholder': {
                    color: '#aab7c4',
                  },
                },
                invalid: {
                  color: '#9e2146',
                },
              },
              hidePostalCode: true,
            }}
          />
        </div>

        <div className="flex items-center justify-between text-sm text-gray-600">
          <span className="flex items-center gap-1.5">
            <Shield className="w-4 h-4" />
            Encriptación SSL Segura
          </span>
          <span className="flex items-center gap-1.5">
            <Calendar className="w-4 h-4" />
            {new Date().toLocaleDateString()}
          </span>
        </div>

        <div className="flex items-center justify-between px-2">
          <span className="text-sm text-gray-600">Total a Pagar</span>
          <span className="text-lg font-semibold text-primary">
            ${amount.toFixed(2)} MXN
          </span>
        </div>
      </div>

      <div className="flex gap-3 justify-end">
        <Button
          type="button"
          variant="outline"
          onClick={onClose}
          disabled={isProcessing}
          className="border-gray-300 hover:bg-gray-100"
        >
          Cancelar
        </Button>
        <Button
          type="submit"
          disabled={isProcessing || !cardComplete}
          className={cn(
            'bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary text-white min-w-[120px]',
            isProcessing && 'opacity-80',
          )}
        >
          {isProcessing ? (
            <span className="flex items-center gap-2">
              <Loader2 className="w-4 h-4 animate-spin" />
              Procesando...
            </span>
          ) : (
            <span className="flex items-center gap-2">
              <CheckCircle className="w-4 h-4" />
              Pagar ${amount.toFixed(2)} MXN
            </span>
          )}
        </Button>
      </div>
    </form>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\payment\PaymentWindow.tsx
import React from 'react'
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
} from '@/components/ui/dialog'
import { Button } from '@/components/ui/button'
import { useToast } from '@/hooks/use-toast'
import { CardElement, useStripe, useElements } from '@stripe/react-stripe-js'
import { CreditCard, Calendar, CheckCircle, Shield, Info } from 'lucide-react'
import { cn } from '@/lib/utils'
import { motion, AnimatePresence } from 'framer-motion'
import {
  Tooltip,
  TooltipContent,
  TooltipProvider,
  TooltipTrigger,
} from '@/components/ui/tooltip'

interface PaymentWindowProps {
  isOpen: boolean
  onClose: () => void
  onPaymentSubmit?: (result: { success: boolean; error?: string }) => void
  amount: number
}

const PaymentWindow = ({
  isOpen,
  onClose,
  onPaymentSubmit,
  amount = 0,
}: PaymentWindowProps) => {
  const stripe = useStripe()
  const elements = useElements()
  const { toast } = useToast()
  const [isProcessing, setIsProcessing] = React.useState(false)
  const [cardComplete, setCardComplete] = React.useState(false)

  console.log('PaymentWindow rendered:', {
    isOpen,
    isProcessing,
    cardComplete,
    amount,
  })

  React.useEffect(() => {
    if (isOpen) {
      setCardComplete(false)
    }
  }, [isOpen])

  const handleClose = () => {
    if (isProcessing) {
      toast({
        title: 'Pago en Proceso',
        description: 'Por favor espere mientras procesamos su pago',
        variant: 'destructive',
      })
      return
    }
    onClose()
  }

  const handleSubmit = async (event: React.FormEvent) => {
    event.preventDefault()

    if (!cardComplete) {
      toast({
        title: 'Datos Incompletos',
        description: 'Por favor complete todos los datos de la tarjeta',
        variant: 'destructive',
      })
      return
    }

    setIsProcessing(true)

    if (!stripe || !elements) {
      toast({
        title: 'Error',
        description: 'Sistema de pago no disponible. Intente más tarde.',
        variant: 'destructive',
      })
      setIsProcessing(false)
      return
    }

    const cardElement = elements.getElement(CardElement)
    if (!cardElement) {
      toast({
        title: 'Error',
        description: 'Elemento de tarjeta no encontrado.',
        variant: 'destructive',
      })
      setIsProcessing(false)
      return
    }

    try {
      const { error, paymentMethod } = await stripe.createPaymentMethod({
        type: 'card',
        card: cardElement,
      })

      if (error) {
        throw error
      }

      await new Promise((resolve) => setTimeout(resolve, 1000))

      toast({
        title: 'Pago Exitoso',
        description: 'Su pago ha sido procesado exitosamente.',
      })

      onPaymentSubmit?.({ success: true })
      onClose()
    } catch (err: any) {
      toast({
        title: 'Error en el Pago',
        description: err.message || 'Ocurrió un error al procesar el pago',
        variant: 'destructive',
      })
      onPaymentSubmit?.({ success: false, error: err.message })
    } finally {
      setIsProcessing(false)
    }
  }

  return (
    <Dialog open={isOpen} onOpenChange={handleClose}>
      <DialogContent className="sm:max-w-md bg-gradient-to-br from-white to-gray-50 border-gray-200">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2 text-xl font-semibold">
            <CreditCard className="w-5 h-5 text-primary" />
            Pago Seguro
          </DialogTitle>
        </DialogHeader>

        <form onSubmit={handleSubmit} className="space-y-6">
          <motion.div
            className="space-y-4"
            initial={{ opacity: 0, y: 20 }}
            animate={{ opacity: 1, y: 0 }}
            transition={{ duration: 0.3 }}
          >
            <div className="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
              <CardElement
                onChange={(e) => setCardComplete(e.complete)}
                options={{
                  style: {
                    base: {
                      fontSize: '16px',
                      color: '#424770',
                      '::placeholder': {
                        color: '#aab7c4',
                      },
                    },
                    invalid: {
                      color: '#9e2146',
                    },
                  },
                  hidePostalCode: true,
                }}
              />
            </div>

            <div className="flex items-center justify-between text-sm text-gray-600">
              <TooltipProvider>
                <Tooltip>
                  <TooltipTrigger asChild>
                    <span className="flex items-center gap-1.5 cursor-help">
                      <Shield className="w-4 h-4" />
                      Encriptación SSL
                    </span>
                  </TooltipTrigger>
                  <TooltipContent>
                    <p>Sus datos están protegidos con encriptación SSL</p>
                  </TooltipContent>
                </Tooltip>
              </TooltipProvider>
              <span className="flex items-center gap-1.5">
                <Calendar className="w-4 h-4" />
                {new Date().toLocaleDateString()}
              </span>
            </div>

            <div className="flex items-center justify-between px-2">
              <span className="text-sm text-gray-600">Costo del Servicio</span>
              <span className="text-lg font-semibold text-primary">
                ${amount.toFixed(2)}
              </span>
            </div>
          </motion.div>

          <div className="flex gap-3 justify-end">
            <Button
              type="button"
              variant="outline"
              onClick={handleClose}
              disabled={isProcessing}
              className="border-gray-300 hover:bg-gray-100"
            >
              Cancelar
            </Button>
            <Button
              type="submit"
              disabled={!stripe || isProcessing || !cardComplete}
              className={cn(
                'bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary text-white min-w-[120px]',
                isProcessing && 'opacity-80',
              )}
            >
              {isProcessing ? (
                <span className="flex items-center gap-2">
                  <div className="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin" />
                  Procesando...
                </span>
              ) : (
                <span className="flex items-center gap-2">
                  <CheckCircle className="w-4 h-4" />
                  Pagar ${amount.toFixed(2)}
                </span>
              )}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  )
}

export default PaymentWindow



// C:\Users\israe\Documents\GitHub\recentmap\src\components\reservations\components\ReservationFilters.tsx
import { Input } from '@/components/ui/input'
import { Button } from '@/components/ui/button'
import { Calendar } from '@/components/ui/calendar'
import { Filter, SortAsc, SortDesc } from 'lucide-react'
import { motion } from 'framer-motion'

interface ReservationFiltersProps {
  searchQuery: string
  onSearchChange: (value: string) => void
  selectedDate: Date | undefined
  onDateSelect: (date: Date | undefined) => void
  sortDirection: 'asc' | 'desc'
  onSortChange: () => void
}

export const ReservationFilters = ({
  searchQuery,
  onSearchChange,
  selectedDate,
  onDateSelect,
  sortDirection,
  onSortChange,
}: ReservationFiltersProps) => {
  return (
    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
      <div className="space-y-2">
        <div className="flex items-center gap-2">
          <Filter className="h-4 w-4 text-gray-500" />
          <span className="text-sm font-medium text-gray-700">
            Filtrar Reservas
          </span>
        </div>
        <Input
          placeholder="Buscar reservas..."
          value={searchQuery}
          onChange={(e) => onSearchChange(e.target.value)}
          className="w-full"
        />
      </div>
      <div className="space-y-2">
        <div className="flex items-center gap-2">
          <Filter className="h-4 w-4 text-gray-500" />
          <span className="text-sm font-medium text-gray-700">
            Filtrar por Fecha
          </span>
        </div>
        <div className="flex items-center gap-2">
          <Calendar
            mode="single"
            selected={selectedDate}
            onSelect={onDateSelect}
            className="rounded-md border"
          />
          <Button
            variant="outline"
            size="icon"
            onClick={onSortChange}
            className="relative group"
          >
            {sortDirection === 'asc' ? (
              <SortAsc className="h-4 w-4" />
            ) : (
              <SortDesc className="h-4 w-4" />
            )}
          </Button>
        </div>
      </div>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\reservations\components\ReservationList.tsx
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from '@/components/ui/table'
import { Button } from '@/components/ui/button'
import { useToast } from '@/hooks/use-toast'
import { ServiceRequest } from '@/types/service'
import { motion } from 'framer-motion'

interface ReservationListProps {
  reservations: ServiceRequest[]
  isLoading: boolean
}

export const ReservationList = ({
  reservations,
  isLoading,
}: ReservationListProps) => {
  const { toast } = useToast()

  return (
    <motion.div
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      exit={{ opacity: 0 }}
      className="rounded-md border"
    >
      <Table>
        <TableHeader>
          <TableRow>
            <TableHead>ID</TableHead>
            <TableHead>Status</TableHead>
            <TableHead>Created</TableHead>
            <TableHead>Customer</TableHead>
            <TableHead>Vehicle</TableHead>
            <TableHead>Actions</TableHead>
          </TableRow>
        </TableHeader>
        <TableBody>
          {reservations.map((reservation) => (
            <TableRow key={reservation.id}>
              <TableCell>{reservation.id}</TableCell>
              <TableCell>
                <span
                  className={`px-2 py-1 rounded-full text-xs ${
                    reservation.status === 'completed'
                      ? 'bg-green-100 text-green-800'
                      : 'bg-yellow-100 text-yellow-800'
                  }`}
                >
                  {reservation.status}
                </span>
              </TableCell>
              <TableCell>
                {reservation.createdAt.toLocaleDateString()}
              </TableCell>
              <TableCell>{reservation.username}</TableCell>
              <TableCell>{`${reservation.vehicleYear} ${reservation.vehicleMake} ${reservation.vehicleModel}`}</TableCell>
              <TableCell>
                <Button
                  variant="outline"
                  size="sm"
                  onClick={() => {
                    toast({
                      title: 'Ver Detalles',
                      description: `Viendo reserva ${reservation.id}`,
                    })
                  }}
                >
                  Ver
                </Button>
              </TableCell>
            </TableRow>
          ))}
        </TableBody>
      </Table>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\accordion.tsx
import * as React from 'react'
import * as AccordionPrimitive from '@radix-ui/react-accordion'
import { ChevronDown } from 'lucide-react'

import { cn } from '@/lib/utils'

const Accordion = AccordionPrimitive.Root

const AccordionItem = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>
>(({ className, ...props }, ref) => (
  <AccordionPrimitive.Item
    ref={ref}
    className={cn('border-b', className)}
    {...props}
  />
))
AccordionItem.displayName = 'AccordionItem'

const AccordionTrigger = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Header className="flex">
    <AccordionPrimitive.Trigger
      ref={ref}
      className={cn(
        'flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180',
        className,
      )}
      {...props}
    >
      {children}
      <ChevronDown className="h-4 w-4 shrink-0 transition-transform duration-200" />
    </AccordionPrimitive.Trigger>
  </AccordionPrimitive.Header>
))
AccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName

const AccordionContent = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Content
    ref={ref}
    className="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"
    {...props}
  >
    <div className={cn('pb-4 pt-0', className)}>{children}</div>
  </AccordionPrimitive.Content>
))

AccordionContent.displayName = AccordionPrimitive.Content.displayName

export { Accordion, AccordionItem, AccordionTrigger, AccordionContent }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\alert-dialog.tsx
import * as React from 'react'
import * as AlertDialogPrimitive from '@radix-ui/react-alert-dialog'

import { cn } from '@/lib/utils'
import { buttonVariants } from '@/components/ui/button'

const AlertDialog = AlertDialogPrimitive.Root

const AlertDialogTrigger = AlertDialogPrimitive.Trigger

const AlertDialogPortal = AlertDialogPrimitive.Portal

const AlertDialogOverlay = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Overlay
    className={cn(
      'fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',
      className,
    )}
    {...props}
    ref={ref}
  />
))
AlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName

const AlertDialogContent = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>
>(({ className, ...props }, ref) => (
  <AlertDialogPortal>
    <AlertDialogOverlay />
    <AlertDialogPrimitive.Content
      ref={ref}
      className={cn(
        'fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg',
        className,
      )}
      {...props}
    />
  </AlertDialogPortal>
))
AlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName

const AlertDialogHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col space-y-2 text-center sm:text-left',
      className,
    )}
    {...props}
  />
)
AlertDialogHeader.displayName = 'AlertDialogHeader'

const AlertDialogFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2',
      className,
    )}
    {...props}
  />
)
AlertDialogFooter.displayName = 'AlertDialogFooter'

const AlertDialogTitle = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Title
    ref={ref}
    className={cn('text-lg font-semibold', className)}
    {...props}
  />
))
AlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName

const AlertDialogDescription = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Description
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
))
AlertDialogDescription.displayName =
  AlertDialogPrimitive.Description.displayName

const AlertDialogAction = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Action>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Action
    ref={ref}
    className={cn(buttonVariants(), className)}
    {...props}
  />
))
AlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName

const AlertDialogCancel = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Cancel
    ref={ref}
    className={cn(
      buttonVariants({ variant: 'outline' }),
      'mt-2 sm:mt-0',
      className,
    )}
    {...props}
  />
))
AlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName

export {
  AlertDialog,
  AlertDialogPortal,
  AlertDialogOverlay,
  AlertDialogTrigger,
  AlertDialogContent,
  AlertDialogHeader,
  AlertDialogFooter,
  AlertDialogTitle,
  AlertDialogDescription,
  AlertDialogAction,
  AlertDialogCancel,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\alert.tsx
import * as React from 'react'
import { cva, type VariantProps } from 'class-variance-authority'

import { cn } from '@/lib/utils'

const alertVariants = cva(
  'relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground',
  {
    variants: {
      variant: {
        default: 'bg-background text-foreground',
        destructive:
          'border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive',
      },
    },
    defaultVariants: {
      variant: 'default',
    },
  },
)

const Alert = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
>(({ className, variant, ...props }, ref) => (
  <div
    ref={ref}
    role="alert"
    className={cn(alertVariants({ variant }), className)}
    {...props}
  />
))
Alert.displayName = 'Alert'

const AlertTitle = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLHeadingElement>
>(({ className, ...props }, ref) => (
  <h5
    ref={ref}
    className={cn('mb-1 font-medium leading-none tracking-tight', className)}
    {...props}
  />
))
AlertTitle.displayName = 'AlertTitle'

const AlertDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn('text-sm [&_p]:leading-relaxed', className)}
    {...props}
  />
))
AlertDescription.displayName = 'AlertDescription'

export { Alert, AlertTitle, AlertDescription }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\aspect-ratio.tsx
import * as AspectRatioPrimitive from '@radix-ui/react-aspect-ratio'

const AspectRatio = AspectRatioPrimitive.Root

export { AspectRatio }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\avatar.tsx
import * as React from 'react'
import * as AvatarPrimitive from '@radix-ui/react-avatar'

import { cn } from '@/lib/utils'

const Avatar = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Root
    ref={ref}
    className={cn(
      'relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full',
      className,
    )}
    {...props}
  />
))
Avatar.displayName = AvatarPrimitive.Root.displayName

const AvatarImage = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Image>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Image
    ref={ref}
    className={cn('aspect-square h-full w-full', className)}
    {...props}
  />
))
AvatarImage.displayName = AvatarPrimitive.Image.displayName

const AvatarFallback = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Fallback>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Fallback
    ref={ref}
    className={cn(
      'flex h-full w-full items-center justify-center rounded-full bg-muted',
      className,
    )}
    {...props}
  />
))
AvatarFallback.displayName = AvatarPrimitive.Fallback.displayName

export { Avatar, AvatarImage, AvatarFallback }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\badge.tsx
import * as React from 'react'
import { cva, type VariantProps } from 'class-variance-authority'

import { cn } from '@/lib/utils'

const badgeVariants = cva(
  'inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2',
  {
    variants: {
      variant: {
        default:
          'border-transparent bg-primary text-primary-foreground hover:bg-primary/80',
        secondary:
          'border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80',
        destructive:
          'border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80',
        outline: 'text-foreground',
      },
    },
    defaultVariants: {
      variant: 'default',
    },
  },
)

export interface BadgeProps
  extends React.HTMLAttributes<HTMLDivElement>,
    VariantProps<typeof badgeVariants> {}

function Badge({ className, variant, ...props }: BadgeProps) {
  return (
    <div className={cn(badgeVariants({ variant }), className)} {...props} />
  )
}

export { Badge, badgeVariants }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\breadcrumb.tsx
import * as React from 'react'
import { Slot } from '@radix-ui/react-slot'
import { ChevronRight, MoreHorizontal } from 'lucide-react'

import { cn } from '@/lib/utils'

const Breadcrumb = React.forwardRef<
  HTMLElement,
  React.ComponentPropsWithoutRef<'nav'> & {
    separator?: React.ReactNode
  }
>(({ ...props }, ref) => <nav ref={ref} aria-label="breadcrumb" {...props} />)
Breadcrumb.displayName = 'Breadcrumb'

const BreadcrumbList = React.forwardRef<
  HTMLOListElement,
  React.ComponentPropsWithoutRef<'ol'>
>(({ className, ...props }, ref) => (
  <ol
    ref={ref}
    className={cn(
      'flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5',
      className,
    )}
    {...props}
  />
))
BreadcrumbList.displayName = 'BreadcrumbList'

const BreadcrumbItem = React.forwardRef<
  HTMLLIElement,
  React.ComponentPropsWithoutRef<'li'>
>(({ className, ...props }, ref) => (
  <li
    ref={ref}
    className={cn('inline-flex items-center gap-1.5', className)}
    {...props}
  />
))
BreadcrumbItem.displayName = 'BreadcrumbItem'

const BreadcrumbLink = React.forwardRef<
  HTMLAnchorElement,
  React.ComponentPropsWithoutRef<'a'> & {
    asChild?: boolean
  }
>(({ asChild, className, ...props }, ref) => {
  const Comp = asChild ? Slot : 'a'

  return (
    <Comp
      ref={ref}
      className={cn('transition-colors hover:text-foreground', className)}
      {...props}
    />
  )
})
BreadcrumbLink.displayName = 'BreadcrumbLink'

const BreadcrumbPage = React.forwardRef<
  HTMLSpanElement,
  React.ComponentPropsWithoutRef<'span'>
>(({ className, ...props }, ref) => (
  <span
    ref={ref}
    role="link"
    aria-disabled="true"
    aria-current="page"
    className={cn('font-normal text-foreground', className)}
    {...props}
  />
))
BreadcrumbPage.displayName = 'BreadcrumbPage'

const BreadcrumbSeparator = ({
  children,
  className,
  ...props
}: React.ComponentProps<'li'>) => (
  <li
    role="presentation"
    aria-hidden="true"
    className={cn('[&>svg]:size-3.5', className)}
    {...props}
  >
    {children ?? <ChevronRight />}
  </li>
)
BreadcrumbSeparator.displayName = 'BreadcrumbSeparator'

const BreadcrumbEllipsis = ({
  className,
  ...props
}: React.ComponentProps<'span'>) => (
  <span
    role="presentation"
    aria-hidden="true"
    className={cn('flex h-9 w-9 items-center justify-center', className)}
    {...props}
  >
    <MoreHorizontal className="h-4 w-4" />
    <span className="sr-only">More</span>
  </span>
)
BreadcrumbEllipsis.displayName = 'BreadcrumbElipssis'

export {
  Breadcrumb,
  BreadcrumbList,
  BreadcrumbItem,
  BreadcrumbLink,
  BreadcrumbPage,
  BreadcrumbSeparator,
  BreadcrumbEllipsis,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\button.tsx
import * as React from 'react'
import { Slot } from '@radix-ui/react-slot'
import { cva, type VariantProps } from 'class-variance-authority'
import { cn } from '@/lib/utils'

const buttonVariants = cva(
  'inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50',
  {
    variants: {
      variant: {
        default: 'bg-primary text-primary-foreground hover:bg-primary/90',
        destructive:
          'bg-destructive text-destructive-foreground hover:bg-destructive/90',
        outline:
          'border border-input bg-background hover:bg-accent hover:text-accent-foreground',
        secondary:
          'bg-secondary text-secondary-foreground hover:bg-secondary/80',
        ghost: 'hover:bg-accent hover:text-accent-foreground',
        link: 'text-primary underline-offset-4 hover:underline',
        metallic:
          'metallic-effect text-gray-800 hover:scale-105 transition-transform duration-200',
      },
      size: {
        default: 'h-10 px-4 py-2',
        sm: 'h-9 rounded-md px-3',
        lg: 'h-11 rounded-md px-8',
        icon: 'h-10 w-10',
      },
    },
    defaultVariants: {
      variant: 'default',
      size: 'default',
    },
  },
)

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : 'button'
    return (
      <Comp
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    )
  },
)
Button.displayName = 'Button'

export { Button, buttonVariants }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\calendar.tsx
import * as React from 'react'
import { ChevronLeft, ChevronRight } from 'lucide-react'
import { DayPicker } from 'react-day-picker'

import { cn } from '@/lib/utils'
import { buttonVariants } from '@/components/ui/button'

export type CalendarProps = React.ComponentProps<typeof DayPicker>

function Calendar({
  className,
  classNames,
  showOutsideDays = true,
  ...props
}: CalendarProps) {
  return (
    <DayPicker
      showOutsideDays={showOutsideDays}
      className={cn('p-3', className)}
      classNames={{
        months: 'flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0',
        month: 'space-y-4',
        caption: 'flex justify-center pt-1 relative items-center',
        caption_label: 'text-sm font-medium',
        nav: 'space-x-1 flex items-center',
        nav_button: cn(
          buttonVariants({ variant: 'outline' }),
          'h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100',
        ),
        nav_button_previous: 'absolute left-1',
        nav_button_next: 'absolute right-1',
        table: 'w-full border-collapse space-y-1',
        head_row: 'flex',
        head_cell:
          'text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]',
        row: 'flex w-full mt-2',
        cell: 'h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20',
        day: cn(
          buttonVariants({ variant: 'ghost' }),
          'h-9 w-9 p-0 font-normal aria-selected:opacity-100',
        ),
        day_range_end: 'day-range-end',
        day_selected:
          'bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground',
        day_today: 'bg-accent text-accent-foreground',
        day_outside:
          'day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30',
        day_disabled: 'text-muted-foreground opacity-50',
        day_range_middle:
          'aria-selected:bg-accent aria-selected:text-accent-foreground',
        day_hidden: 'invisible',
        ...classNames,
      }}
      components={{
        IconLeft: ({ ..._props }) => <ChevronLeft className="h-4 w-4" />,
        IconRight: ({ ..._props }) => <ChevronRight className="h-4 w-4" />,
      }}
      {...props}
    />
  )
}
Calendar.displayName = 'Calendar'

export { Calendar }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\card.tsx
import * as React from 'react'

import { cn } from '@/lib/utils'

const Card = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn(
      'rounded-lg border bg-card text-card-foreground shadow-sm',
      className,
    )}
    {...props}
  />
))
Card.displayName = 'Card'

const CardHeader = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn('flex flex-col space-y-1.5 p-6', className)}
    {...props}
  />
))
CardHeader.displayName = 'CardHeader'

const CardTitle = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLHeadingElement>
>(({ className, ...props }, ref) => (
  <h3
    ref={ref}
    className={cn(
      'text-2xl font-semibold leading-none tracking-tight',
      className,
    )}
    {...props}
  />
))
CardTitle.displayName = 'CardTitle'

const CardDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => (
  <p
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
))
CardDescription.displayName = 'CardDescription'

const CardContent = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn('p-6 pt-0', className)} {...props} />
))
CardContent.displayName = 'CardContent'

const CardFooter = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn('flex items-center p-6 pt-0', className)}
    {...props}
  />
))
CardFooter.displayName = 'CardFooter'

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\carousel.tsx
import * as React from 'react'
import useEmblaCarousel, {
  type UseEmblaCarouselType,
} from 'embla-carousel-react'
import { ArrowLeft, ArrowRight } from 'lucide-react'

import { cn } from '@/lib/utils'
import { Button } from '@/components/ui/button'

type CarouselApi = UseEmblaCarouselType[1]
type UseCarouselParameters = Parameters<typeof useEmblaCarousel>
type CarouselOptions = UseCarouselParameters[0]
type CarouselPlugin = UseCarouselParameters[1]

type CarouselProps = {
  opts?: CarouselOptions
  plugins?: CarouselPlugin
  orientation?: 'horizontal' | 'vertical'
  setApi?: (api: CarouselApi) => void
}

type CarouselContextProps = {
  carouselRef: ReturnType<typeof useEmblaCarousel>[0]
  api: ReturnType<typeof useEmblaCarousel>[1]
  scrollPrev: () => void
  scrollNext: () => void
  canScrollPrev: boolean
  canScrollNext: boolean
} & CarouselProps

const CarouselContext = React.createContext<CarouselContextProps | null>(null)

function useCarousel() {
  const context = React.useContext(CarouselContext)

  if (!context) {
    throw new Error('useCarousel must be used within a <Carousel />')
  }

  return context
}

const Carousel = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & CarouselProps
>(
  (
    {
      orientation = 'horizontal',
      opts,
      setApi,
      plugins,
      className,
      children,
      ...props
    },
    ref,
  ) => {
    const [carouselRef, api] = useEmblaCarousel(
      {
        ...opts,
        axis: orientation === 'horizontal' ? 'x' : 'y',
      },
      plugins,
    )
    const [canScrollPrev, setCanScrollPrev] = React.useState(false)
    const [canScrollNext, setCanScrollNext] = React.useState(false)

    const onSelect = React.useCallback((api: CarouselApi) => {
      if (!api) {
        return
      }

      setCanScrollPrev(api.canScrollPrev())
      setCanScrollNext(api.canScrollNext())
    }, [])

    const scrollPrev = React.useCallback(() => {
      api?.scrollPrev()
    }, [api])

    const scrollNext = React.useCallback(() => {
      api?.scrollNext()
    }, [api])

    const handleKeyDown = React.useCallback(
      (event: React.KeyboardEvent<HTMLDivElement>) => {
        if (event.key === 'ArrowLeft') {
          event.preventDefault()
          scrollPrev()
        } else if (event.key === 'ArrowRight') {
          event.preventDefault()
          scrollNext()
        }
      },
      [scrollPrev, scrollNext],
    )

    React.useEffect(() => {
      if (!api || !setApi) {
        return
      }

      setApi(api)
    }, [api, setApi])

    React.useEffect(() => {
      if (!api) {
        return
      }

      onSelect(api)
      api.on('reInit', onSelect)
      api.on('select', onSelect)

      return () => {
        api?.off('select', onSelect)
      }
    }, [api, onSelect])

    return (
      <CarouselContext.Provider
        value={{
          carouselRef,
          api: api,
          opts,
          orientation:
            orientation || (opts?.axis === 'y' ? 'vertical' : 'horizontal'),
          scrollPrev,
          scrollNext,
          canScrollPrev,
          canScrollNext,
        }}
      >
        <div
          ref={ref}
          onKeyDownCapture={handleKeyDown}
          className={cn('relative', className)}
          role="region"
          aria-roledescription="carousel"
          {...props}
        >
          {children}
        </div>
      </CarouselContext.Provider>
    )
  },
)
Carousel.displayName = 'Carousel'

const CarouselContent = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const { carouselRef, orientation } = useCarousel()

  return (
    <div ref={carouselRef} className="overflow-hidden">
      <div
        ref={ref}
        className={cn(
          'flex',
          orientation === 'horizontal' ? '-ml-4' : '-mt-4 flex-col',
          className,
        )}
        {...props}
      />
    </div>
  )
})
CarouselContent.displayName = 'CarouselContent'

const CarouselItem = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const { orientation } = useCarousel()

  return (
    <div
      ref={ref}
      role="group"
      aria-roledescription="slide"
      className={cn(
        'min-w-0 shrink-0 grow-0 basis-full',
        orientation === 'horizontal' ? 'pl-4' : 'pt-4',
        className,
      )}
      {...props}
    />
  )
})
CarouselItem.displayName = 'CarouselItem'

const CarouselPrevious = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<typeof Button>
>(({ className, variant = 'outline', size = 'icon', ...props }, ref) => {
  const { orientation, scrollPrev, canScrollPrev } = useCarousel()

  return (
    <Button
      ref={ref}
      variant={variant}
      size={size}
      className={cn(
        'absolute  h-8 w-8 rounded-full',
        orientation === 'horizontal'
          ? '-left-12 top-1/2 -translate-y-1/2'
          : '-top-12 left-1/2 -translate-x-1/2 rotate-90',
        className,
      )}
      disabled={!canScrollPrev}
      onClick={scrollPrev}
      {...props}
    >
      <ArrowLeft className="h-4 w-4" />
      <span className="sr-only">Previous slide</span>
    </Button>
  )
})
CarouselPrevious.displayName = 'CarouselPrevious'

const CarouselNext = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<typeof Button>
>(({ className, variant = 'outline', size = 'icon', ...props }, ref) => {
  const { orientation, scrollNext, canScrollNext } = useCarousel()

  return (
    <Button
      ref={ref}
      variant={variant}
      size={size}
      className={cn(
        'absolute h-8 w-8 rounded-full',
        orientation === 'horizontal'
          ? '-right-12 top-1/2 -translate-y-1/2'
          : '-bottom-12 left-1/2 -translate-x-1/2 rotate-90',
        className,
      )}
      disabled={!canScrollNext}
      onClick={scrollNext}
      {...props}
    >
      <ArrowRight className="h-4 w-4" />
      <span className="sr-only">Next slide</span>
    </Button>
  )
})
CarouselNext.displayName = 'CarouselNext'

export {
  type CarouselApi,
  Carousel,
  CarouselContent,
  CarouselItem,
  CarouselPrevious,
  CarouselNext,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\chart.tsx
import * as React from 'react'
import * as RechartsPrimitive from 'recharts'

import { cn } from '@/lib/utils'

// Format: { THEME_NAME: CSS_SELECTOR }
const THEMES = { light: '', dark: '.dark' } as const

export type ChartConfig = {
  [k in string]: {
    label?: React.ReactNode
    icon?: React.ComponentType
  } & (
    | { color?: string; theme?: never }
    | { color?: never; theme: Record<keyof typeof THEMES, string> }
  )
}

type ChartContextProps = {
  config: ChartConfig
}

const ChartContext = React.createContext<ChartContextProps | null>(null)

function useChart() {
  const context = React.useContext(ChartContext)

  if (!context) {
    throw new Error('useChart must be used within a <ChartContainer />')
  }

  return context
}

const ChartContainer = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'> & {
    config: ChartConfig
    children: React.ComponentProps<
      typeof RechartsPrimitive.ResponsiveContainer
    >['children']
  }
>(({ id, className, children, config, ...props }, ref) => {
  const uniqueId = React.useId()
  const chartId = `chart-${id || uniqueId.replace(/:/g, '')}`

  return (
    <ChartContext.Provider value={{ config }}>
      <div
        data-chart={chartId}
        ref={ref}
        className={cn(
          "flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",
          className,
        )}
        {...props}
      >
        <ChartStyle id={chartId} config={config} />
        <RechartsPrimitive.ResponsiveContainer>
          {children}
        </RechartsPrimitive.ResponsiveContainer>
      </div>
    </ChartContext.Provider>
  )
})
ChartContainer.displayName = 'Chart'

const ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {
  const colorConfig = Object.entries(config).filter(
    ([_, config]) => config.theme || config.color,
  )

  if (!colorConfig.length) {
    return null
  }

  return (
    <style
      dangerouslySetInnerHTML={{
        __html: Object.entries(THEMES)
          .map(
            ([theme, prefix]) => `
${prefix} [data-chart=${id}] {
${colorConfig
  .map(([key, itemConfig]) => {
    const color =
      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||
      itemConfig.color
    return color ? `  --color-${key}: ${color};` : null
  })
  .join('\n')}
}
`,
          )
          .join('\n'),
      }}
    />
  )
}

const ChartTooltip = RechartsPrimitive.Tooltip

const ChartTooltipContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &
    React.ComponentProps<'div'> & {
      hideLabel?: boolean
      hideIndicator?: boolean
      indicator?: 'line' | 'dot' | 'dashed'
      nameKey?: string
      labelKey?: string
    }
>(
  (
    {
      active,
      payload,
      className,
      indicator = 'dot',
      hideLabel = false,
      hideIndicator = false,
      label,
      labelFormatter,
      labelClassName,
      formatter,
      color,
      nameKey,
      labelKey,
    },
    ref,
  ) => {
    const { config } = useChart()

    const tooltipLabel = React.useMemo(() => {
      if (hideLabel || !payload?.length) {
        return null
      }

      const [item] = payload
      const key = `${labelKey || item.dataKey || item.name || 'value'}`
      const itemConfig = getPayloadConfigFromPayload(config, item, key)
      const value =
        !labelKey && typeof label === 'string'
          ? config[label as keyof typeof config]?.label || label
          : itemConfig?.label

      if (labelFormatter) {
        return (
          <div className={cn('font-medium', labelClassName)}>
            {labelFormatter(value, payload)}
          </div>
        )
      }

      if (!value) {
        return null
      }

      return <div className={cn('font-medium', labelClassName)}>{value}</div>
    }, [
      label,
      labelFormatter,
      payload,
      hideLabel,
      labelClassName,
      config,
      labelKey,
    ])

    if (!active || !payload?.length) {
      return null
    }

    const nestLabel = payload.length === 1 && indicator !== 'dot'

    return (
      <div
        ref={ref}
        className={cn(
          'grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl',
          className,
        )}
      >
        {!nestLabel ? tooltipLabel : null}
        <div className="grid gap-1.5">
          {payload.map((item, index) => {
            const key = `${nameKey || item.name || item.dataKey || 'value'}`
            const itemConfig = getPayloadConfigFromPayload(config, item, key)
            const indicatorColor = color || item.payload.fill || item.color

            return (
              <div
                key={item.dataKey}
                className={cn(
                  'flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground',
                  indicator === 'dot' && 'items-center',
                )}
              >
                {formatter && item?.value !== undefined && item.name ? (
                  formatter(item.value, item.name, item, index, item.payload)
                ) : (
                  <>
                    {itemConfig?.icon ? (
                      <itemConfig.icon />
                    ) : (
                      !hideIndicator && (
                        <div
                          className={cn(
                            'shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]',
                            {
                              'h-2.5 w-2.5': indicator === 'dot',
                              'w-1': indicator === 'line',
                              'w-0 border-[1.5px] border-dashed bg-transparent':
                                indicator === 'dashed',
                              'my-0.5': nestLabel && indicator === 'dashed',
                            },
                          )}
                          style={
                            {
                              '--color-bg': indicatorColor,
                              '--color-border': indicatorColor,
                            } as React.CSSProperties
                          }
                        />
                      )
                    )}
                    <div
                      className={cn(
                        'flex flex-1 justify-between leading-none',
                        nestLabel ? 'items-end' : 'items-center',
                      )}
                    >
                      <div className="grid gap-1.5">
                        {nestLabel ? tooltipLabel : null}
                        <span className="text-muted-foreground">
                          {itemConfig?.label || item.name}
                        </span>
                      </div>
                      {item.value && (
                        <span className="font-mono font-medium tabular-nums text-foreground">
                          {item.value.toLocaleString()}
                        </span>
                      )}
                    </div>
                  </>
                )}
              </div>
            )
          })}
        </div>
      </div>
    )
  },
)
ChartTooltipContent.displayName = 'ChartTooltip'

const ChartLegend = RechartsPrimitive.Legend

const ChartLegendContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<'div'> &
    Pick<RechartsPrimitive.LegendProps, 'payload' | 'verticalAlign'> & {
      hideIcon?: boolean
      nameKey?: string
    }
>(
  (
    { className, hideIcon = false, payload, verticalAlign = 'bottom', nameKey },
    ref,
  ) => {
    const { config } = useChart()

    if (!payload?.length) {
      return null
    }

    return (
      <div
        ref={ref}
        className={cn(
          'flex items-center justify-center gap-4',
          verticalAlign === 'top' ? 'pb-3' : 'pt-3',
          className,
        )}
      >
        {payload.map((item) => {
          const key = `${nameKey || item.dataKey || 'value'}`
          const itemConfig = getPayloadConfigFromPayload(config, item, key)

          return (
            <div
              key={item.value}
              className={cn(
                'flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground',
              )}
            >
              {itemConfig?.icon && !hideIcon ? (
                <itemConfig.icon />
              ) : (
                <div
                  className="h-4 w-4 shrink-0 rounded-[2px]"
                  style={{
                    backgroundColor: item.color,
                  }}
                />
              )}
              {itemConfig?.label}
            </div>
          )
        })}
      </div>
    )
  },
)
ChartLegendContent.displayName = 'ChartLegend'

// Helper to extract item config from a payload.
function getPayloadConfigFromPayload(
  config: ChartConfig,
  payload: unknown,
  key: string,
) {
  if (typeof payload !== 'object' || payload === null) {
    return undefined
  }

  const payloadPayload =
    'payload' in payload &&
    typeof payload.payload === 'object' &&
    payload.payload !== null
      ? payload.payload
      : undefined

  let configLabelKey: string = key

  if (
    key in payload &&
    typeof payload[key as keyof typeof payload] === 'string'
  ) {
    configLabelKey = payload[key as keyof typeof payload] as string
  } else if (
    payloadPayload &&
    key in payloadPayload &&
    typeof payloadPayload[key as keyof typeof payloadPayload] === 'string'
  ) {
    configLabelKey = payloadPayload[
      key as keyof typeof payloadPayload
    ] as string
  }

  return configLabelKey in config
    ? config[configLabelKey]
    : config[key as keyof typeof config]
}

export {
  ChartContainer,
  ChartTooltip,
  ChartTooltipContent,
  ChartLegend,
  ChartLegendContent,
  ChartStyle,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\checkbox.tsx
import * as React from 'react'
import * as CheckboxPrimitive from '@radix-ui/react-checkbox'
import { Check } from 'lucide-react'

import { cn } from '@/lib/utils'

const Checkbox = React.forwardRef<
  React.ElementRef<typeof CheckboxPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>
>(({ className, ...props }, ref) => (
  <CheckboxPrimitive.Root
    ref={ref}
    className={cn(
      'peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground',
      className,
    )}
    {...props}
  >
    <CheckboxPrimitive.Indicator
      className={cn('flex items-center justify-center text-current')}
    >
      <Check className="h-4 w-4" />
    </CheckboxPrimitive.Indicator>
  </CheckboxPrimitive.Root>
))
Checkbox.displayName = CheckboxPrimitive.Root.displayName

export { Checkbox }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\collapsible.tsx
import * as CollapsiblePrimitive from '@radix-ui/react-collapsible'

const Collapsible = CollapsiblePrimitive.Root

const CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger

const CollapsibleContent = CollapsiblePrimitive.CollapsibleContent

export { Collapsible, CollapsibleTrigger, CollapsibleContent }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\command.tsx
import * as React from 'react'
import { type DialogProps } from '@radix-ui/react-dialog'
import { Command as CommandPrimitive } from 'cmdk'
import { Search } from 'lucide-react'

import { cn } from '@/lib/utils'
import { Dialog, DialogContent } from '@/components/ui/dialog'

const Command = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive>
>(({ className, ...props }, ref) => (
  <CommandPrimitive
    ref={ref}
    className={cn(
      'flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground',
      className,
    )}
    {...props}
  />
))
Command.displayName = CommandPrimitive.displayName

interface CommandDialogProps extends DialogProps {}

const CommandDialog = ({ children, ...props }: CommandDialogProps) => {
  return (
    <Dialog {...props}>
      <DialogContent className="overflow-hidden p-0 shadow-lg">
        <Command className="[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5">
          {children}
        </Command>
      </DialogContent>
    </Dialog>
  )
}

const CommandInput = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Input>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>
>(({ className, ...props }, ref) => (
  <div className="flex items-center border-b px-3" cmdk-input-wrapper="">
    <Search className="mr-2 h-4 w-4 shrink-0 opacity-50" />
    <CommandPrimitive.Input
      ref={ref}
      className={cn(
        'flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50',
        className,
      )}
      {...props}
    />
  </div>
))

CommandInput.displayName = CommandPrimitive.Input.displayName

const CommandList = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.List
    ref={ref}
    className={cn('max-h-[300px] overflow-y-auto overflow-x-hidden', className)}
    {...props}
  />
))

CommandList.displayName = CommandPrimitive.List.displayName

const CommandEmpty = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Empty>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>
>((props, ref) => (
  <CommandPrimitive.Empty
    ref={ref}
    className="py-6 text-center text-sm"
    {...props}
  />
))

CommandEmpty.displayName = CommandPrimitive.Empty.displayName

const CommandGroup = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Group>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Group
    ref={ref}
    className={cn(
      'overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground',
      className,
    )}
    {...props}
  />
))

CommandGroup.displayName = CommandPrimitive.Group.displayName

const CommandSeparator = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 h-px bg-border', className)}
    {...props}
  />
))
CommandSeparator.displayName = CommandPrimitive.Separator.displayName

const CommandItem = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",
      className,
    )}
    {...props}
  />
))

CommandItem.displayName = CommandPrimitive.Item.displayName

const CommandShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn(
        'ml-auto text-xs tracking-widest text-muted-foreground',
        className,
      )}
      {...props}
    />
  )
}
CommandShortcut.displayName = 'CommandShortcut'

export {
  Command,
  CommandDialog,
  CommandInput,
  CommandList,
  CommandEmpty,
  CommandGroup,
  CommandItem,
  CommandShortcut,
  CommandSeparator,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\context-menu.tsx
import * as React from 'react'
import * as ContextMenuPrimitive from '@radix-ui/react-context-menu'
import { Check, ChevronRight, Circle } from 'lucide-react'

import { cn } from '@/lib/utils'

const ContextMenu = ContextMenuPrimitive.Root

const ContextMenuTrigger = ContextMenuPrimitive.Trigger

const ContextMenuGroup = ContextMenuPrimitive.Group

const ContextMenuPortal = ContextMenuPrimitive.Portal

const ContextMenuSub = ContextMenuPrimitive.Sub

const ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup

const ContextMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {
    inset?: boolean
  }
>(({ className, inset, children, ...props }, ref) => (
  <ContextMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      'flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground',
      inset && 'pl-8',
      className,
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </ContextMenuPrimitive.SubTrigger>
))
ContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName

const ContextMenuSubContent = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
      className,
    )}
    {...props}
  />
))
ContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName

const ContextMenuContent = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.Portal>
    <ContextMenuPrimitive.Content
      ref={ref}
      className={cn(
        'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
        className,
      )}
      {...props}
    />
  </ContextMenuPrimitive.Portal>
))
ContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName

const ContextMenuItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {
    inset?: boolean
  }
>(({ className, inset, ...props }, ref) => (
  <ContextMenuPrimitive.Item
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      inset && 'pl-8',
      className,
    )}
    {...props}
  />
))
ContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName

const ContextMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <ContextMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className,
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <ContextMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </ContextMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </ContextMenuPrimitive.CheckboxItem>
))
ContextMenuCheckboxItem.displayName =
  ContextMenuPrimitive.CheckboxItem.displayName

const ContextMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <ContextMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <ContextMenuPrimitive.ItemIndicator>
        <Circle className="h-4 w-4 fill-current" />
      </ContextMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </ContextMenuPrimitive.RadioItem>
))
ContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName

const ContextMenuLabel = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {
    inset?: boolean
  }
>(({ className, inset, ...props }, ref) => (
  <ContextMenuPrimitive.Label
    ref={ref}
    className={cn(
      'px-2 py-1.5 text-sm font-semibold text-foreground',
      inset && 'pl-8',
      className,
    )}
    {...props}
  />
))
ContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName

const ContextMenuSeparator = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 my-1 h-px bg-border', className)}
    {...props}
  />
))
ContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName

const ContextMenuShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn(
        'ml-auto text-xs tracking-widest text-muted-foreground',
        className,
      )}
      {...props}
    />
  )
}
ContextMenuShortcut.displayName = 'ContextMenuShortcut'

export {
  ContextMenu,
  ContextMenuTrigger,
  ContextMenuContent,
  ContextMenuItem,
  ContextMenuCheckboxItem,
  ContextMenuRadioItem,
  ContextMenuLabel,
  ContextMenuSeparator,
  ContextMenuShortcut,
  ContextMenuGroup,
  ContextMenuPortal,
  ContextMenuSub,
  ContextMenuSubContent,
  ContextMenuSubTrigger,
  ContextMenuRadioGroup,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\copy-button.tsx
import { Button } from '@/components/ui/button'
import { Copy, Check } from 'lucide-react'
import { useState } from 'react'
import { useToast } from '@/hooks/use-toast'

interface CopyButtonProps {
  text: string
  onCopy?: () => void
  className?: string
}

export const CopyButton = ({ text, onCopy, className }: CopyButtonProps) => {
  const [copied, setCopied] = useState(false)
  const { toast } = useToast()

  const handleCopy = async () => {
    try {
      await navigator.clipboard.writeText(text)
      setCopied(true)
      toast({
        title: 'Copiado',
        description: 'La información ha sido copiada al portapapeles',
      })
      onCopy?.()
      setTimeout(() => setCopied(false), 2000)
    } catch (err) {
      toast({
        title: 'Error',
        description: 'No se pudo copiar al portapapeles',
        variant: 'destructive',
      })
    }
  }

  return (
    <Button
      variant="outline"
      size="sm"
      className={className}
      onClick={handleCopy}
    >
      {copied ? (
        <Check className="h-4 w-4 text-green-500" />
      ) : (
        <Copy className="h-4 w-4" />
      )}
      <span className="ml-2">{copied ? 'Copiado' : 'Copiar'}</span>
    </Button>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\dialog.tsx
import * as React from 'react'
import * as DialogPrimitive from '@radix-ui/react-dialog'
import { X } from 'lucide-react'

import { cn } from '@/lib/utils'

const Dialog = DialogPrimitive.Root

const DialogTrigger = DialogPrimitive.Trigger

const DialogPortal = DialogPrimitive.Portal

const DialogClose = DialogPrimitive.Close

const DialogOverlay = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Overlay
    ref={ref}
    className={cn(
      'fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',
      className,
    )}
    {...props}
  />
))
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName

const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        'fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg',
        className,
      )}
      {...props}
    >
      {children}
      <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </DialogPrimitive.Close>
    </DialogPrimitive.Content>
  </DialogPortal>
))
DialogContent.displayName = DialogPrimitive.Content.displayName

const DialogHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col space-y-1.5 text-center sm:text-left',
      className,
    )}
    {...props}
  />
)
DialogHeader.displayName = 'DialogHeader'

const DialogFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2',
      className,
    )}
    {...props}
  />
)
DialogFooter.displayName = 'DialogFooter'

const DialogTitle = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Title
    ref={ref}
    className={cn(
      'text-lg font-semibold leading-none tracking-tight',
      className,
    )}
    {...props}
  />
))
DialogTitle.displayName = DialogPrimitive.Title.displayName

const DialogDescription = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Description
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
))
DialogDescription.displayName = DialogPrimitive.Description.displayName

export {
  Dialog,
  DialogPortal,
  DialogOverlay,
  DialogClose,
  DialogTrigger,
  DialogContent,
  DialogHeader,
  DialogFooter,
  DialogTitle,
  DialogDescription,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\drawer.tsx
import * as React from 'react'
import { Drawer as DrawerPrimitive } from 'vaul'

import { cn } from '@/lib/utils'

const Drawer = ({
  shouldScaleBackground = true,
  ...props
}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (
  <DrawerPrimitive.Root
    shouldScaleBackground={shouldScaleBackground}
    {...props}
  />
)
Drawer.displayName = 'Drawer'

const DrawerTrigger = DrawerPrimitive.Trigger

const DrawerPortal = DrawerPrimitive.Portal

const DrawerClose = DrawerPrimitive.Close

const DrawerOverlay = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Overlay
    ref={ref}
    className={cn('fixed inset-0 z-50 bg-black/80', className)}
    {...props}
  />
))
DrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName

const DrawerContent = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DrawerPortal>
    <DrawerOverlay />
    <DrawerPrimitive.Content
      ref={ref}
      className={cn(
        'fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background',
        className,
      )}
      {...props}
    >
      <div className="mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted" />
      {children}
    </DrawerPrimitive.Content>
  </DrawerPortal>
))
DrawerContent.displayName = 'DrawerContent'

const DrawerHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn('grid gap-1.5 p-4 text-center sm:text-left', className)}
    {...props}
  />
)
DrawerHeader.displayName = 'DrawerHeader'

const DrawerFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn('mt-auto flex flex-col gap-2 p-4', className)}
    {...props}
  />
)
DrawerFooter.displayName = 'DrawerFooter'

const DrawerTitle = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Title
    ref={ref}
    className={cn(
      'text-lg font-semibold leading-none tracking-tight',
      className,
    )}
    {...props}
  />
))
DrawerTitle.displayName = DrawerPrimitive.Title.displayName

const DrawerDescription = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Description
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
))
DrawerDescription.displayName = DrawerPrimitive.Description.displayName

export {
  Drawer,
  DrawerPortal,
  DrawerOverlay,
  DrawerTrigger,
  DrawerClose,
  DrawerContent,
  DrawerHeader,
  DrawerFooter,
  DrawerTitle,
  DrawerDescription,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\dropdown-menu.tsx
import * as React from 'react'
import * as DropdownMenuPrimitive from '@radix-ui/react-dropdown-menu'
import { Check, ChevronRight, Circle } from 'lucide-react'

import { cn } from '@/lib/utils'

const DropdownMenu = DropdownMenuPrimitive.Root

const DropdownMenuTrigger = DropdownMenuPrimitive.Trigger

const DropdownMenuGroup = DropdownMenuPrimitive.Group

const DropdownMenuPortal = DropdownMenuPrimitive.Portal

const DropdownMenuSub = DropdownMenuPrimitive.Sub

const DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup

const DropdownMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {
    inset?: boolean
  }
>(({ className, inset, children, ...props }, ref) => (
  <DropdownMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      'flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent',
      inset && 'pl-8',
      className,
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </DropdownMenuPrimitive.SubTrigger>
))
DropdownMenuSubTrigger.displayName =
  DropdownMenuPrimitive.SubTrigger.displayName

const DropdownMenuSubContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
      className,
    )}
    {...props}
  />
))
DropdownMenuSubContent.displayName =
  DropdownMenuPrimitive.SubContent.displayName

const DropdownMenuContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <DropdownMenuPrimitive.Portal>
    <DropdownMenuPrimitive.Content
      ref={ref}
      sideOffset={sideOffset}
      className={cn(
        'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
        className,
      )}
      {...props}
    />
  </DropdownMenuPrimitive.Portal>
))
DropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName

const DropdownMenuItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {
    inset?: boolean
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Item
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      inset && 'pl-8',
      className,
    )}
    {...props}
  />
))
DropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName

const DropdownMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <DropdownMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className,
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.CheckboxItem>
))
DropdownMenuCheckboxItem.displayName =
  DropdownMenuPrimitive.CheckboxItem.displayName

const DropdownMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <DropdownMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Circle className="h-4 w-4 fill-current" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.RadioItem>
))
DropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName

const DropdownMenuLabel = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {
    inset?: boolean
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Label
    ref={ref}
    className={cn(
      'px-2 py-1.5 text-sm font-semibold',
      inset && 'pl-8',
      className,
    )}
    {...props}
  />
))
DropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName

const DropdownMenuSeparator = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 my-1 h-px bg-muted', className)}
    {...props}
  />
))
DropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName

const DropdownMenuShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn('ml-auto text-xs tracking-widest opacity-60', className)}
      {...props}
    />
  )
}
DropdownMenuShortcut.displayName = 'DropdownMenuShortcut'

export {
  DropdownMenu,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuGroup,
  DropdownMenuPortal,
  DropdownMenuSub,
  DropdownMenuSubContent,
  DropdownMenuSubTrigger,
  DropdownMenuRadioGroup,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\form.tsx
import * as React from 'react'
import * as LabelPrimitive from '@radix-ui/react-label'
import { Slot } from '@radix-ui/react-slot'
import {
  Controller,
  ControllerProps,
  FieldPath,
  FieldValues,
  FormProvider,
  useFormContext,
} from 'react-hook-form'

import { cn } from '@/lib/utils'
import { Label } from '@/components/ui/label'

const Form = FormProvider

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
> = {
  name: TName
}

const FormFieldContext = React.createContext<FormFieldContextValue>(
  {} as FormFieldContextValue,
)

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>,
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  )
}

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext)
  const itemContext = React.useContext(FormItemContext)
  const { getFieldState, formState } = useFormContext()

  const fieldState = getFieldState(fieldContext.name, formState)

  if (!fieldContext) {
    throw new Error('useFormField should be used within <FormField>')
  }

  const { id } = itemContext

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  }
}

type FormItemContextValue = {
  id: string
}

const FormItemContext = React.createContext<FormItemContextValue>(
  {} as FormItemContextValue,
)

const FormItem = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const id = React.useId()

  return (
    <FormItemContext.Provider value={{ id }}>
      <div ref={ref} className={cn('space-y-2', className)} {...props} />
    </FormItemContext.Provider>
  )
})
FormItem.displayName = 'FormItem'

const FormLabel = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>
>(({ className, ...props }, ref) => {
  const { error, formItemId } = useFormField()

  return (
    <Label
      ref={ref}
      className={cn(error && 'text-destructive', className)}
      htmlFor={formItemId}
      {...props}
    />
  )
})
FormLabel.displayName = 'FormLabel'

const FormControl = React.forwardRef<
  React.ElementRef<typeof Slot>,
  React.ComponentPropsWithoutRef<typeof Slot>
>(({ ...props }, ref) => {
  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()

  return (
    <Slot
      ref={ref}
      id={formItemId}
      aria-describedby={
        !error
          ? `${formDescriptionId}`
          : `${formDescriptionId} ${formMessageId}`
      }
      aria-invalid={!!error}
      {...props}
    />
  )
})
FormControl.displayName = 'FormControl'

const FormDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => {
  const { formDescriptionId } = useFormField()

  return (
    <p
      ref={ref}
      id={formDescriptionId}
      className={cn('text-sm text-muted-foreground', className)}
      {...props}
    />
  )
})
FormDescription.displayName = 'FormDescription'

const FormMessage = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, children, ...props }, ref) => {
  const { error, formMessageId } = useFormField()
  const body = error ? String(error?.message) : children

  if (!body) {
    return null
  }

  return (
    <p
      ref={ref}
      id={formMessageId}
      className={cn('text-sm font-medium text-destructive', className)}
      {...props}
    >
      {body}
    </p>
  )
})
FormMessage.displayName = 'FormMessage'

export {
  useFormField,
  Form,
  FormItem,
  FormLabel,
  FormControl,
  FormDescription,
  FormMessage,
  FormField,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\hover-card.tsx
import * as React from 'react'
import * as HoverCardPrimitive from '@radix-ui/react-hover-card'

import { cn } from '@/lib/utils'

const HoverCard = HoverCardPrimitive.Root

const HoverCardTrigger = HoverCardPrimitive.Trigger

const HoverCardContent = React.forwardRef<
  React.ElementRef<typeof HoverCardPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>
>(({ className, align = 'center', sideOffset = 4, ...props }, ref) => (
  <HoverCardPrimitive.Content
    ref={ref}
    align={align}
    sideOffset={sideOffset}
    className={cn(
      'z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
      className,
    )}
    {...props}
  />
))
HoverCardContent.displayName = HoverCardPrimitive.Content.displayName

export { HoverCard, HoverCardTrigger, HoverCardContent }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\input-otp.tsx
import * as React from 'react'
import { OTPInput, OTPInputContext } from 'input-otp'
import { Dot } from 'lucide-react'

import { cn } from '@/lib/utils'

const InputOTP = React.forwardRef<
  React.ElementRef<typeof OTPInput>,
  React.ComponentPropsWithoutRef<typeof OTPInput>
>(({ className, containerClassName, ...props }, ref) => (
  <OTPInput
    ref={ref}
    containerClassName={cn(
      'flex items-center gap-2 has-[:disabled]:opacity-50',
      containerClassName,
    )}
    className={cn('disabled:cursor-not-allowed', className)}
    {...props}
  />
))
InputOTP.displayName = 'InputOTP'

const InputOTPGroup = React.forwardRef<
  React.ElementRef<'div'>,
  React.ComponentPropsWithoutRef<'div'>
>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn('flex items-center', className)} {...props} />
))
InputOTPGroup.displayName = 'InputOTPGroup'

const InputOTPSlot = React.forwardRef<
  React.ElementRef<'div'>,
  React.ComponentPropsWithoutRef<'div'> & { index: number }
>(({ index, className, ...props }, ref) => {
  const inputOTPContext = React.useContext(OTPInputContext)
  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]

  return (
    <div
      ref={ref}
      className={cn(
        'relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md',
        isActive && 'z-10 ring-2 ring-ring ring-offset-background',
        className,
      )}
      {...props}
    >
      {char}
      {hasFakeCaret && (
        <div className="pointer-events-none absolute inset-0 flex items-center justify-center">
          <div className="h-4 w-px animate-caret-blink bg-foreground duration-1000" />
        </div>
      )}
    </div>
  )
})
InputOTPSlot.displayName = 'InputOTPSlot'

const InputOTPSeparator = React.forwardRef<
  React.ElementRef<'div'>,
  React.ComponentPropsWithoutRef<'div'>
>(({ ...props }, ref) => (
  <div ref={ref} role="separator" {...props}>
    <Dot />
  </div>
))
InputOTPSeparator.displayName = 'InputOTPSeparator'

export { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\input.tsx
import * as React from 'react'
import { cn } from '@/lib/utils'

export interface InputProps
  extends React.InputHTMLAttributes<HTMLInputElement> {}

const Input = React.forwardRef<HTMLInputElement, InputProps>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          'flex h-10 w-full rounded-lg border border-input bg-background px-4 py-2',
          'text-sm ring-offset-background transition-colors duration-200',
          'placeholder:text-muted-foreground/60',
          'focus:border-primary focus:ring-2 focus:ring-primary/20 focus:outline-none',
          'disabled:cursor-not-allowed disabled:opacity-50',
          'file:border-0 file:bg-transparent file:text-sm file:font-medium',
          className,
        )}
        ref={ref}
        {...props}
      />
    )
  },
)
Input.displayName = 'Input'

export { Input }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\label.tsx
import * as React from 'react'
import * as LabelPrimitive from '@radix-ui/react-label'
import { cva, type VariantProps } from 'class-variance-authority'

import { cn } from '@/lib/utils'

const labelVariants = cva(
  'text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 transition-colors duration-200',
  {
    variants: {
      variant: {
        default: 'text-foreground',
        secondary: 'text-muted-foreground',
        primary: 'text-primary',
      },
    },
    defaultVariants: {
      variant: 'default',
    },
  },
)

const Label = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &
    VariantProps<typeof labelVariants>
>(({ className, variant, ...props }, ref) => (
  <LabelPrimitive.Root
    ref={ref}
    className={cn(labelVariants({ variant }), className)}
    {...props}
  />
))
Label.displayName = LabelPrimitive.Root.displayName

export { Label }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\menubar.tsx
import * as React from 'react'
import * as MenubarPrimitive from '@radix-ui/react-menubar'
import { Check, ChevronRight, Circle } from 'lucide-react'

import { cn } from '@/lib/utils'

const MenubarMenu = MenubarPrimitive.Menu

const MenubarGroup = MenubarPrimitive.Group

const MenubarPortal = MenubarPrimitive.Portal

const MenubarSub = MenubarPrimitive.Sub

const MenubarRadioGroup = MenubarPrimitive.RadioGroup

const Menubar = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Root
    ref={ref}
    className={cn(
      'flex h-10 items-center space-x-1 rounded-md border bg-background p-1',
      className,
    )}
    {...props}
  />
))
Menubar.displayName = MenubarPrimitive.Root.displayName

const MenubarTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Trigger
    ref={ref}
    className={cn(
      'flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground',
      className,
    )}
    {...props}
  />
))
MenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName

const MenubarSubTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {
    inset?: boolean
  }
>(({ className, inset, children, ...props }, ref) => (
  <MenubarPrimitive.SubTrigger
    ref={ref}
    className={cn(
      'flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground',
      inset && 'pl-8',
      className,
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </MenubarPrimitive.SubTrigger>
))
MenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName

const MenubarSubContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.SubContent
    ref={ref}
    className={cn(
      'z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
      className,
    )}
    {...props}
  />
))
MenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName

const MenubarContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>
>(
  (
    { className, align = 'start', alignOffset = -4, sideOffset = 8, ...props },
    ref,
  ) => (
    <MenubarPrimitive.Portal>
      <MenubarPrimitive.Content
        ref={ref}
        align={align}
        alignOffset={alignOffset}
        sideOffset={sideOffset}
        className={cn(
          'z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
          className,
        )}
        {...props}
      />
    </MenubarPrimitive.Portal>
  ),
)
MenubarContent.displayName = MenubarPrimitive.Content.displayName

const MenubarItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {
    inset?: boolean
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Item
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      inset && 'pl-8',
      className,
    )}
    {...props}
  />
))
MenubarItem.displayName = MenubarPrimitive.Item.displayName

const MenubarCheckboxItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <MenubarPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className,
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.CheckboxItem>
))
MenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName

const MenubarRadioItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <MenubarPrimitive.RadioItem
    ref={ref}
    className={cn(
      'relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Circle className="h-4 w-4 fill-current" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.RadioItem>
))
MenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName

const MenubarLabel = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {
    inset?: boolean
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Label
    ref={ref}
    className={cn(
      'px-2 py-1.5 text-sm font-semibold',
      inset && 'pl-8',
      className,
    )}
    {...props}
  />
))
MenubarLabel.displayName = MenubarPrimitive.Label.displayName

const MenubarSeparator = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 my-1 h-px bg-muted', className)}
    {...props}
  />
))
MenubarSeparator.displayName = MenubarPrimitive.Separator.displayName

const MenubarShortcut = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLSpanElement>) => {
  return (
    <span
      className={cn(
        'ml-auto text-xs tracking-widest text-muted-foreground',
        className,
      )}
      {...props}
    />
  )
}
MenubarShortcut.displayname = 'MenubarShortcut'

export {
  Menubar,
  MenubarMenu,
  MenubarTrigger,
  MenubarContent,
  MenubarItem,
  MenubarSeparator,
  MenubarLabel,
  MenubarCheckboxItem,
  MenubarRadioGroup,
  MenubarRadioItem,
  MenubarPortal,
  MenubarSubContent,
  MenubarSubTrigger,
  MenubarGroup,
  MenubarSub,
  MenubarShortcut,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\navigation-menu.tsx
import * as React from 'react'
import * as NavigationMenuPrimitive from '@radix-ui/react-navigation-menu'
import { cva } from 'class-variance-authority'
import { ChevronDown } from 'lucide-react'

import { cn } from '@/lib/utils'

const NavigationMenu = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <NavigationMenuPrimitive.Root
    ref={ref}
    className={cn(
      'relative z-10 flex max-w-max flex-1 items-center justify-center',
      className,
    )}
    {...props}
  >
    {children}
    <NavigationMenuViewport />
  </NavigationMenuPrimitive.Root>
))
NavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName

const NavigationMenuList = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.List
    ref={ref}
    className={cn(
      'group flex flex-1 list-none items-center justify-center space-x-1',
      className,
    )}
    {...props}
  />
))
NavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName

const NavigationMenuItem = NavigationMenuPrimitive.Item

const navigationMenuTriggerStyle = cva(
  'group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50',
)

const NavigationMenuTrigger = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <NavigationMenuPrimitive.Trigger
    ref={ref}
    className={cn(navigationMenuTriggerStyle(), 'group', className)}
    {...props}
  >
    {children}{' '}
    <ChevronDown
      className="relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180"
      aria-hidden="true"
    />
  </NavigationMenuPrimitive.Trigger>
))
NavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName

const NavigationMenuContent = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.Content
    ref={ref}
    className={cn(
      'left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto ',
      className,
    )}
    {...props}
  />
))
NavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName

const NavigationMenuLink = NavigationMenuPrimitive.Link

const NavigationMenuViewport = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>
>(({ className, ...props }, ref) => (
  <div className={cn('absolute left-0 top-full flex justify-center')}>
    <NavigationMenuPrimitive.Viewport
      className={cn(
        'origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]',
        className,
      )}
      ref={ref}
      {...props}
    />
  </div>
))
NavigationMenuViewport.displayName =
  NavigationMenuPrimitive.Viewport.displayName

const NavigationMenuIndicator = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.Indicator
    ref={ref}
    className={cn(
      'top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in',
      className,
    )}
    {...props}
  >
    <div className="relative top-[60%] h-4 w-4 rotate-45 rounded-tl-sm bg-border shadow-md" />
  </NavigationMenuPrimitive.Indicator>
))
NavigationMenuIndicator.displayName =
  NavigationMenuPrimitive.Indicator.displayName

export {
  navigationMenuTriggerStyle,
  NavigationMenu,
  NavigationMenuList,
  NavigationMenuItem,
  NavigationMenuContent,
  NavigationMenuTrigger,
  NavigationMenuLink,
  NavigationMenuIndicator,
  NavigationMenuViewport,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\pagination.tsx
import * as React from 'react'
import { ChevronLeft, ChevronRight, MoreHorizontal } from 'lucide-react'

import { cn } from '@/lib/utils'
import { ButtonProps, buttonVariants } from '@/components/ui/button'

const Pagination = ({ className, ...props }: React.ComponentProps<'nav'>) => (
  <nav
    role="navigation"
    aria-label="pagination"
    className={cn('mx-auto flex w-full justify-center', className)}
    {...props}
  />
)
Pagination.displayName = 'Pagination'

const PaginationContent = React.forwardRef<
  HTMLUListElement,
  React.ComponentProps<'ul'>
>(({ className, ...props }, ref) => (
  <ul
    ref={ref}
    className={cn('flex flex-row items-center gap-1', className)}
    {...props}
  />
))
PaginationContent.displayName = 'PaginationContent'

const PaginationItem = React.forwardRef<
  HTMLLIElement,
  React.ComponentProps<'li'>
>(({ className, ...props }, ref) => (
  <li ref={ref} className={cn('', className)} {...props} />
))
PaginationItem.displayName = 'PaginationItem'

type PaginationLinkProps = {
  isActive?: boolean
} & Pick<ButtonProps, 'size'> &
  React.ComponentProps<'a'>

const PaginationLink = ({
  className,
  isActive,
  size = 'icon',
  ...props
}: PaginationLinkProps) => (
  <a
    aria-current={isActive ? 'page' : undefined}
    className={cn(
      buttonVariants({
        variant: isActive ? 'outline' : 'ghost',
        size,
      }),
      className,
    )}
    {...props}
  />
)
PaginationLink.displayName = 'PaginationLink'

const PaginationPrevious = ({
  className,
  ...props
}: React.ComponentProps<typeof PaginationLink>) => (
  <PaginationLink
    aria-label="Go to previous page"
    size="default"
    className={cn('gap-1 pl-2.5', className)}
    {...props}
  >
    <ChevronLeft className="h-4 w-4" />
    <span>Previous</span>
  </PaginationLink>
)
PaginationPrevious.displayName = 'PaginationPrevious'

const PaginationNext = ({
  className,
  ...props
}: React.ComponentProps<typeof PaginationLink>) => (
  <PaginationLink
    aria-label="Go to next page"
    size="default"
    className={cn('gap-1 pr-2.5', className)}
    {...props}
  >
    <span>Next</span>
    <ChevronRight className="h-4 w-4" />
  </PaginationLink>
)
PaginationNext.displayName = 'PaginationNext'

const PaginationEllipsis = ({
  className,
  ...props
}: React.ComponentProps<'span'>) => (
  <span
    aria-hidden
    className={cn('flex h-9 w-9 items-center justify-center', className)}
    {...props}
  >
    <MoreHorizontal className="h-4 w-4" />
    <span className="sr-only">More pages</span>
  </span>
)
PaginationEllipsis.displayName = 'PaginationEllipsis'

export {
  Pagination,
  PaginationContent,
  PaginationEllipsis,
  PaginationItem,
  PaginationLink,
  PaginationNext,
  PaginationPrevious,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\popover.tsx
import * as React from 'react'
import * as PopoverPrimitive from '@radix-ui/react-popover'

import { cn } from '@/lib/utils'

const Popover = PopoverPrimitive.Root

const PopoverTrigger = PopoverPrimitive.Trigger

const PopoverContent = React.forwardRef<
  React.ElementRef<typeof PopoverPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>
>(({ className, align = 'center', sideOffset = 4, ...props }, ref) => (
  <PopoverPrimitive.Portal>
    <PopoverPrimitive.Content
      ref={ref}
      align={align}
      sideOffset={sideOffset}
      className={cn(
        'z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
        className,
      )}
      {...props}
    />
  </PopoverPrimitive.Portal>
))
PopoverContent.displayName = PopoverPrimitive.Content.displayName

export { Popover, PopoverTrigger, PopoverContent }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\progress.tsx
import * as React from 'react'
import * as ProgressPrimitive from '@radix-ui/react-progress'

import { cn } from '@/lib/utils'

const Progress = React.forwardRef<
  React.ElementRef<typeof ProgressPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>
>(({ className, value, ...props }, ref) => (
  <ProgressPrimitive.Root
    ref={ref}
    className={cn(
      'relative h-4 w-full overflow-hidden rounded-full bg-secondary',
      className,
    )}
    {...props}
  >
    <ProgressPrimitive.Indicator
      className="h-full w-full flex-1 bg-primary transition-all"
      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
    />
  </ProgressPrimitive.Root>
))
Progress.displayName = ProgressPrimitive.Root.displayName

export { Progress }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\radio-group.tsx
import * as React from 'react'
import * as RadioGroupPrimitive from '@radix-ui/react-radio-group'
import { Circle } from 'lucide-react'

import { cn } from '@/lib/utils'

const RadioGroup = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>
>(({ className, ...props }, ref) => {
  return (
    <RadioGroupPrimitive.Root
      className={cn('grid gap-2', className)}
      {...props}
      ref={ref}
    />
  )
})
RadioGroup.displayName = RadioGroupPrimitive.Root.displayName

const RadioGroupItem = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>
>(({ className, ...props }, ref) => {
  return (
    <RadioGroupPrimitive.Item
      ref={ref}
      className={cn(
        'aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50',
        className,
      )}
      {...props}
    >
      <RadioGroupPrimitive.Indicator className="flex items-center justify-center">
        <Circle className="h-2.5 w-2.5 fill-current text-current" />
      </RadioGroupPrimitive.Indicator>
    </RadioGroupPrimitive.Item>
  )
})
RadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName

export { RadioGroup, RadioGroupItem }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\resizable.tsx
import { GripVertical } from 'lucide-react'
import * as ResizablePrimitive from 'react-resizable-panels'

import { cn } from '@/lib/utils'

const ResizablePanelGroup = ({
  className,
  ...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (
  <ResizablePrimitive.PanelGroup
    className={cn(
      'flex h-full w-full data-[panel-group-direction=vertical]:flex-col',
      className,
    )}
    {...props}
  />
)

const ResizablePanel = ResizablePrimitive.Panel

const ResizableHandle = ({
  withHandle,
  className,
  ...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {
  withHandle?: boolean
}) => (
  <ResizablePrimitive.PanelResizeHandle
    className={cn(
      'relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90',
      className,
    )}
    {...props}
  >
    {withHandle && (
      <div className="z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border">
        <GripVertical className="h-2.5 w-2.5" />
      </div>
    )}
  </ResizablePrimitive.PanelResizeHandle>
)

export { ResizablePanelGroup, ResizablePanel, ResizableHandle }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\scroll-area.tsx
import * as React from 'react'
import * as ScrollAreaPrimitive from '@radix-ui/react-scroll-area'

import { cn } from '@/lib/utils'

const ScrollArea = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <ScrollAreaPrimitive.Root
    ref={ref}
    className={cn('relative overflow-hidden', className)}
    {...props}
  >
    <ScrollAreaPrimitive.Viewport className="h-full w-full rounded-[inherit]">
      {children}
    </ScrollAreaPrimitive.Viewport>
    <ScrollBar />
    <ScrollAreaPrimitive.Corner />
  </ScrollAreaPrimitive.Root>
))
ScrollArea.displayName = ScrollAreaPrimitive.Root.displayName

const ScrollBar = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>
>(({ className, orientation = 'vertical', ...props }, ref) => (
  <ScrollAreaPrimitive.ScrollAreaScrollbar
    ref={ref}
    orientation={orientation}
    className={cn(
      'flex touch-none select-none transition-colors',
      orientation === 'vertical' &&
        'h-full w-2.5 border-l border-l-transparent p-[1px]',
      orientation === 'horizontal' &&
        'h-2.5 flex-col border-t border-t-transparent p-[1px]',
      className,
    )}
    {...props}
  >
    <ScrollAreaPrimitive.ScrollAreaThumb className="relative flex-1 rounded-full bg-border" />
  </ScrollAreaPrimitive.ScrollAreaScrollbar>
))
ScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName

export { ScrollArea, ScrollBar }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\select.tsx
import * as React from 'react'
import * as SelectPrimitive from '@radix-ui/react-select'
import { Check, ChevronDown, ChevronUp } from 'lucide-react'

import { cn } from '@/lib/utils'

const Select = SelectPrimitive.Root

const SelectGroup = SelectPrimitive.Group

const SelectValue = SelectPrimitive.Value

const SelectTrigger = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Trigger
    ref={ref}
    className={cn(
      'flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1',
      className,
    )}
    {...props}
  >
    {children}
    <SelectPrimitive.Icon asChild>
      <ChevronDown className="h-4 w-4 opacity-50" />
    </SelectPrimitive.Icon>
  </SelectPrimitive.Trigger>
))
SelectTrigger.displayName = SelectPrimitive.Trigger.displayName

const SelectScrollUpButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollUpButton
    ref={ref}
    className={cn(
      'flex cursor-default items-center justify-center py-1',
      className,
    )}
    {...props}
  >
    <ChevronUp className="h-4 w-4" />
  </SelectPrimitive.ScrollUpButton>
))
SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName

const SelectScrollDownButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollDownButton
    ref={ref}
    className={cn(
      'flex cursor-default items-center justify-center py-1',
      className,
    )}
    {...props}
  >
    <ChevronDown className="h-4 w-4" />
  </SelectPrimitive.ScrollDownButton>
))
SelectScrollDownButton.displayName =
  SelectPrimitive.ScrollDownButton.displayName

const SelectContent = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>
>(({ className, children, position = 'popper', ...props }, ref) => (
  <SelectPrimitive.Portal>
    <SelectPrimitive.Content
      ref={ref}
      className={cn(
        'relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
        position === 'popper' &&
          'data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1',
        className,
      )}
      position={position}
      {...props}
    >
      <SelectScrollUpButton />
      <SelectPrimitive.Viewport
        className={cn(
          'p-1',
          position === 'popper' &&
            'h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]',
        )}
      >
        {children}
      </SelectPrimitive.Viewport>
      <SelectScrollDownButton />
    </SelectPrimitive.Content>
  </SelectPrimitive.Portal>
))
SelectContent.displayName = SelectPrimitive.Content.displayName

const SelectLabel = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Label
    ref={ref}
    className={cn('py-1.5 pl-8 pr-2 text-sm font-semibold', className)}
    {...props}
  />
))
SelectLabel.displayName = SelectPrimitive.Label.displayName

const SelectItem = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Item
    ref={ref}
    className={cn(
      'relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50',
      className,
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <SelectPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </SelectPrimitive.ItemIndicator>
    </span>

    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
  </SelectPrimitive.Item>
))
SelectItem.displayName = SelectPrimitive.Item.displayName

const SelectSeparator = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Separator
    ref={ref}
    className={cn('-mx-1 my-1 h-px bg-muted', className)}
    {...props}
  />
))
SelectSeparator.displayName = SelectPrimitive.Separator.displayName

export {
  Select,
  SelectGroup,
  SelectValue,
  SelectTrigger,
  SelectContent,
  SelectLabel,
  SelectItem,
  SelectSeparator,
  SelectScrollUpButton,
  SelectScrollDownButton,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\separator.tsx
import * as React from 'react'
import * as SeparatorPrimitive from '@radix-ui/react-separator'

import { cn } from '@/lib/utils'

const Separator = React.forwardRef<
  React.ElementRef<typeof SeparatorPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>
>(
  (
    { className, orientation = 'horizontal', decorative = true, ...props },
    ref,
  ) => (
    <SeparatorPrimitive.Root
      ref={ref}
      decorative={decorative}
      orientation={orientation}
      className={cn(
        'shrink-0 bg-border',
        orientation === 'horizontal' ? 'h-[1px] w-full' : 'h-full w-[1px]',
        className,
      )}
      {...props}
    />
  ),
)
Separator.displayName = SeparatorPrimitive.Root.displayName

export { Separator }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\sheet.tsx
import * as React from 'react'
import * as SheetPrimitive from '@radix-ui/react-dialog'
import { cva, type VariantProps } from 'class-variance-authority'
import { X } from 'lucide-react'

import { cn } from '@/lib/utils'

const Sheet = SheetPrimitive.Root

const SheetTrigger = SheetPrimitive.Trigger

const SheetClose = SheetPrimitive.Close

const SheetPortal = SheetPrimitive.Portal

const SheetOverlay = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Overlay
    className={cn(
      'fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',
      className,
    )}
    {...props}
    ref={ref}
  />
))
SheetOverlay.displayName = SheetPrimitive.Overlay.displayName

const sheetVariants = cva(
  'fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500',
  {
    variants: {
      side: {
        top: 'inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top',
        bottom:
          'inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom',
        left: 'inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm',
        right:
          'inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm',
      },
    },
    defaultVariants: {
      side: 'right',
    },
  },
)

interface SheetContentProps
  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,
    VariantProps<typeof sheetVariants> {}

const SheetContent = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Content>,
  SheetContentProps
>(({ side = 'right', className, children, ...props }, ref) => (
  <SheetPortal>
    <SheetOverlay />
    <SheetPrimitive.Content
      ref={ref}
      className={cn(sheetVariants({ side }), className)}
      {...props}
    >
      {children}
      <SheetPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </SheetPrimitive.Close>
    </SheetPrimitive.Content>
  </SheetPortal>
))
SheetContent.displayName = SheetPrimitive.Content.displayName

const SheetHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col space-y-2 text-center sm:text-left',
      className,
    )}
    {...props}
  />
)
SheetHeader.displayName = 'SheetHeader'

const SheetFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn(
      'flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2',
      className,
    )}
    {...props}
  />
)
SheetFooter.displayName = 'SheetFooter'

const SheetTitle = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Title
    ref={ref}
    className={cn('text-lg font-semibold text-foreground', className)}
    {...props}
  />
))
SheetTitle.displayName = SheetPrimitive.Title.displayName

const SheetDescription = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Description
    ref={ref}
    className={cn('text-sm text-muted-foreground', className)}
    {...props}
  />
))
SheetDescription.displayName = SheetPrimitive.Description.displayName

export {
  Sheet,
  SheetPortal,
  SheetOverlay,
  SheetTrigger,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetFooter,
  SheetTitle,
  SheetDescription,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\skeleton.tsx
import { cn } from '@/lib/utils'

function Skeleton({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) {
  return (
    <div
      className={cn('animate-pulse rounded-md bg-muted', className)}
      {...props}
    />
  )
}

export { Skeleton }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\slider.tsx
import * as React from 'react'
import * as SliderPrimitive from '@radix-ui/react-slider'

import { cn } from '@/lib/utils'

const Slider = React.forwardRef<
  React.ElementRef<typeof SliderPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>
>(({ className, ...props }, ref) => (
  <SliderPrimitive.Root
    ref={ref}
    className={cn(
      'relative flex w-full touch-none select-none items-center',
      className,
    )}
    {...props}
  >
    <SliderPrimitive.Track className="relative h-2 w-full grow overflow-hidden rounded-full bg-secondary">
      <SliderPrimitive.Range className="absolute h-full bg-primary" />
    </SliderPrimitive.Track>
    <SliderPrimitive.Thumb className="block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50" />
  </SliderPrimitive.Root>
))
Slider.displayName = SliderPrimitive.Root.displayName

export { Slider }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\sonner.tsx
import { useTheme } from 'next-themes'
import { Toaster as Sonner } from 'sonner'

type ToasterProps = React.ComponentProps<typeof Sonner>

const Toaster = ({ ...props }: ToasterProps) => {
  const { theme = 'system' } = useTheme()

  return (
    <Sonner
      theme={theme as ToasterProps['theme']}
      className="toaster group"
      toastOptions={{
        classNames: {
          toast:
            'group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg',
          description: 'group-[.toast]:text-muted-foreground',
          actionButton:
            'group-[.toast]:bg-primary group-[.toast]:text-primary-foreground',
          cancelButton:
            'group-[.toast]:bg-muted group-[.toast]:text-muted-foreground',
        },
      }}
      {...props}
    />
  )
}

export { Toaster }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\switch.tsx
import * as React from 'react'
import * as SwitchPrimitives from '@radix-ui/react-switch'

import { cn } from '@/lib/utils'

const Switch = React.forwardRef<
  React.ElementRef<typeof SwitchPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>
>(({ className, ...props }, ref) => (
  <SwitchPrimitives.Root
    className={cn(
      'peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input',
      className,
    )}
    {...props}
    ref={ref}
  >
    <SwitchPrimitives.Thumb
      className={cn(
        'pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0',
      )}
    />
  </SwitchPrimitives.Root>
))
Switch.displayName = SwitchPrimitives.Root.displayName

export { Switch }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\table.tsx
import * as React from 'react'

import { cn } from '@/lib/utils'

const Table = React.forwardRef<
  HTMLTableElement,
  React.HTMLAttributes<HTMLTableElement>
>(({ className, ...props }, ref) => (
  <div className="relative w-full overflow-auto">
    <table
      ref={ref}
      className={cn('w-full caption-bottom text-sm', className)}
      {...props}
    />
  </div>
))
Table.displayName = 'Table'

const TableHeader = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <thead ref={ref} className={cn('[&_tr]:border-b', className)} {...props} />
))
TableHeader.displayName = 'TableHeader'

const TableBody = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <tbody
    ref={ref}
    className={cn('[&_tr:last-child]:border-0', className)}
    {...props}
  />
))
TableBody.displayName = 'TableBody'

const TableFooter = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <tfoot
    ref={ref}
    className={cn(
      'border-t bg-muted/50 font-medium [&>tr]:last:border-b-0',
      className,
    )}
    {...props}
  />
))
TableFooter.displayName = 'TableFooter'

const TableRow = React.forwardRef<
  HTMLTableRowElement,
  React.HTMLAttributes<HTMLTableRowElement>
>(({ className, ...props }, ref) => (
  <tr
    ref={ref}
    className={cn(
      'border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted',
      className,
    )}
    {...props}
  />
))
TableRow.displayName = 'TableRow'

const TableHead = React.forwardRef<
  HTMLTableCellElement,
  React.ThHTMLAttributes<HTMLTableCellElement>
>(({ className, ...props }, ref) => (
  <th
    ref={ref}
    className={cn(
      'h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0',
      className,
    )}
    {...props}
  />
))
TableHead.displayName = 'TableHead'

const TableCell = React.forwardRef<
  HTMLTableCellElement,
  React.TdHTMLAttributes<HTMLTableCellElement>
>(({ className, ...props }, ref) => (
  <td
    ref={ref}
    className={cn('p-4 align-middle [&:has([role=checkbox])]:pr-0', className)}
    {...props}
  />
))
TableCell.displayName = 'TableCell'

const TableCaption = React.forwardRef<
  HTMLTableCaptionElement,
  React.HTMLAttributes<HTMLTableCaptionElement>
>(({ className, ...props }, ref) => (
  <caption
    ref={ref}
    className={cn('mt-4 text-sm text-muted-foreground', className)}
    {...props}
  />
))
TableCaption.displayName = 'TableCaption'

export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\tabs.tsx
import * as React from 'react'
import * as TabsPrimitive from '@radix-ui/react-tabs'

import { cn } from '@/lib/utils'

const Tabs = TabsPrimitive.Root

const TabsList = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.List
    ref={ref}
    className={cn(
      'inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground',
      className,
    )}
    {...props}
  />
))
TabsList.displayName = TabsPrimitive.List.displayName

const TabsTrigger = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Trigger
    ref={ref}
    className={cn(
      'inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm',
      className,
    )}
    {...props}
  />
))
TabsTrigger.displayName = TabsPrimitive.Trigger.displayName

const TabsContent = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Content
    ref={ref}
    className={cn(
      'mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2',
      className,
    )}
    {...props}
  />
))
TabsContent.displayName = TabsPrimitive.Content.displayName

export { Tabs, TabsList, TabsTrigger, TabsContent }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\textarea.tsx
import * as React from 'react'
import { cn } from '@/lib/utils'

export interface TextareaProps
  extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}

const Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(
  ({ className, ...props }, ref) => {
    return (
      <textarea
        className={cn(
          'flex min-h-[100px] w-full rounded-lg border border-input bg-background px-4 py-3',
          'text-sm ring-offset-background transition-colors duration-200',
          'placeholder:text-muted-foreground/60',
          'focus:border-primary focus:ring-2 focus:ring-primary/20 focus:outline-none',
          'disabled:cursor-not-allowed disabled:opacity-50',
          'resize-none',
          className,
        )}
        ref={ref}
        {...props}
      />
    )
  },
)
Textarea.displayName = 'Textarea'

export { Textarea }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\toast.tsx
import * as React from 'react'
import * as ToastPrimitives from '@radix-ui/react-toast'
import { cva, type VariantProps } from 'class-variance-authority'
import { X } from 'lucide-react'

import { cn } from '@/lib/utils'

const ToastProvider = ToastPrimitives.Provider

const ToastViewport = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Viewport>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Viewport
    ref={ref}
    className={cn(
      'fixed top-0 z-[100] flex max-h-screen w-full flex-col p-4 sm:right-0 sm:top-0 md:max-w-[420px]',
      className,
    )}
    {...props}
  />
))
ToastViewport.displayName = ToastPrimitives.Viewport.displayName

const toastVariants = cva(
  'group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full',
  {
    variants: {
      variant: {
        default: 'border bg-background text-foreground',
        destructive:
          'destructive group border-destructive bg-destructive text-destructive-foreground',
      },
    },
    defaultVariants: {
      variant: 'default',
    },
  },
)

const Toast = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &
    VariantProps<typeof toastVariants>
>(({ className, variant, ...props }, ref) => {
  return (
    <ToastPrimitives.Root
      ref={ref}
      className={cn(toastVariants({ variant }), className)}
      {...props}
    />
  )
})
Toast.displayName = ToastPrimitives.Root.displayName

const ToastAction = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Action>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Action
    ref={ref}
    className={cn(
      'inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive',
      className,
    )}
    {...props}
  />
))
ToastAction.displayName = ToastPrimitives.Action.displayName

const ToastClose = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Close>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Close
    ref={ref}
    className={cn(
      'absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600',
      className,
    )}
    toast-close=""
    {...props}
  >
    <X className="h-4 w-4" />
  </ToastPrimitives.Close>
))
ToastClose.displayName = ToastPrimitives.Close.displayName

const ToastTitle = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Title>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Title
    ref={ref}
    className={cn('text-sm font-semibold', className)}
    {...props}
  />
))
ToastTitle.displayName = ToastPrimitives.Title.displayName

const ToastDescription = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Description>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Description
    ref={ref}
    className={cn('text-sm opacity-90', className)}
    {...props}
  />
))
ToastDescription.displayName = ToastPrimitives.Description.displayName

type ToastProps = React.ComponentPropsWithoutRef<typeof Toast>

type ToastActionElement = React.ReactElement<typeof ToastAction>

export {
  type ToastProps,
  type ToastActionElement,
  ToastProvider,
  ToastViewport,
  Toast,
  ToastTitle,
  ToastDescription,
  ToastClose,
  ToastAction,
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\toaster.tsx
import { useToast } from '@/hooks/use-toast'
import {
  Toast,
  ToastClose,
  ToastDescription,
  ToastProvider,
  ToastTitle,
  ToastViewport,
} from '@/components/ui/toast'

export function Toaster() {
  const { toasts } = useToast()

  return (
    <ToastProvider>
      {toasts.map(function ({ id, title, description, action, ...props }) {
        return (
          <Toast key={id} {...props}>
            <div className="grid gap-1">
              {title && <ToastTitle>{title}</ToastTitle>}
              {description && (
                <ToastDescription>{description}</ToastDescription>
              )}
            </div>
            {action}
            <ToastClose />
          </Toast>
        )
      })}
      <ToastViewport />
    </ToastProvider>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\toggle-group.tsx
import * as React from 'react'
import * as ToggleGroupPrimitive from '@radix-ui/react-toggle-group'
import { type VariantProps } from 'class-variance-authority'

import { cn } from '@/lib/utils'
import { toggleVariants } from '@/components/ui/toggle'

const ToggleGroupContext = React.createContext<
  VariantProps<typeof toggleVariants>
>({
  size: 'default',
  variant: 'default',
})

const ToggleGroup = React.forwardRef<
  React.ElementRef<typeof ToggleGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &
    VariantProps<typeof toggleVariants>
>(({ className, variant, size, children, ...props }, ref) => (
  <ToggleGroupPrimitive.Root
    ref={ref}
    className={cn('flex items-center justify-center gap-1', className)}
    {...props}
  >
    <ToggleGroupContext.Provider value={{ variant, size }}>
      {children}
    </ToggleGroupContext.Provider>
  </ToggleGroupPrimitive.Root>
))

ToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName

const ToggleGroupItem = React.forwardRef<
  React.ElementRef<typeof ToggleGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &
    VariantProps<typeof toggleVariants>
>(({ className, children, variant, size, ...props }, ref) => {
  const context = React.useContext(ToggleGroupContext)

  return (
    <ToggleGroupPrimitive.Item
      ref={ref}
      className={cn(
        toggleVariants({
          variant: context.variant || variant,
          size: context.size || size,
        }),
        className,
      )}
      {...props}
    >
      {children}
    </ToggleGroupPrimitive.Item>
  )
})

ToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName

export { ToggleGroup, ToggleGroupItem }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\toggle.tsx
import * as React from 'react'
import * as TogglePrimitive from '@radix-ui/react-toggle'
import { cva, type VariantProps } from 'class-variance-authority'

import { cn } from '@/lib/utils'

const toggleVariants = cva(
  'inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground',
  {
    variants: {
      variant: {
        default: 'bg-transparent',
        outline:
          'border border-input bg-transparent hover:bg-accent hover:text-accent-foreground',
      },
      size: {
        default: 'h-10 px-3',
        sm: 'h-9 px-2.5',
        lg: 'h-11 px-5',
      },
    },
    defaultVariants: {
      variant: 'default',
      size: 'default',
    },
  },
)

const Toggle = React.forwardRef<
  React.ElementRef<typeof TogglePrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &
    VariantProps<typeof toggleVariants>
>(({ className, variant, size, ...props }, ref) => (
  <TogglePrimitive.Root
    ref={ref}
    className={cn(toggleVariants({ variant, size, className }))}
    {...props}
  />
))

Toggle.displayName = TogglePrimitive.Root.displayName

export { Toggle, toggleVariants }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\tooltip.tsx
import * as React from 'react'
import * as TooltipPrimitive from '@radix-ui/react-tooltip'

import { cn } from '@/lib/utils'

const TooltipProvider = TooltipPrimitive.Provider

const Tooltip = TooltipPrimitive.Root

const TooltipTrigger = TooltipPrimitive.Trigger

const TooltipContent = React.forwardRef<
  React.ElementRef<typeof TooltipPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <TooltipPrimitive.Content
    ref={ref}
    sideOffset={sideOffset}
    className={cn(
      'z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2',
      className,
    )}
    {...props}
  />
))
TooltipContent.displayName = TooltipPrimitive.Content.displayName

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\ui\use-toast.ts
import { useToast, toast } from '@/hooks/use-toast'

export { useToast, toast }



// C:\Users\israe\Documents\GitHub\recentmap\src\components\user\UserDashboard.tsx
import { Card } from '@/components/ui/card'
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'
import { UserReservations } from './UserReservations'
import { UserNotifications } from './UserNotifications'
import { UserSettings } from './UserSettings'
import { motion, AnimatePresence } from 'framer-motion'
import { useToast } from '@/hooks/use-toast'
import { useState, useEffect } from 'react'
import { Loader2 } from 'lucide-react'

export const UserDashboard = () => {
  const { toast } = useToast()
  const [userName, setUserName] = useState<string>('')
  const [isLoading, setIsLoading] = useState(true)

  useEffect(() => {
    // Simulate API call to fetch user name
    const timer = setTimeout(() => {
      setUserName('John Doe')
      setIsLoading(false)
    }, 1000)

    return () => clearTimeout(timer)
  }, [])

  return (
    <motion.div
      initial={{ opacity: 0, y: 20 }}
      animate={{ opacity: 1, y: 0 }}
      className="container mx-auto p-6 space-y-6"
    >
      <div className="glass-card p-6 rounded-xl border border-primary/10">
        {isLoading ? (
          <div className="flex items-center gap-2 text-primary">
            <Loader2 className="h-5 w-5 animate-spin" />
            <span>Cargando...</span>
          </div>
        ) : (
          <h1 className="text-3xl font-bold gradient-text mb-4">
            Bienvenido, {userName}
          </h1>
        )}

        <Tabs defaultValue="reservations" className="w-full">
          <TabsList className="grid w-full grid-cols-3 glass-card">
            <TabsTrigger value="reservations">Mis Reservas</TabsTrigger>
            <TabsTrigger value="notifications">Notificaciones</TabsTrigger>
            <TabsTrigger value="settings">Configuración</TabsTrigger>
          </TabsList>

          <TabsContent value="reservations" className="mt-6">
            <Card className="glass-card p-6">
              <UserReservations />
            </Card>
          </TabsContent>

          <TabsContent value="notifications" className="mt-6">
            <Card className="glass-card p-6">
              <UserNotifications />
            </Card>
          </TabsContent>

          <TabsContent value="settings" className="mt-6">
            <Card className="glass-card p-6">
              <UserSettings />
            </Card>
          </TabsContent>
        </Tabs>
      </div>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\user\UserNavigationMenu.tsx
import {
  NavigationMenu,
  NavigationMenuContent,
  NavigationMenuItem,
  NavigationMenuLink,
  NavigationMenuList,
  NavigationMenuTrigger,
} from '@/components/ui/navigation-menu'
import { History, Plus, Bell, Settings } from 'lucide-react'
import { useNavigate } from 'react-router-dom'

export const UserNavigationMenu = () => {
  const navigate = useNavigate()

  return (
    <NavigationMenu>
      <NavigationMenuList className="space-x-2">
        <NavigationMenuItem>
          <NavigationMenuTrigger className="bg-white/80 hover:bg-white/95">
            <History className="w-4 h-4 mr-2" />
            Mis Reservas
          </NavigationMenuTrigger>
          <NavigationMenuContent>
            <div className="grid gap-3 p-4 w-[400px]">
              <NavigationMenuLink
                className="block select-none space-y-1 rounded-md p-3 leading-none no-underline outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground"
                onClick={() => navigate('/user/reservations')}
              >
                <div className="text-sm font-medium leading-none">
                  Historial de Reservas
                </div>
                <p className="line-clamp-2 text-sm leading-snug text-muted-foreground">
                  Ver y gestionar tus reservas anteriores
                </p>
              </NavigationMenuLink>
            </div>
          </NavigationMenuContent>
        </NavigationMenuItem>

        <NavigationMenuItem>
          <NavigationMenuTrigger className="bg-white/80 hover:bg-white/95">
            <Plus className="w-4 h-4 mr-2" />
            Nueva Reserva
          </NavigationMenuTrigger>
          <NavigationMenuContent>
            <div className="grid gap-3 p-4 w-[400px]">
              <NavigationMenuLink
                className="block select-none space-y-1 rounded-md p-3 leading-none no-underline outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground"
                onClick={() => navigate('/new-reservation')}
              >
                <div className="text-sm font-medium leading-none">
                  Crear Reserva
                </div>
                <p className="line-clamp-2 text-sm leading-snug text-muted-foreground">
                  Solicita un nuevo servicio de grúa
                </p>
              </NavigationMenuLink>
            </div>
          </NavigationMenuContent>
        </NavigationMenuItem>

        <NavigationMenuItem>
          <NavigationMenuTrigger className="bg-white/80 hover:bg-white/95">
            <Bell className="w-4 h-4 mr-2" />
            Notificaciones
          </NavigationMenuTrigger>
          <NavigationMenuContent>
            <div className="grid gap-3 p-4 w-[400px]">
              <NavigationMenuLink
                className="block select-none space-y-1 rounded-md p-3 leading-none no-underline outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground"
                onClick={() => navigate('/user/notifications')}
              >
                <div className="text-sm font-medium leading-none">
                  Centro de Notificaciones
                </div>
                <p className="line-clamp-2 text-sm leading-snug text-muted-foreground">
                  Revisa tus alertas y actualizaciones
                </p>
              </NavigationMenuLink>
            </div>
          </NavigationMenuContent>
        </NavigationMenuItem>

        <NavigationMenuItem>
          <NavigationMenuTrigger className="bg-white/80 hover:bg-white/95">
            <Settings className="w-4 h-4 mr-2" />
            Configuración
          </NavigationMenuTrigger>
          <NavigationMenuContent>
            <div className="grid gap-3 p-4 w-[400px]">
              <NavigationMenuLink
                className="block select-none space-y-1 rounded-md p-3 leading-none no-underline outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground"
                onClick={() => navigate('/user/settings')}
              >
                <div className="text-sm font-medium leading-none">
                  Ajustes de Cuenta
                </div>
                <p className="line-clamp-2 text-sm leading-snug text-muted-foreground">
                  Gestiona tu perfil y métodos de pago
                </p>
              </NavigationMenuLink>
            </div>
          </NavigationMenuContent>
        </NavigationMenuItem>
      </NavigationMenuList>
    </NavigationMenu>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\user\UserNotifications.tsx
import { Bell } from 'lucide-react'
import { motion } from 'framer-motion'

export const UserNotifications = () => {
  return (
    <motion.div
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      className="space-y-4"
    >
      <h2 className="text-2xl font-semibold mb-4">Notificaciones</h2>
      <div className="flex flex-col items-center justify-center py-12 text-gray-500">
        <Bell className="w-12 h-12 mb-4" />
        <p>No hay notificaciones nuevas</p>
      </div>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\user\UserReservations.tsx
import { Card } from '@/components/ui/card'
import { motion } from 'framer-motion'

export const UserReservations = () => {
  return (
    <motion.div
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      className="space-y-4"
    >
      <h2 className="text-2xl font-semibold mb-4">Mis Reservas</h2>
      <Card className="p-4 gradient-border">
        <p className="text-gray-600">No hay reservas activas</p>
      </Card>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\components\user\UserSettings.tsx
import { Card } from '@/components/ui/card'
import { motion } from 'framer-motion'
import { Settings, LogOut } from 'lucide-react'
import { Button } from '@/components/ui/button'
import { useToast } from '@/hooks/use-toast'

export const UserSettings = () => {
  const { toast } = useToast()

  const handleLogout = () => {
    // Add your logout logic here
    toast({
      title: 'Cerraste sesión',
      description: 'Tu sesión ha sido cerrada correctamente.',
    })
  }

  return (
    <motion.div
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      className="space-y-4"
    >
      <h2 className="text-2xl font-semibold mb-4">Configuración de Cuenta</h2>
      <Card className="p-6 gradient-border">
        <div className="flex flex-col items-center justify-center py-8 text-gray-500">
          <Settings className="w-12 h-12 mb-4" />
          <p>Configuración de cuenta próximamente</p>
        </div>
      </Card>

      <Button
        variant="destructive"
        className="w-full mt-6"
        onClick={handleLogout}
      >
        <LogOut className="w-4 h-4 mr-2" />
        Cerrar Sesión
      </Button>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\contexts\Sidebar1Context.tsx
import { createContext, useContext, useState, ReactNode } from 'react'

interface SidebarContextType {
  isOpen: boolean
  toggle: () => void
  setIsOpen: (isOpen: boolean) => void
}

const SidebarContext = createContext<SidebarContextType | undefined>(undefined)

export const SidebarProvider = ({ children }: { children: ReactNode }) => {
  const [isOpen, setIsOpen] = useState(true)

  const toggle = () => setIsOpen(!isOpen)

  return (
    <SidebarContext.Provider value={{ isOpen, toggle, setIsOpen }}>
      {children}
    </SidebarContext.Provider>
  )
}

export const useSidebar = () => {
  const context = useContext(SidebarContext)
  if (context === undefined) {
    throw new Error('useSidebar must be used within a SidebarProvider')
  }
  return context
}



// C:\Users\israe\Documents\GitHub\recentmap\src\contexts\SidebarContext.tsx
import { createContext, useContext, useState, ReactNode } from 'react'

interface SidebarContextType {
  isOpen: boolean
  toggle: () => void
  setIsOpen: (isOpen: boolean) => void
}

const SidebarContext = createContext<SidebarContextType | undefined>(undefined)

export const SidebarProvider = ({ children }: { children: ReactNode }) => {
  const [isOpen, setIsOpen] = useState(true)

  const toggle = () => setIsOpen(!isOpen)

  return (
    <SidebarContext.Provider value={{ isOpen, toggle, setIsOpen }}>
      {children}
    </SidebarContext.Provider>
  )
}

export const useSidebar = () => {
  const context = useContext(SidebarContext)
  if (context === undefined) {
    throw new Error('useSidebar must be used within a SidebarProvider')
  }
  return context
}



// C:\Users\israe\Documents\GitHub\recentmap\src\contexts\towing.ts
import { TollLocation } from '@/data/tollData'

export interface LocationInfo {
  pickup?: { lat: number; lng: number; address: string }
  drop?: { lat: number; lng: number; address: string }
}

export interface TollInfo {
  tolls: TollLocation[]
  totalTollCost: number
}

export interface PaymentInfo {
  subtotal: number
  tax: number
  total: number
  isPending: boolean
  isProcessing: boolean
}

export interface TowingContextType {
  totalDistance: number
  totalCost: number
  detectedTolls: TollLocation[]
  totalTollCost: number
  truckType: 'A' | 'B' | 'C' | 'D'
  requiresManeuver: boolean
  selectedVehicleModel: string
  tollInfo: TollInfo | null
  paymentInfo: PaymentInfo
  isLoadingLocations: boolean
  isProcessingPayment: boolean
  updateTowingInfo: (distance: number) => void
  updateTollInfo: (tolls: TollLocation[], tollCost: number) => void
  updateTruckType: (type: 'A' | 'B' | 'C' | 'D') => void
  updateManeuverRequired: (required: boolean) => void
  updateSelectedVehicleModel: (model: string) => void
  updateLocationInfo: (info: LocationInfo) => void
  processPayment: (amount: number) => Promise<boolean>
  setLoadingLocations: (loading: boolean) => void
}



// C:\Users\israe\Documents\GitHub\recentmap\src\contexts\TowingContext.tsx
import { createContext, useContext, useState, ReactNode } from 'react'
import { TollLocation } from '@/data/tollData'

interface LocationInfo {
  pickup?: { lat: number; lng: number; address: string }
  drop?: { lat: number; lng: number; address: string }
}

interface TollInfo {
  tolls: TollLocation[]
  totalTollCost: number
}

interface TowingContextType {
  totalDistance: number
  totalCost: number
  detectedTolls: TollLocation[]
  totalTollCost: number
  truckType: 'A' | 'B' | 'C' | 'D'
  requiresManeuver: boolean
  selectedVehicleModel: string
  tollInfo: TollInfo | null
  updateTowingInfo: (distance: number) => void
  updateTollInfo: (tolls: TollLocation[], tollCost: number) => void
  updateTruckType: (type: 'A' | 'B' | 'C' | 'D') => void
  updateManeuverRequired: (required: boolean) => void
  updateSelectedVehicleModel: (model: string) => void
  updateLocationInfo: (info: LocationInfo) => void
}

const TowingContext = createContext<TowingContextType | undefined>(undefined)

export const TowingProvider = ({ children }: { children: ReactNode }) => {
  const [totalDistance, setTotalDistance] = useState(0)
  const [totalCost, setTotalCost] = useState(0)
  const [detectedTolls, setDetectedTolls] = useState<TollLocation[]>([])
  const [totalTollCost, setTotalTollCost] = useState(0)
  const [truckType, setTruckType] = useState<'A' | 'B' | 'C' | 'D'>('A')
  const [requiresManeuver, setRequiresManeuver] = useState(false)
  const [selectedVehicleModel, setSelectedVehicleModel] = useState('')
  const [tollInfo, setTollInfo] = useState<TollInfo | null>(null)

  const updateTowingInfo = (distance: number) => {
    setTotalDistance(distance)
  }

  const updateTollInfo = (tolls: TollLocation[], tollCost: number) => {
    setDetectedTolls(tolls)
    setTotalTollCost(tollCost)
    setTollInfo({ tolls, totalTollCost: tollCost })
  }

  const updateTruckType = (type: 'A' | 'B' | 'C' | 'D') => {
    setTruckType(type)
  }

  const updateManeuverRequired = (required: boolean) => {
    setRequiresManeuver(required)
  }

  const updateSelectedVehicleModel = (model: string) => {
    setSelectedVehicleModel(model)
  }

  const updateLocationInfo = (info: LocationInfo) => {
    // This function is used to update pickup and drop location information
    // The actual state updates will be handled by the map component
  }

  return (
    <TowingContext.Provider
      value={{
        totalDistance,
        totalCost,
        detectedTolls,
        totalTollCost,
        truckType,
        requiresManeuver,
        selectedVehicleModel,
        tollInfo,
        updateTowingInfo,
        updateTollInfo,
        updateTruckType,
        updateManeuverRequired,
        updateSelectedVehicleModel,
        updateLocationInfo,
      }}
    >
      {children}
    </TowingContext.Provider>
  )
}

export const useTowing = () => {
  const context = useContext(TowingContext)
  if (context === undefined) {
    throw new Error('useTowing must be used within a TowingProvider')
  }
  return context
}



// C:\Users\israe\Documents\GitHub\recentmap\src\data\tollData.ts
export interface TollLocation {
  name: string
  lat: number
  lng: number
  cost: number
  description: string
  type: 'highway' | 'urban'
  operatingHours: string
  acceptedPayments: ('cash' | 'card' | 'tag')[]
  vehicleTypes: ('car' | 'truck' | 'motorcycle')[]
  lastUpdated: string
  status: 'active' | 'maintenance' | 'closed'
  direction?: 'outbound' | 'return'
  kilometer?: string
  route?: string
  distance?: number
}

export const TOLL_LOCATIONS: TollLocation[] = [
  {
    name: 'Monterrey - Nuevo Laredo',
    lat: 25.8941,
    lng: -100.1824,
    cost: 418.0,
    description: 'Cuota principal hacia Nuevo Laredo',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
    route: 'Monterrey - Nuevo Laredo',
    distance: 123.1,
  },
  {
    name: 'Agualeguas',
    lat: 26.3167,
    lng: -99.5333,
    cost: 171.0,
    description: 'Caseta Agualeguas',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
    kilometer: '79+600',
    route: 'Monterrey - Agualeguas',
    distance: 56.9,
  },
  {
    name: 'Monterrey - La Gloria',
    lat: 25.7833,
    lng: -100.5667,
    cost: 418.0,
    description: 'Peaje entre Monterrey y La Gloria',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
    kilometer: '100+000',
    route: 'Monterrey - La Gloria',
    distance: 45.8,
  },
  {
    name: 'Monterrey - Sabinas',
    lat: 25.4506,
    lng: -100.9447,
    cost: 231.0,
    description: 'Peaje entre Monterrey y Sabinas',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
    kilometer: '99+300',
    route: 'Monterrey - Sabinas',
    distance: 77.3,
  },
  {
    name: 'Sabinas - La Gloria',
    lat: 25.7833,
    lng: -100.5667,
    cost: 188.0,
    description: 'Peaje entre Sabinas y La Gloria',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
    kilometer: '100+000',
    route: 'Sabinas - La Gloria',
    distance: 45.8,
  },
  {
    name: 'Agualeguas - Sabinas',
    lat: 26.3167,
    lng: -99.5333,
    cost: 60.0,
    description: 'Peaje entre Agualeguas y Sabinas',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
    kilometer: '79+600',
    route: 'Agualeguas - Sabinas',
    distance: 60.0,
  },
  {
    name: 'Detalle por ruta: Monterrey - Saltillo y Libramiento Norponiente de Saltillo',
    lat: 25.4506,
    lng: -100.9447,
    cost: 492.0,
    description: 'Coste total del peaje por la ruta mencionada',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
  },
  {
    name: 'Zacatecas - Monclova',
    lat: 23.9999,
    lng: -102.0,
    cost: 133.0,
    description: 'Peaje entre Zacatecas y Monclova',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
  },
  {
    name: 'Monclova - Ojo Caliente 1',
    lat: 25.8667,
    lng: -100.7833,
    cost: 57.0,
    description: 'Peaje entre Monclova y Ojo Caliente 1',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
  },
  {
    name: 'Monclova - Ojo Caliente 2',
    lat: 25.8667,
    lng: -100.7833,
    cost: 102.0,
    description: 'Peaje entre Monclova y Ojo Caliente 2',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
  },
  {
    name: 'Ojo Caliente 2 - Morones Prieto',
    lat: 25.8667,
    lng: -100.7833,
    cost: 257.0,
    description: 'Peaje entre Ojo Caliente 2 y Morones Prieto',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
  },
  {
    name: 'El Jónuco - Periférico',
    lat: 25.8667,
    lng: -100.7833,
    cost: 32.0,
    description: 'Peaje entre El Jónuco y Periférico',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
  },
  {
    name: 'El Jónuco - Morones Prieto',
    lat: 25.8667,
    lng: -100.7833,
    cost: 88.0,
    description: 'Peaje entre El Jónuco y Morones Prieto',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
  },
  {
    name: 'Zacatecas - Torreón',
    lat: 25.8667,
    lng: -100.7833,
    cost: 91.0,
    description: 'Peaje entre Zacatecas y Torreón',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
  },
  {
    name: 'Torreón - Monclova',
    lat: 25.8667,
    lng: -100.7833,
    cost: 42.0,
    description: 'Peaje entre Torreón y Monclova',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
  },
  {
    name: 'Ojo Caliente 1 - Ojo Caliente 2',
    lat: 25.8667,
    lng: -100.7833,
    cost: 45.0,
    description: 'Peaje entre Ojo Caliente 1 y Ojo Caliente 2',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
  },
  {
    name: 'Ojo Caliente 2 - Periférico',
    lat: 25.8667,
    lng: -100.7833,
    cost: 155.0,
    description: 'Peaje entre Ojo Caliente 2 y Periférico',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
  },
  {
    name: 'Periférico - Morones Prieto',
    lat: 25.8667,
    lng: -100.7833,
    cost: 102.0,
    description: 'Peaje entre Periférico y Morones Prieto',
    type: 'highway',
    operatingHours: '24/7',
    acceptedPayments: ['cash', 'card', 'tag'],
    vehicleTypes: ['car', 'truck', 'motorcycle'],
    lastUpdated: '2024-03-20',
    status: 'active',
  },
]



// C:\Users\israe\Documents\GitHub\recentmap\src\data\vehicleData.ts
export const vehicleBrands = [
  'Toyota',
  'Honda',
  'Ford',
  'Chevrolet',
  'Nissan',
  'Volkswagen',
  'BMW',
  'Mercedes-Benz',
  'Audi',
  'Hyundai',
  'Mazda',
  'Subaru',
  'Kia',
  'Lexus',
  'Volvo',
  'Tesla',
  'Porsche',
  'Jaguar',
  'Land Rover',
  'Acura',
  'RAM',
  'GMC',
  'Jeep',
  'Dodge',
  'Chrysler',
  'Mitsubishi',
  'Ferrari',
  'Lamborghini',
  'Bentley',
  'Bugatti',
  'Alfa Romeo',
].sort()

export const vehicleModels: Record<string, string[]> = {
  Toyota: [
    'Corolla',
    'Camry',
    'RAV4',
    'Highlander',
    'Tacoma',
    'Tundra',
    'Sienna',
    'Prius',
    '4Runner',
    'Land Cruiser',
  ].sort(),
  Honda: [
    'Civic',
    'Accord',
    'CR-V',
    'Pilot',
    'Odyssey',
    'HR-V',
    'Fit',
    'Ridgeline',
    'Passport',
  ].sort(),
  Ford: [
    'F-150',
    'Mustang',
    'Explorer',
    'Escape',
    'Focus',
    'Ranger',
    'Edge',
    'Expedition',
    'F-250',
    'F-350',
    'Bronco',
  ].sort(),
  Chevrolet: [
    'Silverado',
    'Malibu',
    'Equinox',
    'Traverse',
    'Camaro',
    'Tahoe',
    'Suburban',
    'Colorado',
    'Silverado 2500HD',
  ].sort(),
  Nissan: [
    'Altima',
    'Rogue',
    'Sentra',
    'Maxima',
    'Pathfinder',
    'Murano',
    'Titan',
    'Leaf',
    'Titan XD',
  ].sort(),
  Volkswagen: [
    'Jetta',
    'Passat',
    'Tiguan',
    'Atlas',
    'Golf',
    'ID.4',
    'Arteon',
    'Taos',
  ].sort(),
  BMW: [
    '3 Series',
    '5 Series',
    'X3',
    'X5',
    '7 Series',
    'M4',
    'X1',
    'X7',
  ].sort(),
  'Mercedes-Benz': [
    'C-Class',
    'E-Class',
    'GLC',
    'GLE',
    'S-Class',
    'A-Class',
    'GLA',
    'GLS',
  ].sort(),
  Audi: ['A4', 'A6', 'Q5', 'Q7', 'e-tron', 'A3', 'Q3', 'TT'].sort(),
  Hyundai: [
    'Elantra',
    'Sonata',
    'Tucson',
    'Santa Fe',
    'Kona',
    'Palisade',
    'Venue',
    'Ioniq',
  ].sort(),
  Mazda: [
    'Mazda3',
    'Mazda6',
    'CX-5',
    'CX-9',
    'MX-5 Miata',
    'CX-30',
    'CX-3',
    'CX-50',
  ].sort(),
  Subaru: [
    'Outback',
    'Forester',
    'Impreza',
    'Crosstrek',
    'Legacy',
    'Ascent',
    'WRX',
    'BRZ',
  ].sort(),
  Kia: [
    'Forte',
    'Optima',
    'Sportage',
    'Sorento',
    'Telluride',
    'Soul',
    'Stinger',
    'Seltos',
  ].sort(),
  Lexus: ['RX', 'ES', 'NX', 'IS', 'GX', 'UX', 'LS', 'LC'].sort(),
  Volvo: ['XC90', 'XC60', 'S60', 'V60', 'XC40', 'S90', 'V90', 'C40'].sort(),
  Tesla: [
    'Model 3',
    'Model S',
    'Model X',
    'Model Y',
    'Cybertruck',
    'Roadster',
  ].sort(),
  Porsche: [
    '911',
    'Cayenne',
    'Panamera',
    'Macan',
    'Taycan',
    'Boxster',
    'Cayman',
    '718',
  ].sort(),
  Jaguar: [
    'F-PACE',
    'XF',
    'E-PACE',
    'I-PACE',
    'XE',
    'F-TYPE',
    'XJ',
    'XK',
  ].sort(),
  'Land Rover': [
    'Range Rover',
    'Discovery',
    'Defender',
    'Evoque',
    'Velar',
  ].sort(),
  Acura: ['TLX', 'RDX', 'MDX', 'ILX', 'NSX', 'RLX', 'TSX', 'RSX'].sort(),
  RAM: ['1500', '2500', '3500', 'ProMaster', 'ProMaster City'].sort(),
  GMC: [
    'Sierra',
    'Yukon',
    'Terrain',
    'Acadia',
    'Canyon',
    'Savana',
    'Sierra 2500HD',
  ].sort(),
  Jeep: [
    'Wrangler',
    'Grand Cherokee',
    'Cherokee',
    'Compass',
    'Renegade',
    'Gladiator',
  ].sort(),
  Dodge: [
    'Charger',
    'Challenger',
    'Durango',
    'Journey',
    'Grand Caravan',
    'Ram 3500',
  ].sort(),
  Chrysler: ['300', 'Pacifica', 'Voyager'].sort(),
  Mitsubishi: [
    'Outlander',
    'Pajero',
    'Lancer',
    'Eclipse Cross',
    'Mirage',
    'ASX',
  ].sort(),
  Ferrari: [
    '488',
    'Portofino',
    'Roma',
    'SF90 Stradale',
    'F8 Tributo',
    'GTC4Lusso',
  ].sort(),
  Lamborghini: ['Huracan', 'Aventador', 'Urus', 'Gallardo'].sort(),
  Bentley: ['Continental GT', 'Flying Spur', 'Bentayga'].sort(),
  Bugatti: ['Chiron', 'Veyron', 'Divo', 'Centodieci'].sort(),
  'Alfa Romeo': ['Giulia', 'Stelvio', '4C', 'Giulietta'].sort(),
}



// C:\Users\israe\Documents\GitHub\recentmap\src\features\map\components\MapControlPanel.tsx
import { MapControls } from './MapControls'
import { RouteStreetInfo } from './RouteStreetInfo'
import { useToast } from '@/hooks/use-toast'
import { motion, AnimatePresence } from 'framer-motion'
import { Card } from '@/components/ui/card'
import { Loader2 } from 'lucide-react'
import { useMapNotifications } from '../hooks/useMapNotifications'

interface MapControlPanelProps {
  selectingPickup: boolean
  selectingDrop: boolean
  setSelectingPickup: (value: boolean) => void
  setSelectingDrop: (value: boolean) => void
  pickupLocation: { lat: number; lng: number } | null
  dropLocation: { lat: number; lng: number } | null
  pickupAddress?: string
  dropAddress?: string
  isLoading?: boolean
}

export const MapControlPanel = ({
  selectingPickup,
  selectingDrop,
  setSelectingPickup,
  setSelectingDrop,
  pickupLocation,
  dropLocation,
  pickupAddress,
  dropAddress,
  isLoading = false,
}: MapControlPanelProps) => {
  const { toast } = useToast()
  const { showLocationSelectionNotification } = useMapNotifications()

  const handlePickupClick = () => {
    setSelectingPickup(true)
    setSelectingDrop(false)
    showLocationSelectionNotification('pickup')
  }

  const handleDropClick = () => {
    setSelectingDrop(true)
    setSelectingPickup(false)
    showLocationSelectionNotification('drop')
  }

  return (
    <div className="fixed top-16 left-1/2 transform -translate-x-1/2 z-50 w-full max-w-2xl px-3 sm:px-4">
      <motion.div
        initial={{ opacity: 0, y: -20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.3 }}
        className="w-full"
      >
        <Card className="relative w-full bg-white/95 backdrop-blur-md shadow-md rounded-lg p-4 border border-primary/10 hover:border-primary/20 transition-all duration-300">
          {isLoading && (
            <motion.div
              initial={{ opacity: 0 }}
              animate={{ opacity: 1 }}
              exit={{ opacity: 0 }}
              className="absolute inset-0 bg-white/70 backdrop-blur-sm flex items-center justify-center z-50 rounded-lg"
            >
              <Loader2 className="w-6 h-6 animate-spin text-primary" />
            </motion.div>
          )}
          <MapControls
            selectingPickup={selectingPickup}
            selectingDrop={selectingDrop}
            onPickupClick={handlePickupClick}
            onDropClick={handleDropClick}
          />
        </Card>
      </motion.div>

      <AnimatePresence>
        {(pickupLocation || dropLocation) && (
          <motion.div
            initial={{ opacity: 0, y: 10, scale: 0.95 }}
            animate={{ opacity: 1, y: 0, scale: 1 }}
            exit={{ opacity: 0, y: -10, scale: 0.95 }}
            transition={{ duration: 0.2 }}
            className="mt-3 w-full"
          >
            <RouteStreetInfo
              pickupLocation={pickupLocation}
              dropLocation={dropLocation}
              pickupAddress={pickupAddress}
              dropAddress={dropAddress}
              isLoading={isLoading}
            />
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\features\map\components\MapControls.tsx
import { MapPin, Navigation } from 'lucide-react'
import { Button } from '@/components/ui/button'
import { cn } from '@/lib/utils'

interface MapControlsProps {
  selectingPickup: boolean
  selectingDrop: boolean
  onPickupClick: () => void
  onDropClick: () => void
}

export const MapControls = ({
  selectingPickup,
  selectingDrop,
  onPickupClick,
  onDropClick,
}: MapControlsProps) => {
  return (
    <div className="flex flex-col sm:flex-row gap-3">
      <Button
        variant="outline"
        size="lg"
        onClick={onPickupClick}
        className={cn(
          'flex items-center gap-2 transition-all duration-300',
          selectingPickup
            ? 'bg-green-50 border-green-200 text-green-700'
            : 'hover:bg-green-50',
        )}
      >
        <MapPin className="h-4 w-4" />
        <span className="hidden sm:inline">Punto de Recogida</span>
      </Button>

      <Button
        variant="outline"
        size="lg"
        onClick={onDropClick}
        className={cn(
          'flex items-center gap-2 transition-all duration-300',
          selectingDrop
            ? 'bg-blue-50 border-blue-200 text-blue-700'
            : 'hover:bg-blue-50',
        )}
      >
        <Navigation className="h-4 w-4" />
        <span className="hidden sm:inline">Punto de Entrega</span>
      </Button>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\features\map\components\RouteStreetInfo.tsx
import { Card } from '@/components/ui/card'
import { MapPin, Navigation, Loader2 } from 'lucide-react'
import Draggable from 'react-draggable'
import { useRef } from 'react'

interface RouteStreetInfoProps {
  pickupLocation: { lat: number; lng: number } | null
  dropLocation: { lat: number; lng: number } | null
  pickupAddress?: string
  dropAddress?: string
  isLoading?: boolean
}

export const RouteStreetInfo = ({
  pickupLocation,
  dropLocation,
  pickupAddress,
  dropAddress,
  isLoading = false,
}: RouteStreetInfoProps) => {
  const nodeRef = useRef(null)

  if (!pickupLocation && !dropLocation) return null

  return (
    <Draggable handle=".drag-handle" bounds="parent" nodeRef={nodeRef}>
      <div ref={nodeRef} className="absolute z-[1000] max-w-md">
        <Card className="p-4 space-y-3 bg-white/95 backdrop-blur-sm shadow-lg transition-all duration-300 hover:shadow-xl border-blue-100/50">
          <div className="flex items-center justify-between border-b pb-2 mb-2 drag-handle cursor-move">
            <div className="font-semibold text-sm text-primary/90">
              Detalles de Ubicación
            </div>
            {isLoading && (
              <Loader2 className="w-4 h-4 animate-spin text-primary" />
            )}
          </div>

          {pickupLocation && (
            <div className="flex items-start gap-2">
              <MapPin className="w-5 h-5 mt-1 text-green-500 flex-shrink-0" />
              <div className="flex-1">
                <div className="font-semibold text-sm">Punto de Recogida</div>
                <div className="text-sm text-gray-600 break-words">
                  {pickupAddress || 'Cargando dirección...'}
                </div>
                <div className="text-xs text-gray-500 mt-1">
                  Coordenadas: {pickupLocation.lat.toFixed(6)},{' '}
                  {pickupLocation.lng.toFixed(6)}
                </div>
              </div>
            </div>
          )}

          {dropLocation && (
            <div className="flex items-start gap-2">
              <Navigation className="w-5 h-5 mt-1 text-red-500 flex-shrink-0" />
              <div className="flex-1">
                <div className="font-semibold text-sm">Punto de Entrega</div>
                <div className="text-sm text-gray-600 break-words">
                  {dropAddress || 'Cargando dirección...'}
                </div>
                <div className="text-xs text-gray-500 mt-1">
                  Coordenadas: {dropLocation.lat.toFixed(6)},{' '}
                  {dropLocation.lng.toFixed(6)}
                </div>
              </div>
            </div>
          )}
        </Card>
      </div>
    </Draggable>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\features\map\hooks\useMapNotifications.tsx
import { useToast } from '@/hooks/use-toast'
import { MapPin } from 'lucide-react'
import { ReactNode } from 'react'
import { ToastActionElement, ToastProps } from '@/components/ui/toast'

type ToasterToast = {
  id: string
  title?: React.ReactNode
  description?: React.ReactNode
  action?: ToastActionElement
  icon?: ReactNode
  className?: string
  variant?: 'default' | 'destructive'
}

export const useMapNotifications = () => {
  const { toast } = useToast()

  const showLocationSelectionNotification = (type: 'pickup' | 'drop'): void => {
    toast({
      title:
        type === 'pickup'
          ? 'Seleccionando punto de recogida'
          : 'Seleccionando punto de entrega',
      description: `Haz clic en el mapa para seleccionar el punto de ${type === 'pickup' ? 'recogida' : 'entrega'}`,
      className:
        type === 'pickup'
          ? 'bg-green-50 border-green-200'
          : 'bg-blue-50 border-blue-200',
    })
  }

  const showRouteCalculationError = (error: string): void => {
    toast({
      title: 'Error al calcular la ruta',
      description: error,
      variant: 'destructive',
    })
  }

  const showLocationUpdateSuccess = (
    type: 'pickup' | 'drop',
    address: string,
  ): void => {
    toast({
      title: `${type === 'pickup' ? 'Punto de recogida' : 'Punto de entrega'} actualizado`,
      description: address,
      className:
        type === 'pickup'
          ? 'bg-green-50 border-green-200'
          : 'bg-blue-50 border-blue-200',
    })
  }

  return {
    showLocationSelectionNotification,
    showRouteCalculationError,
    showLocationUpdateSuccess,
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\src\features\map\hooks\useMapState.ts
import { useState } from 'react'
import { useToast } from '@/hooks/use-toast'
import { useMapNotifications } from './useMapNotifications'
import { getAddressFromCoordinates } from '@/services/geocodingService'

interface Location {
  lat: number
  lng: number
}

export const useMapState = () => {
  const [pickupLocation, setPickupLocation] = useState<Location | null>(null)
  const [dropLocation, setDropLocation] = useState<Location | null>(null)
  const [pickupAddress, setPickupAddress] = useState('')
  const [dropAddress, setDropAddress] = useState('')
  const [selectingPickup, setSelectingPickup] = useState(false)
  const [selectingDrop, setSelectingDrop] = useState(false)
  const [isLoading, setIsLoading] = useState(false)

  const { showLocationUpdateSuccess } = useMapNotifications()

  const handleLocationSelect = async (
    location: Location,
    type: 'pickup' | 'drop',
  ) => {
    setIsLoading(true)
    try {
      const address = await getAddressFromCoordinates(
        location.lat,
        location.lng,
      )

      if (type === 'pickup') {
        setPickupLocation(location)
        setPickupAddress(address)
        setSelectingPickup(false)
      } else {
        setDropLocation(location)
        setDropAddress(address)
        setSelectingDrop(false)
      }

      showLocationUpdateSuccess(type, address)
    } catch (error) {
      console.error('Error getting address:', error)
    } finally {
      setIsLoading(false)
    }
  }

  return {
    pickupLocation,
    dropLocation,
    pickupAddress,
    dropAddress,
    selectingPickup,
    selectingDrop,
    isLoading,
    setSelectingPickup,
    setSelectingDrop,
    handleLocationSelect,
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\src\features\reservations\components\ReservationFilters.tsx
import { Input } from '@/components/ui/input'
import { Button } from '@/components/ui/button'
import { Calendar } from '@/components/ui/calendar'
import { Filter, SortAsc, SortDesc } from 'lucide-react'
import { motion } from 'framer-motion'

interface ReservationFiltersProps {
  searchQuery: string
  onSearchChange: (value: string) => void
  selectedDate: Date | undefined
  onDateSelect: (date: Date | undefined) => void
  sortDirection: 'asc' | 'desc'
  onSortChange: () => void
}

export const ReservationFilters = ({
  searchQuery,
  onSearchChange,
  selectedDate,
  onDateSelect,
  sortDirection,
  onSortChange,
}: ReservationFiltersProps) => {
  return (
    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
      <div className="space-y-2">
        <div className="flex items-center gap-2">
          <Filter className="h-4 w-4 text-gray-500" />
          <span className="text-sm font-medium text-gray-700">
            Filtrar Reservas
          </span>
        </div>
        <Input
          placeholder="Buscar reservas..."
          value={searchQuery}
          onChange={(e) => onSearchChange(e.target.value)}
          className="w-full"
        />
      </div>
      <div className="space-y-2">
        <div className="flex items-center gap-2">
          <Filter className="h-4 w-4 text-gray-500" />
          <span className="text-sm font-medium text-gray-700">
            Filtrar por Fecha
          </span>
        </div>
        <div className="flex items-center gap-2">
          <Calendar
            mode="single"
            selected={selectedDate}
            onSelect={onDateSelect}
            className="rounded-md border"
          />
          <Button
            variant="outline"
            size="icon"
            onClick={onSortChange}
            className="relative group"
          >
            {sortDirection === 'asc' ? (
              <SortAsc className="h-4 w-4" />
            ) : (
              <SortDesc className="h-4 w-4" />
            )}
          </Button>
        </div>
      </div>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\features\reservations\components\ReservationList.tsx
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from '@/components/ui/table'
import { Button } from '@/components/ui/button'
import { useToast } from '@/hooks/use-toast'
import { ServiceRequest } from '@/types/service'
import { motion } from 'framer-motion'

interface ReservationListProps {
  reservations: ServiceRequest[]
  isLoading: boolean
}

export const ReservationList = ({
  reservations,
  isLoading,
}: ReservationListProps) => {
  const { toast } = useToast()

  return (
    <motion.div
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      exit={{ opacity: 0 }}
      className="rounded-md border"
    >
      <Table>
        <TableHeader>
          <TableRow>
            <TableHead>ID</TableHead>
            <TableHead>Status</TableHead>
            <TableHead>Created</TableHead>
            <TableHead>Customer</TableHead>
            <TableHead>Vehicle</TableHead>
            <TableHead>Actions</TableHead>
          </TableRow>
        </TableHeader>
        <TableBody>
          {reservations.map((reservation) => (
            <TableRow key={reservation.id}>
              <TableCell>{reservation.id}</TableCell>
              <TableCell>
                <span
                  className={`px-2 py-1 rounded-full text-xs ${
                    reservation.status === 'completed'
                      ? 'bg-green-100 text-green-800'
                      : 'bg-yellow-100 text-yellow-800'
                  }`}
                >
                  {reservation.status}
                </span>
              </TableCell>
              <TableCell>
                {reservation.createdAt.toLocaleDateString()}
              </TableCell>
              <TableCell>{reservation.username}</TableCell>
              <TableCell>{`${reservation.vehicleYear} ${reservation.vehicleMake} ${reservation.vehicleModel}`}</TableCell>
              <TableCell>
                <Button
                  variant="outline"
                  size="sm"
                  onClick={() => {
                    toast({
                      title: 'Ver Detalles',
                      description: `Viendo reserva ${reservation.id}`,
                    })
                  }}
                >
                  Ver
                </Button>
              </TableCell>
            </TableRow>
          ))}
        </TableBody>
      </Table>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\hooks\base.ts
import { useEffect, useState } from 'react'

export function useBase<T>(initialValue: T) {
  const [value, setValue] = useState<T>(initialValue)
  const [error, setError] = useState<Error | null>(null)
  const [loading, setLoading] = useState<boolean>(false)

  const reset = () => {
    setValue(initialValue)
    setError(null)
    setLoading(false)
  }

  return {
    value,
    setValue,
    error,
    setError,
    loading,
    setLoading,
    reset,
  }
}

export function useAsync<T>(asyncFn: () => Promise<T>, immediate = true) {
  const [value, setValue] = useState<T | null>(null)
  const [error, setError] = useState<Error | null>(null)
  const [loading, setLoading] = useState<boolean>(false)

  const execute = async () => {
    try {
      setLoading(true)
      setError(null)
      const result = await asyncFn()
      setValue(result)
      return result
    } catch (err) {
      setError(err as Error)
      throw err
    } finally {
      setLoading(false)
    }
  }

  useEffect(() => {
    if (immediate) {
      execute()
    }
  }, [immediate])

  return {
    value,
    error,
    loading,
    execute,
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\src\hooks\TowingContext.ts
import { createContext, useContext, useState, ReactNode } from 'react';
import { TollLocation } from '@/data/tollData';
import { useToast } from '@/hooks/use-toast';

interface LocationInfo {
    pickup?: { lat: number; lng: number; address: string };
    drop?: { lat: number; lng: number; address: string };
}

interface TollInfo {
    tolls: TollLocation[];
    totalTollCost: number;
}

interface PaymentInfo {
    subtotal: number;
    tax: number;
    total: number;
    isPending: boolean;
    isProcessing: boolean;
}

interface TowingContextType {
    totalDistance: number;
    totalCost: number;
    detectedTolls: TollLocation[];
    totalTollCost: number;
    truckType: "A" | "B" | "C" | "D";
    requiresManeuver: boolean;
    selectedVehicleModel: string;
    tollInfo: TollInfo | null;
    paymentInfo: PaymentInfo;
    isLoadingLocations: boolean;
    isProcessingPayment: boolean;
    updateTowingInfo: (distance: number) => void;
    updateTollInfo: (tolls: TollLocation[], tollCost: number) => void;
    updateTruckType: (type: "A" | "B" | "C" | "D") => void;
    updateManeuverRequired: (required: boolean) => void;
    updateSelectedVehicleModel: (model: string) => void;
    updateLocationInfo: (info: LocationInfo) => void;
    processPayment: (amount: number) => Promise<boolean>;
    setLoadingLocations: (loading: boolean) => void;
}

const TowingContext = createContext<TowingContextType | undefined>(undefined);

export const TowingProvider = ({ children }: { children: ReactNode }) => {
    const [totalDistance, setTotalDistance] = useState(0);
    const [totalCost, setTotalCost] = useState(0);
    const [detectedTolls, setDetectedTolls] = useState<TollLocation[]>([]);
    const [totalTollCost, setTotalTollCost] = useState(0);
    const [truckType, setTruckType] = useState<"A" | "B" | "C" | "D">("A");
    const [requiresManeuver, setRequiresManeuver] = useState(false);
    const [selectedVehicleModel, setSelectedVehicleModel] = useState("");
    const [tollInfo, setTollInfo] = useState<TollInfo | null>(null);
    const [isLoadingLocations, setIsLoadingLocations] = useState(false);
    const [isProcessingPayment, setIsProcessingPayment] = useState(false);
    const { toast } = useToast();

    const [paymentInfo, setPaymentInfo] = useState<PaymentInfo>({
        subtotal: 0,
        tax: 0,
        total: 0,
        isPending: false,
        isProcessing: false
    });

    const updateTowingInfo = (distance: number) => {
        setTotalDistance(distance);
        // Update cost calculations based on distance
        const newCost = calculateTotalCost(distance, truckType, requiresManeuver, totalTollCost);
        setTotalCost(newCost);

        setPaymentInfo(prev => ({
            ...prev,
            subtotal: newCost,
            total: newCost * 1.16 // Including IVA
        }));
    };

    const updateTollInfo = (tolls: TollLocation[], tollCost: number) => {
        setDetectedTolls(tolls);
        setTotalTollCost(tollCost);
        setTollInfo({ tolls, totalTollCost: tollCost });

        // Update total cost when tolls change
        const newCost = calculateTotalCost(totalDistance, truckType, requiresManeuver, tollCost);
        setTotalCost(newCost);
    };

    const updateTruckType = (type: "A" | "B" | "C" | "D") => {
        setTruckType(type);
        // Recalculate costs when truck type changes
        const newCost = calculateTotalCost(totalDistance, type, requiresManeuver, totalTollCost);
        setTotalCost(newCost);
    };

    const updateManeuverRequired = (required: boolean) => {
        setRequiresManeuver(required);
        // Recalculate costs when maneuver requirement changes
        const newCost = calculateTotalCost(totalDistance, truckType, required, totalTollCost);
        setTotalCost(newCost);
    };

    const updateSelectedVehicleModel = (model: string) => {
        setSelectedVehicleModel(model);
    };

    const updateLocationInfo = async (info: LocationInfo) => {
        setIsLoadingLocations(true);
        try {
            // Update locations and recalculate route/costs
            if (info.pickup) {
                // Handle pickup location update
                toast({
                    title: "Ubicación de Recogida Actualizada",
                    description: info.pickup.address,
                });
            }
            if (info.drop) {
                // Handle drop location update
                toast({
                    title: "Ubicación de Entrega Actualizada",
                    description: info.drop.address,
                });
            }
        } catch (error) {
            toast({
                title: "Error",
                description: "No se pudo actualizar la ubicación",
                variant: "destructive",
            });
        } finally {
            setIsLoadingLocations(false);
        }
    };

    const processPayment = async (amount: number): Promise<boolean> => {
        setIsProcessingPayment(true);
        try {
            // Simulate payment processing
            await new Promise(resolve => setTimeout(resolve, 2000));

            toast({
                title: "Pago Procesado",
                description: `Se ha procesado el pago por $${amount.toFixed(2)} MXN`,
            });

            return true;
        } catch (error) {
            toast({
                title: "Error en el Pago",
                description: "No se pudo procesar el pago",
                variant: "destructive",
            });
            return false;
        } finally {
            setIsProcessingPayment(false);
        }
    };

    const setLoadingLocations = (loading: boolean) => {
        setIsLoadingLocations(loading);
    };

    return (
        <TowingContext.Provider value= {{
        totalDistance,
            totalCost,
            detectedTolls,
            totalTollCost,
            truckType,
            requiresManeuver,
            selectedVehicleModel,
            tollInfo,
            paymentInfo,
            isLoadingLocations,
            isProcessingPayment,
            updateTowingInfo,
            updateTollInfo,
            updateTruckType,
            updateManeuverRequired,
            updateSelectedVehicleModel,
            updateLocationInfo,
            processPayment,
            setLoadingLocations
    }
}>
    { children }
    </TowingContext.Provider>
  );
};

export const useTowing = () => {
    const context = useContext(TowingContext);
    if (context === undefined) {
        throw new Error('useTowing must be used within a TowingProvider');
    }
    return context;
};

// Helper function to calculate total cost
const calculateTotalCost = (
    distance: number,
    truckType: "A" | "B" | "C" | "D",
    requiresManeuver: boolean,
    tollCost: number
): number => {
    // Base calculation logic
    const baseRate = {
        A: 18.82,
        B: 20.62,
        C: 23.47,
        D: 32.35
    }[truckType] || 18.82;

    const maneuverCost = requiresManeuver ? {
        A: 1219.55,
        B: 1336.73,
        C: 1524.21,
        D: 2101.65
    }[truckType] : 0;

    const flagDropFee = {
        A: 528.69,
        B: 607.43,
        C: 721.79,
        D: 885.84
    }[truckType];

    return (distance * baseRate) + maneuverCost + flagDropFee + tollCost;
};


// C:\Users\israe\Documents\GitHub\recentmap\src\hooks\use-toast.ts
import * as React from 'react'
import { ToastActionElement, ToastProps } from '@/components/ui/toast'

const TOAST_LIMIT = 1
const TOAST_REMOVE_DELAY = 5000

type ToasterToast = ToastProps & {
  id: string
  title?: React.ReactNode
  description?: React.ReactNode
  action?: ToastActionElement
}

const actionTypes = {
  ADD_TOAST: 'ADD_TOAST',
  UPDATE_TOAST: 'UPDATE_TOAST',
  DISMISS_TOAST: 'DISMISS_TOAST',
  REMOVE_TOAST: 'REMOVE_TOAST',
} as const

let count = 0

function genId() {
  count = (count + 1) % Number.MAX_SAFE_INTEGER
  return count.toString()
}

type ActionType = typeof actionTypes

type Action =
  | { type: ActionType['ADD_TOAST']; toast: ToasterToast }
  | { type: ActionType['UPDATE_TOAST']; toast: Partial<ToasterToast> }
  | { type: ActionType['DISMISS_TOAST']; toastId?: ToasterToast['id'] }
  | { type: ActionType['REMOVE_TOAST']; toastId?: ToasterToast['id'] }

interface State {
  toasts: ToasterToast[]
}

const toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()

const addToRemoveQueue = (toastId: string) => {
  if (toastTimeouts.has(toastId)) return

  const timeout = setTimeout(() => {
    toastTimeouts.delete(toastId)
    dispatch({
      type: 'REMOVE_TOAST',
      toastId: toastId,
    })
  }, TOAST_REMOVE_DELAY)

  toastTimeouts.set(toastId, timeout)
}

export const reducer = (state: State, action: Action): State => {
  switch (action.type) {
    case 'ADD_TOAST':
      return {
        ...state,
        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),
      }

    case 'UPDATE_TOAST':
      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === action.toast.id ? { ...t, ...action.toast } : t,
        ),
      }

    case 'DISMISS_TOAST': {
      const { toastId } = action
      if (toastId) {
        addToRemoveQueue(toastId)
      } else {
        state.toasts.forEach((toast) => {
          addToRemoveQueue(toast.id)
        })
      }
      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === toastId || toastId === undefined
            ? {
                ...t,
                open: false,
              }
            : t,
        ),
      }
    }
    case 'REMOVE_TOAST':
      if (action.toastId === undefined) {
        return {
          ...state,
          toasts: [],
        }
      }
      return {
        ...state,
        toasts: state.toasts.filter((t) => t.id !== action.toastId),
      }
  }
}

const listeners: Array<(state: State) => void> = []
let memoryState: State = { toasts: [] }

function dispatch(action: Action) {
  memoryState = reducer(memoryState, action)
  listeners.forEach((listener) => {
    listener(memoryState)
  })
}

type Toast = Omit<ToasterToast, 'id'>

function toast({ ...props }: Toast) {
  const id = genId()

  const update = (props: ToasterToast) =>
    dispatch({
      type: 'UPDATE_TOAST',
      toast: { ...props, id },
    })
  const dismiss = () => dispatch({ type: 'DISMISS_TOAST', toastId: id })

  dispatch({
    type: 'ADD_TOAST',
    toast: {
      ...props,
      id,
      open: true,
      onOpenChange: (open) => {
        if (!open) dismiss()
      },
    },
  })

  return {
    id: id,
    dismiss,
    update,
  }
}

function useToast() {
  const [state, setState] = React.useState<State>(memoryState)

  React.useEffect(() => {
    listeners.push(setState)
    return () => {
      const index = listeners.indexOf(setState)
      if (index > -1) {
        listeners.splice(index, 1)
      }
    }
  }, [state])

  return {
    ...state,
    toast,
    dismiss: (toastId?: string) => dispatch({ type: 'DISMISS_TOAST', toastId }),
  }
}

export { useToast, toast }



// C:\Users\israe\Documents\GitHub\recentmap\src\hooks\useProfile.ts
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'
import { supabase } from '@/integrations/supabase/client'
import { useToast } from './use-toast'

export const useProfile = () => {
  const { toast } = useToast()
  const queryClient = useQueryClient()

  const { data: profile, isLoading } = useQuery({
    queryKey: ['profile'],
    queryFn: async () => {
      const {
        data: { user },
        error: userError,
      } = await supabase.auth.getUser()
      if (userError) throw userError

      const { data, error } = await supabase
        .from('profiles')
        .select('*')
        .eq('id', user.id)
        .single()

      if (error) throw error
      return data
    },
  })

  const updateProfile = useMutation({
    mutationFn: async (profileData: {
      username?: string
      full_name?: string
      phone_number?: string
    }) => {
      const {
        data: { user },
        error: userError,
      } = await supabase.auth.getUser()
      if (userError) throw userError

      const { data, error } = await supabase
        .from('profiles')
        .update(profileData)
        .eq('id', user.id)
        .select()
        .single()

      if (error) throw error
      return data
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['profile'] })
      toast({
        title: 'Profile Updated',
        description: 'Your profile has been updated successfully.',
      })
    },
    onError: (error: Error) => {
      toast({
        title: 'Error',
        description: error.message,
        variant: 'destructive',
      })
    },
  })

  return {
    profile,
    isLoading,
    updateProfile,
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\src\hooks\useServiceRequest.ts
import { useToast } from '@/components/ui/use-toast'
import { ServiceRequest } from '@/types/service'
import { useMutation } from '@tanstack/react-query'

// Mock service request function
const mockSubmitServiceRequest = async (
  data: Omit<ServiceRequest, 'id' | 'status' | 'createdAt'>,
): Promise<ServiceRequest> => {
  // Simulate network delay
  await new Promise((resolve) => setTimeout(resolve, 1000))

  // Create a mock response
  return {
    ...data,
    id: Math.random().toString(36).substr(2, 9),
    status: 'pending',
    createdAt: new Date(),
  }
}

export const useServiceRequest = () => {
  const { toast } = useToast()

  return useMutation({
    mutationFn: mockSubmitServiceRequest,
    onSuccess: () => {
      toast({
        title: 'Service Request Submitted',
        description: "We'll notify you when a tow truck is assigned.",
      })
    },
    onError: (error: Error) => {
      toast({
        title: 'Error',
        description: error.message,
        variant: 'destructive',
      })
    },
  })
}



// C:\Users\israe\Documents\GitHub\recentmap\src\hooks\useTowingCost.ts
import { useState } from 'react'
import { towTruckTypes } from '@/utils/towTruckPricing'

export const useTowingCost = () => {
  const [selectedTruck, setSelectedTruck] = useState<'A' | 'B' | 'C' | 'D'>('A')
  const [distance, setDistance] = useState(0)
  const [requiresManeuver, setRequiresManeuver] = useState(false)
  const [tollCost, setTollCost] = useState(0)

  const truck = towTruckTypes[selectedTruck]
  const baseCost = distance * truck.perKm
  const flagDropFee = truck.flagDropFee
  const maneuverCost = requiresManeuver ? truck.maneuverCharge : 0
  const totalCost = baseCost + flagDropFee + maneuverCost + tollCost

  return {
    selectedTruck,
    setSelectedTruck,
    distance,
    setDistance,
    requiresManeuver,
    setRequiresManeuver,
    tollCost,
    setTollCost,
    totalCost,
    baseCost,
    flagDropFee,
    maneuverCost,
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\src\hooks\useVehicleForm.ts
import { useForm } from 'react-hook-form'
import { zodResolver } from '@hookform/resolvers/zod'
import { FormData, formSchema } from '@/types/form'
import { useServiceRequest } from '@/hooks/useServiceRequest'
import { useToast } from '@/hooks/use-toast'

interface Location {
  lat: number
  lng: number
}

export const useVehicleForm = (
  pickupLocation: Location | null,
  dropLocation: Location | null,
  serviceType: 'standard' | 'flatbed' | 'emergency',
) => {
  const { toast } = useToast()
  const { mutate: submitRequest, isPending } = useServiceRequest()

  const form = useForm<FormData>({
    resolver: zodResolver(formSchema),
    defaultValues: {
      vehicleModel: '',
      truckType: 'A',
      issueDescription: '',
    },
  })

  const onSubmit = async (data: FormData) => {
    if (!pickupLocation || !dropLocation) {
      toast({
        title: 'Missing Location',
        description: 'Please select both pickup and drop-off locations',
        variant: 'destructive',
      })
      return
    }

    submitRequest({
      username: 'guest', // Default value
      vehicleMake: 'Unknown', // Default value
      vehicleModel: data.vehicleModel,
      vehicleYear: new Date().getFullYear(), // Default current year
      vehicleColor: 'Unknown', // Default value
      truckType: data.truckType,
      issueDescription: data.issueDescription || '',
      pickupLocation,
      dropLocation,
      serviceType,
      requiresManeuver: false,
      tollFees: 0, // Default value
    })
  }

  return {
    form,
    onSubmit,
    isPending,
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\src\hooks\useVehicleRequests.ts
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'
import { supabase } from '@/integrations/supabase/client'
import { useToast } from './use-toast'

export const useVehicleRequests = () => {
  const { toast } = useToast()
  const queryClient = useQueryClient()

  const { data: vehicleRequests, isLoading } = useQuery({
    queryKey: ['vehicleRequests'],
    queryFn: async () => {
      const { data, error } = await supabase
        .from('vehicle_requests')
        .select(
          `
          *,
          profiles:profiles(username, full_name, phone_number)
        `,
        )
        .order('created_at', { ascending: false })

      if (error) {
        toast({
          title: 'Error fetching requests',
          description: error.message,
          variant: 'destructive',
        })
        throw error
      }

      return data
    },
  })

  const createRequest = useMutation({
    mutationFn: async (requestData: {
      vehicle_make: string
      vehicle_model: string
      vehicle_year: string
      vehicle_color: string
      requires_maneuver: boolean
      truck_type: string
      pickup_location: { lat: number; lng: number }
      dropoff_location: { lat: number; lng: number }
    }) => {
      const { data: userData, error: userError } = await supabase.auth.getUser()
      if (userError) throw userError

      const { data, error } = await supabase
        .from('vehicle_requests')
        .insert([
          {
            ...requestData,
            user_id: userData.user.id,
            status: 'pending',
          },
        ])
        .select()
        .single()

      if (error) throw error

      // Notify webhooks
      await supabase.functions.invoke('webhook-notify', {
        body: { requestId: data.id },
      })

      // Notify admin via email
      await supabase.functions.invoke('notify-request', {
        body: { requestId: data.id },
      })

      return data
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['vehicleRequests'] })
      toast({
        title: 'Request Created',
        description: 'Your towing request has been submitted successfully.',
      })
    },
    onError: (error: Error) => {
      toast({
        title: 'Error',
        description: error.message,
        variant: 'destructive',
      })
    },
  })

  const updateRequest = useMutation({
    mutationFn: async ({
      id,
      ...updateData
    }: {
      id: string
      status?: string
      requires_maneuver?: boolean
      truck_type?: string
    }) => {
      const { data, error } = await supabase
        .from('vehicle_requests')
        .update(updateData)
        .eq('id', id)
        .select()
        .single()

      if (error) throw error
      return data
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['vehicleRequests'] })
      toast({
        title: 'Request Updated',
        description: 'The towing request has been updated successfully.',
      })
    },
    onError: (error: Error) => {
      toast({
        title: 'Error',
        description: error.message,
        variant: 'destructive',
      })
    },
  })

  return {
    vehicleRequests,
    isLoading,
    createRequest,
    updateRequest,
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\src\hooks\useWebhooks.ts
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query'
import { supabase } from '@/integrations/supabase/client'
import { useToast } from './use-toast'
import { Database } from '@/integrations/supabase/types'

type Tables = Database['public']['Tables']
type Webhook = Tables['webhooks']['Row']
type WebhookInsert = Tables['webhooks']['Insert']
type WebhookUpdate = Tables['webhooks']['Update']

export const useWebhooks = () => {
  const { toast } = useToast()
  const queryClient = useQueryClient()

  const { data: webhooks, isLoading } = useQuery({
    queryKey: ['webhooks'],
    queryFn: async () => {
      const { data, error } = await supabase
        .from('webhooks')
        .select('*')
        .order('created_at', { ascending: false })

      if (error) {
        toast({
          title: 'Error fetching webhooks',
          description: error.message,
          variant: 'destructive',
        })
        throw error
      }

      return data as Webhook[]
    },
  })

  const createWebhook = useMutation({
    mutationFn: async (webhookData: WebhookInsert) => {
      const { data, error } = await supabase
        .from('webhooks')
        .insert([webhookData])
        .select()
        .single()

      if (error) throw error
      return data as Webhook
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['webhooks'] })
      toast({
        title: 'Webhook Created',
        description: 'Your webhook has been created successfully.',
      })
    },
    onError: (error: Error) => {
      toast({
        title: 'Error',
        description: error.message,
        variant: 'destructive',
      })
    },
  })

  const updateWebhook = useMutation({
    mutationFn: async ({
      id,
      ...updateData
    }: WebhookUpdate & { id: string }) => {
      const { data, error } = await supabase
        .from('webhooks')
        .update(updateData)
        .eq('id', id)
        .select()
        .single()

      if (error) throw error
      return data as Webhook
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['webhooks'] })
      toast({
        title: 'Webhook Updated',
        description: 'The webhook has been updated successfully.',
      })
    },
    onError: (error: Error) => {
      toast({
        title: 'Error',
        description: error.message,
        variant: 'destructive',
      })
    },
  })

  const deleteWebhook = useMutation({
    mutationFn: async (id: string) => {
      const { error } = await supabase.from('webhooks').delete().eq('id', id)

      if (error) throw error
    },
    onSuccess: () => {
      queryClient.invalidateQueries({ queryKey: ['webhooks'] })
      toast({
        title: 'Webhook Deleted',
        description: 'The webhook has been deleted successfully.',
      })
    },
    onError: (error: Error) => {
      toast({
        title: 'Error',
        description: error.message,
        variant: 'destructive',
      })
    },
  })

  return {
    webhooks,
    isLoading,
    createWebhook,
    updateWebhook,
    deleteWebhook,
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\src\integrations\supabase\client.ts
// This file is automatically generated. Do not edit it directly.
import { createClient } from '@supabase/supabase-js'
import type { Database } from './types'
const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!
const supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!

// Import the supabase client like this:
// import { supabase } from "@/integrations/supabase/client";

export const supabase = createClient<Database>(supabaseUrl, supabaseKey)



// C:\Users\israe\Documents\GitHub\recentmap\src\integrations\supabase\towing.ts
import { createContext, useContext, useState, ReactNode } from 'react';
import { TollLocation } from '@/data/tollData';
import { useToast } from '@/hooks/use-toast';
import { calculateTotalCost } from '@/utils/costCalculator';
import { LocationInfo, TollInfo, PaymentInfo, TowingContextType } from './types/towing';

const TowingContext = createContext<TowingContextType | undefined>(undefined);

export const TowingProvider = ({ children }: { children: ReactNode }) => {
  const [totalDistance, setTotalDistance] = useState(0);
  const [totalCost, setTotalCost] = useState(0);
  const [detectedTolls, setDetectedTolls] = useState<TollLocation[]>([]);
  const [totalTollCost, setTotalTollCost] = useState(0);
  const [truckType, setTruckType] = useState<"A" | "B" | "C" | "D">("A");
  const [requiresManeuver, setRequiresManeuver] = useState(false);
  const [selectedVehicleModel, setSelectedVehicleModel] = useState("");
  const [tollInfo, setTollInfo] = useState<TollInfo | null>(null);
  const [isLoadingLocations, setIsLoadingLocations] = useState(false);
  const [isProcessingPayment, setIsProcessingPayment] = useState(false);
  const { toast } = useToast();

  const [paymentInfo, setPaymentInfo] = useState<PaymentInfo>({
    subtotal: 0,
    tax: 0,
    total: 0,
    isPending: false,
    isProcessing: false
  });

  const updateTowingInfo = (distance: number) => {
    setTotalDistance(distance);
    const newCost = calculateTotalCost(distance, truckType, requiresManeuver, totalTollCost);
    setTotalCost(newCost);
    setPaymentInfo(prev => ({
      ...prev,
      subtotal: newCost,
      total: newCost * 1.16
    }));
  };

  const updateTollInfo = (tolls: TollLocation[], tollCost: number) => {
    setDetectedTolls(tolls);
    setTotalTollCost(tollCost);
    setTollInfo({ tolls, totalTollCost: tollCost });
    const newCost = calculateTotalCost(totalDistance, truckType, requiresManeuver, tollCost);
    setTotalCost(newCost);
  };

  const updateTruckType = (type: "A" | "B" | "C" | "D") => {
    setTruckType(type);
    const newCost = calculateTotalCost(totalDistance, type, requiresManeuver, totalTollCost);
    setTotalCost(newCost);
  };

  const updateManeuverRequired = (required: boolean) => {
    setRequiresManeuver(required);
    const newCost = calculateTotalCost(totalDistance, truckType, required, totalTollCost);
    setTotalCost(newCost);
  };

  const updateSelectedVehicleModel = (model: string) => {
    setSelectedVehicleModel(model);
  };

  const updateLocationInfo = async (info: LocationInfo) => {
    setIsLoadingLocations(true);
    try {
      if (info.pickup) {
        toast({
          title: "Ubicación de Recogida Actualizada",
          description: info.pickup.address,
        });
      }
      if (info.drop) {
        toast({
          title: "Ubicación de Entrega Actualizada",
          description: info.drop.address,
        });
      }
    } catch (error) {
      toast({
        title: "Error",
        description: "No se pudo actualizar la ubicación",
        variant: "destructive",
      });
    } finally {
      setIsLoadingLocations(false);
    }
  };

  const processPayment = async (amount: number): Promise<boolean> => {
    setIsProcessingPayment(true);
    try {
      await new Promise(resolve => setTimeout(resolve, 2000));
      toast({
        title: "Pago Procesado",
        description: `Se ha procesado el pago por $${amount.toFixed(2)} MXN`,
      });
      return true;
    } catch (error) {
      toast({
        title: "Error en el Pago",
        description: "No se pudo procesar el pago",
        variant: "destructive",
      });
      return false;
    } finally {
      setIsProcessingPayment(false);
    }
  };

  return (
    <TowingContext.Provider value= {{
    totalDistance,
      totalCost,
      detectedTolls,
      totalTollCost,
      truckType,
      requiresManeuver,
      selectedVehicleModel,
      tollInfo,
      paymentInfo,
      isLoadingLocations,
      isProcessingPayment,
      updateTowingInfo,
      updateTollInfo,
      updateTruckType,
      updateManeuverRequired,
      updateSelectedVehicleModel,
      updateLocationInfo,
      processPayment,
      setLoadingLocations: setIsLoadingLocations
  }
}>
  { children }
  </TowingContext.Provider>
  );
};

export const useTowing = () => {
  const context = useContext(TowingContext);
  if (context === undefined) {
    throw new Error('useTowing must be used within a TowingProvider');
  }
  return context;
};


// C:\Users\israe\Documents\GitHub\recentmap\src\integrations\supabase\types.ts
export type Json =
  | string
  | number
  | boolean
  | null
  | { [key: string]: Json | undefined }
  | Json[]

export type Database = {
  public: {
    Tables: {
      payment_transactions: {
        Row: {
          amount: number
          created_at: string
          id: string
          request_id: string | null
          status: string
          stripe_payment_intent_id: string | null
        }
        Insert: {
          amount: number
          created_at?: string
          id?: string
          request_id?: string | null
          status: string
          stripe_payment_intent_id?: string | null
        }
        Update: {
          amount?: number
          created_at?: string
          id?: string
          request_id?: string | null
          status?: string
          stripe_payment_intent_id?: string | null
        }
        Relationships: [
          {
            foreignKeyName: 'payment_transactions_request_id_fkey'
            columns: ['request_id']
            isOneToOne: false
            referencedRelation: 'vehicle_requests'
            referencedColumns: ['id']
          },
        ]
      }
      profiles: {
        Row: {
          created_at: string
          full_name: string | null
          id: string
          phone_number: string | null
          updated_at: string
          username: string | null
        }
        Insert: {
          created_at?: string
          full_name?: string | null
          id: string
          phone_number?: string | null
          updated_at?: string
          username?: string | null
        }
        Update: {
          created_at?: string
          full_name?: string | null
          id?: string
          phone_number?: string | null
          updated_at?: string
          username?: string | null
        }
        Relationships: []
      }
      vehicle_requests: {
        Row: {
          admin_notified: boolean | null
          created_at: string
          dropoff_location: Json | null
          id: string
          payment_amount: number | null
          payment_intent_id: string | null
          payment_status: string | null
          pickup_location: Json | null
          requires_maneuver: boolean | null
          service_notes: string | null
          status: string
          truck_type: string
          user_id: string
          vehicle_color: string
          vehicle_make: string
          vehicle_model: string
          vehicle_year: string
        }
        Insert: {
          admin_notified?: boolean | null
          created_at?: string
          dropoff_location?: Json | null
          id?: string
          payment_amount?: number | null
          payment_intent_id?: string | null
          payment_status?: string | null
          pickup_location?: Json | null
          requires_maneuver?: boolean | null
          service_notes?: string | null
          status?: string
          truck_type: string
          user_id: string
          vehicle_color: string
          vehicle_make: string
          vehicle_model: string
          vehicle_year: string
        }
        Update: {
          admin_notified?: boolean | null
          created_at?: string
          dropoff_location?: Json | null
          id?: string
          payment_amount?: number | null
          payment_intent_id?: string | null
          payment_status?: string | null
          pickup_location?: Json | null
          requires_maneuver?: boolean | null
          service_notes?: string | null
          status?: string
          truck_type?: string
          user_id?: string
          vehicle_color?: string
          vehicle_make?: string
          vehicle_model?: string
          vehicle_year?: string
        }
        Relationships: [
          {
            foreignKeyName: 'vehicle_requests_user_id_fkey'
            columns: ['user_id']
            isOneToOne: false
            referencedRelation: 'profiles'
            referencedColumns: ['id']
          },
        ]
      }
      webhooks: {
        Row: {
          created_at: string
          description: string | null
          id: string
          is_active: boolean
          secret_key: string
          updated_at: string
          url: string
          user_id: string
        }
        Insert: {
          created_at?: string
          description?: string | null
          id?: string
          is_active?: boolean
          secret_key: string
          updated_at?: string
          url: string
          user_id?: string
        }
        Update: {
          created_at?: string
          description?: string | null
          id?: string
          is_active?: boolean
          secret_key?: string
          updated_at?: string
          url?: string
          user_id?: string
        }
        Relationships: [
          {
            foreignKeyName: 'webhooks_user_id_fkey'
            columns: ['user_id']
            isOneToOne: false
            referencedRelation: 'profiles'
            referencedColumns: ['id']
          },
        ]
      }
    }
    Views: {
      [_ in never]: never
    }
    Functions: {
      [_ in never]: never
    }
    Enums: {
      [_ in never]: never
    }
    CompositeTypes: {
      [_ in never]: never
    }
  }
}

type PublicSchema = Database[Extract<keyof Database, 'public'>]

export type Tables<
  PublicTableNameOrOptions extends
    | keyof (PublicSchema['Tables'] & PublicSchema['Views'])
    | { schema: keyof Database },
  TableName extends PublicTableNameOrOptions extends { schema: keyof Database }
    ? keyof (Database[PublicTableNameOrOptions['schema']]['Tables'] &
        Database[PublicTableNameOrOptions['schema']]['Views'])
    : never = never,
> = PublicTableNameOrOptions extends { schema: keyof Database }
  ? (Database[PublicTableNameOrOptions['schema']]['Tables'] &
      Database[PublicTableNameOrOptions['schema']]['Views'])[TableName] extends {
      Row: infer R
    }
    ? R
    : never
  : PublicTableNameOrOptions extends keyof (PublicSchema['Tables'] &
        PublicSchema['Views'])
    ? (PublicSchema['Tables'] &
        PublicSchema['Views'])[PublicTableNameOrOptions] extends {
        Row: infer R
      }
      ? R
      : never
    : never

export type TablesInsert<
  PublicTableNameOrOptions extends
    | keyof PublicSchema['Tables']
    | { schema: keyof Database },
  TableName extends PublicTableNameOrOptions extends { schema: keyof Database }
    ? keyof Database[PublicTableNameOrOptions['schema']]['Tables']
    : never = never,
> = PublicTableNameOrOptions extends { schema: keyof Database }
  ? Database[PublicTableNameOrOptions['schema']]['Tables'][TableName] extends {
      Insert: infer I
    }
    ? I
    : never
  : PublicTableNameOrOptions extends keyof PublicSchema['Tables']
    ? PublicSchema['Tables'][PublicTableNameOrOptions] extends {
        Insert: infer I
      }
      ? I
      : never
    : never

export type TablesUpdate<
  PublicTableNameOrOptions extends
    | keyof PublicSchema['Tables']
    | { schema: keyof Database },
  TableName extends PublicTableNameOrOptions extends { schema: keyof Database }
    ? keyof Database[PublicTableNameOrOptions['schema']]['Tables']
    : never = never,
> = PublicTableNameOrOptions extends { schema: keyof Database }
  ? Database[PublicTableNameOrOptions['schema']]['Tables'][TableName] extends {
      Update: infer U
    }
    ? U
    : never
  : PublicTableNameOrOptions extends keyof PublicSchema['Tables']
    ? PublicSchema['Tables'][PublicTableNameOrOptions] extends {
        Update: infer U
      }
      ? U
      : never
    : never

export type Enums<
  PublicEnumNameOrOptions extends
    | keyof PublicSchema['Enums']
    | { schema: keyof Database },
  EnumName extends PublicEnumNameOrOptions extends { schema: keyof Database }
    ? keyof Database[PublicEnumNameOrOptions['schema']]['Enums']
    : never = never,
> = PublicEnumNameOrOptions extends { schema: keyof Database }
  ? Database[PublicEnumNameOrOptions['schema']]['Enums'][EnumName]
  : PublicEnumNameOrOptions extends keyof PublicSchema['Enums']
    ? PublicSchema['Enums'][PublicEnumNameOrOptions]
    : never

export type CompositeTypes<
  PublicCompositeTypeNameOrOptions extends
    | keyof PublicSchema['CompositeTypes']
    | { schema: keyof Database },
  CompositeTypeName extends PublicCompositeTypeNameOrOptions extends {
    schema: keyof Database
  }
    ? keyof Database[PublicCompositeTypeNameOrOptions['schema']]['CompositeTypes']
    : never = never,
> = PublicCompositeTypeNameOrOptions extends { schema: keyof Database }
  ? Database[PublicCompositeTypeNameOrOptions['schema']]['CompositeTypes'][CompositeTypeName]
  : PublicCompositeTypeNameOrOptions extends keyof PublicSchema['CompositeTypes']
    ? PublicSchema['CompositeTypes'][PublicCompositeTypeNameOrOptions]
    : never



// C:\Users\israe\Documents\GitHub\recentmap\src\integrations\supabase\types\base.ts
import { Tables } from './tables'

export type Json =
  | string
  | number
  | boolean
  | null
  | { [key: string]: Json | undefined }
  | Json[]

export type Database = {
  public: {
    Tables: Tables
    Views: {}
    Functions: {}
    Enums: {}
    CompositeTypes: {}
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\src\integrations\supabase\types\index.ts
export * from './base'
export * from './tables'



// C:\Users\israe\Documents\GitHub\recentmap\src\integrations\supabase\types\tables.ts
import { Json } from './base'

interface ProfilesTable {
  Row: {
    created_at: string
    full_name: string | null
    id: string
    phone_number: string | null
    updated_at: string
    username: string | null
  }
  Insert: {
    created_at?: string
    full_name?: string | null
    id: string
    phone_number?: string | null
    updated_at?: string
    username?: string | null
  }
  Update: {
    created_at?: string
    full_name?: string | null
    id?: string
    phone_number?: string | null
    updated_at?: string
    username?: string | null
  }
  Relationships: []
}

interface VehicleRequestsTable {
  Row: {
    created_at: string
    dropoff_location: Json | null
    id: string
    pickup_location: Json | null
    requires_maneuver: boolean | null
    status: string
    truck_type: string
    user_id: string
    vehicle_color: string
    vehicle_make: string
    vehicle_model: string
    vehicle_year: string
  }
  Insert: {
    created_at?: string
    dropoff_location?: Json | null
    id?: string
    pickup_location?: Json | null
    requires_maneuver?: boolean | null
    status?: string
    truck_type: string
    user_id: string
    vehicle_color: string
    vehicle_make: string
    vehicle_model: string
    vehicle_year: string
  }
  Update: {
    created_at?: string
    dropoff_location?: Json | null
    id?: string
    pickup_location?: Json | null
    requires_maneuver?: boolean | null
    status?: string
    truck_type?: string
    user_id?: string
    vehicle_color?: string
    vehicle_make?: string
    vehicle_model?: string
    vehicle_year?: string
  }
  Relationships: [
    {
      foreignKeyName: 'vehicle_requests_user_id_fkey'
      columns: ['user_id']
      isOneToOne: false
      referencedRelation: 'profiles'
      referencedColumns: ['id']
    },
  ]
}

interface WebhooksTable {
  Row: {
    id: string
    created_at: string
    updated_at: string
    url: string
    description: string | null
    is_active: boolean
    secret_key: string
  }
  Insert: {
    id?: string
    created_at?: string
    updated_at?: string
    url: string
    description?: string | null
    is_active?: boolean
    secret_key: string
  }
  Update: {
    url?: string
    description?: string | null
    is_active?: boolean
    secret_key?: string
    updated_at?: string
  }
  Relationships: []
}

export interface Tables {
  profiles: ProfilesTable
  vehicle_requests: VehicleRequestsTable
  webhooks: WebhooksTable
}



// C:\Users\israe\Documents\GitHub\recentmap\src\lib\utils.ts
import { twMerge } from 'tailwind-merge'

export function cn(...inputs: any[]) {
  // Changed ClassValue to any[]
  return twMerge(inputs)
}



// C:\Users\israe\Documents\GitHub\recentmap\src\pages\Index.tsx
import { useState, Suspense, lazy } from 'react'
import { useToast } from '@/components/ui/use-toast'
import { TowingWrapper } from '@/components/TowingWrapper'
import { Loader2 } from 'lucide-react'
import { motion } from 'framer-motion'
import { Separator } from '@/components/ui/separator'
import {
  Carousel,
  CarouselContent,
  CarouselItem,
  CarouselNext,
  CarouselPrevious,
} from '@/components/ui/carousel'

const TowMap = lazy(() => import('@/components/TowMap'))

const FEATURED_IMAGES = [
  {
    src: 'https://www.google.com/url?sa=i&url=https%3A%2F%2Fmrgruas.github.io%2F&psig=AOvVaw0W-StWu4TaPfbI_4cmaWwn&ust=1732460736484000&source=images&cd=vfe&opi=89978449&ved=0CBQQjRxqFwoTCKDe-s7d8okDFQAAAAAdAAAAABAE',
    alt: 'Featured service 1',
    title: 'Professional Service',
  },
  {
    src: 'https://www.google.com/url?sa=i&url=https%3A%2F%2Fmrgruas.github.io%2F&psig=AOvVaw0W-StWu4TaPfbI_4cmaWwn&ust=1732460736484000&source=images&cd=vfe&opi=89978449&ved=0CBQQjRxqFwoTCKDe-s7d8okDFQAAAAAdAAAAABAJ',
    alt: 'Featured service 2',
    title: '24/7 Support',
  },
  {
    src: 'https://mrgruas.github.io/img/TipoA.gif',
    alt: 'Featured service 3',
    title: 'Nationwide Coverage',
  },
]

const LoadingSpinner = () => (
  <motion.div
    initial={{ opacity: 0, scale: 0.95 }}
    animate={{ opacity: 1, scale: 1 }}
    transition={{ duration: 0.3 }}
    className="flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-blue-100 via-white to-blue-100 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900"
  >
    <div className="glass-card p-8 rounded-xl shadow-lg border border-blue-200/20 text-center max-w-md mx-auto">
      <div className="relative mb-8">
        <Carousel className="w-full max-w-xs mx-auto">
          <CarouselContent>
            {FEATURED_IMAGES.map((image, index) => (
              <CarouselItem key={index}>
                <motion.div
                  initial={{ opacity: 0 }}
                  animate={{ opacity: 1 }}
                  transition={{ delay: index * 0.2 }}
                  className="relative aspect-video overflow-hidden rounded-lg"
                >
                  <img
                    src={image.src}
                    alt={image.alt}
                    className="object-cover w-full h-full hover:scale-105 transition-transform duration-300"
                  />
                  <div className="absolute inset-0 bg-gradient-to-t from-black/60 to-transparent">
                    <p className="absolute bottom-4 left-4 text-white font-semibold">
                      {image.title}
                    </p>
                  </div>
                </motion.div>
              </CarouselItem>
            ))}
          </CarouselContent>
          <CarouselPrevious className="hidden sm:flex" />
          <CarouselNext className="hidden sm:flex" />
        </Carousel>
      </div>
      <div className="relative">
        <div className="absolute inset-0 bg-blue-500/10 blur-xl rounded-full" />
        <Loader2 className="h-12 w-12 animate-spin text-primary relative z-10 mx-auto" />
      </div>
      <Separator className="my-6 bg-blue-200/20" />
      <motion.h2
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ delay: 0.2 }}
        className="text-3xl font-bold mb-2 bg-gradient-to-r from-primary via-blue-600 to-primary bg-clip-text text-transparent font-heading"
      >
        Cargando las rutas
      </motion.h2>
      <motion.p
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ delay: 0.3 }}
        className="mt-4 text-lg font-medium bg-gradient-to-r from-primary via-blue-600 to-primary bg-clip-text text-transparent animate-pulse"
      >
        Preparando el mapa...
      </motion.p>
      <Separator className="my-4 bg-blue-200/20" />
      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ delay: 0.4 }}
        className="mt-2 text-sm text-muted-foreground text-center leading-relaxed"
      >
        Porfavor espera en lo que preparamos tu mapa interactivo
        <span className="block mt-1 text-xs text-blue-500/70 hover:text-blue-600/70 transition-colors">
          Esto tomara un momento...
        </span>
      </motion.div>
    </div>
  </motion.div>
)

const Index = (): JSX.Element => {
  return (
    <motion.div
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      transition={{ duration: 0.5 }}
      className="relative min-h-screen overflow-hidden bg-gradient-to-br from-blue-50/50 via-white to-blue-50/50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900"
    >
      <div className="absolute inset-0 bg-grid-pattern opacity-5" />
      <div className="absolute inset-0 bg-gradient-to-br from-primary/5 via-transparent to-destructive/5" />
      <div className="absolute inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-blue-200/20 via-transparent to-transparent" />
      <div className="relative z-10 h-full">
        <TowingWrapper>
          <Suspense fallback={<LoadingSpinner />}>
            <TowMap />
          </Suspense>
        </TowingWrapper>
      </div>
    </motion.div>
  )
}

export default Index



// C:\Users\israe\Documents\GitHub\recentmap\src\pages\Landing.tsx
import React from 'react'
import { Header } from '@/components/landing/Header'
import { MetaTags } from '@/components/landing/MetaTags'
import { Services } from '@/components/landing/Services'
import { Hero } from '@/components/landing/Hero'
import { Mail, MapPin, Phone } from 'lucide-react'
import { motion } from 'framer-motion'
import { Card } from '@/components/ui/card'

const Landing = (): JSX.Element => {
  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-white to-blue-50">
      <div className="absolute inset-0 bg-grid-pattern opacity-5" />
      <div className="relative z-10">
        <MetaTags />
        <Header />
        <Hero />
        <main>
          <Services />

          <section id="contact" className="py-20 px-4">
            <motion.div
              initial={{ opacity: 0, y: 20 }}
              whileInView={{ opacity: 1, y: 0 }}
              viewport={{ once: true }}
              className="container mx-auto max-w-6xl"
            >
              <div className="text-center mb-4">
                <h2 className="text-4xl font-bold font-heading bg-gradient-to-r from-primary via-secondary to-primary bg-clip-text text-transparent mb-4">
                  Nos gustaría saber tu opinión
                </h2>
                <p className="text-lg text-black-600 max-w-2xl mx-auto">
                  Dispuestos a brindar ayuda y responder a las preguntas que
                  pueda tener.
                </p>
              </div>

              <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                <motion.div
                  whileHover={{ scale: 1.02 }}
                  className="flex flex-col items-center"
                >
                  <Card className="w-full p-6 text-center glass-card hover:shadow-lg transition-all duration-300">
                    <div className="rounded-full bg-primary/10 p-4 mx-auto mb-12">
                      <MapPin className="w-8 h-8 text-primary" />
                    </div>
                    <h3 className="text-xl font-semibold mb-4">Telefono</h3>
                    <a
                      href="tel:+5218180107110"
                      target="_blank"
                      rel="noreferrer"
                      className="text-gray-600 hover:text-primary transition-colors"
                    >
                      +52 1 81 8010 7110
                      <br />
                    </a>
                  </Card>
                </motion.div>

                <motion.div
                  whileHover={{ scale: 1.02 }}
                  className="flex flex-col items-center"
                >
                  <Card className="w-full p-6 text-center glass-card hover:shadow-lg transition-all duration-300">
                    <div className="rounded-full bg-primary/10 p-4 mx-auto mb-4">
                      <Phone className="w-8 h-8 text-primary" />
                    </div>
                    <h3 className="text-xl font-semibold mb-4">Direccion</h3>
                    <a
                      href="https://goo.gl/maps/Bm2taxCFni9G7ZjD6"
                      className="text-gray-600 hover:text-primary transition-colors"
                    >
                      Autopista Monterrey - Nuevo Laredo
                      <br />
                      Sabinas - Hidalgo, México
                    </a>
                  </Card>
                </motion.div>

                <motion.div
                  whileHover={{ scale: 1.02 }}
                  className="flex flex-col items-center"
                >
                  <Card className="w-full p-6 text-center glass-card hover:shadow-lg transition-all duration-300">
                    <div className="rounded-full bg-primary/10 p-4 mx-auto mb-4">
                      <Mail className="w-8 h-8 text-primary" />
                    </div>
                    <h3 className="text-xl font-semibold mb-4">Email</h3>
                    <a
                      href="mailto:gruasmartinezreyes@hotmail.com"
                      className="text-gray-600 hover:text-primary transition-colors break-words"
                    >
                      gruasmartinezreyes@hotmail.com
                    </a>
                  </Card>
                </motion.div>
              </div>
            </motion.div>
          </section>
        </main>

        <footer className="bg-gradient-to-br from-gray-900 to-gray-800 text-white py-16">
          <div className="container mx-auto px-4">
            <div className="grid grid-cols-1 md:grid-cols-3 gap-12">
              <motion.div
                initial={{ opacity: 0, y: 20 }}
                whileInView={{ opacity: 1, y: 0 }}
                viewport={{ once: true }}
                className="space-y-4"
              >
                <h3 className="text-2xl font-bold gradient-text">M.R. Grúas</h3>
                <p className="text-gray-300 leading-relaxed">
                  Servicio profesional de grúas y asistencia vial disponible las
                  24 horas del día, los 7 días de la semana. Su seguridad y
                  satisfacción son nuestra prioridad.
                </p>
              </motion.div>

              <motion.div
                initial={{ opacity: 0, y: 20 }}
                whileInView={{ opacity: 1, y: 0 }}
                viewport={{ once: true }}
                transition={{ delay: 0.2 }}
                className="space-y-4"
              >
                <h3 className="text-2xl font-bold gradient-text">Contacto</h3>
                <div className="space-y-3">
                  <div className="flex items-start space-x-3">
                    <MapPin className="w-5 h-5 text-primary mt-1" />
                    <p className="text-gray-300">
                      México 85D, Autopista Monterrey - Nuevo Laredo
                      <br />
                      Agualeguas Km 6+100 #200 Ebano, 65336 Sabinas Hidalgo,
                      N.L., México
                    </p>
                  </div>
                  <div className="flex items-center space-x-3">
                    <Phone className="w-5 h-5 text-primary" />
                    <a
                      href="tel:+5218180107110"
                      className="text-gray-300 hover:text-white transition-colors"
                    >
                      +52 1 81 8010 7110
                    </a>
                  </div>
                  <div className="flex items-center space-x-3">
                    <Mail className="w-5 h-5 text-primary" />
                    <a
                      href="mailto:gruasmartinezreyes@hotmail.com"
                      className="text-gray-300 hover:text-white transition-colors break-all"
                    >
                      gruasmartinezreyes@hotmail.com
                    </a>
                  </div>
                </div>
              </motion.div>

              <motion.div
                initial={{ opacity: 0, y: 20 }}
                whileInView={{ opacity: 1, y: 0 }}
                viewport={{ once: true }}
                transition={{ delay: 0.4 }}
                className="space-y-4"
              >
                <h3 className="text-2xl font-bold gradient-text">Síguenos</h3>
                <div className="flex flex-wrap gap-4">
                  <a
                    href="#"
                    className="px-4 py-2 bg-gray-800 rounded-full text-gray-300 hover:text-white hover:bg-gray-700 transition-all duration-300"
                  >
                    Facebook
                  </a>
                  <a
                    href="#"
                    className="px-4 py-2 bg-gray-800 rounded-full text-gray-300 hover:text-white hover:bg-gray-700 transition-all duration-300"
                  >
                    Twitter
                  </a>
                  <a
                    href="#"
                    className="px-4 py-2 bg-gray-800 rounded-full text-gray-300 hover:text-white hover:bg-gray-700 transition-all duration-300"
                  >
                    Instagram
                  </a>
                </div>
              </motion.div>
            </div>

            <motion.div
              initial={{ opacity: 0 }}
              whileInView={{ opacity: 1 }}
              viewport={{ once: true }}
              transition={{ delay: 0.6 }}
              className="mt-12 pt-8 border-t border-gray-700 text-center"
            >
              <p className="text-gray-400">
                © {new Date().getFullYear()} I.M.R. Grúas. Todos los derechos
                reservados.
              </p>
            </motion.div>
          </div>
        </footer>
      </div>
    </div>
  )
}

export default Landing



// C:\Users\israe\Documents\GitHub\recentmap\src\providers\StripeProvider.tsx
import { Elements } from '@stripe/react-stripe-js'
import { loadStripe } from '@stripe/stripe-js'
import { ReactNode, useEffect, useState } from 'react'
import { useToast } from '@/hooks/use-toast'

// Move Stripe key to a constant
const STRIPE_PUBLIC_KEY =
  'pk_test_51OxpVXBIrjwXwQdF1HpkQABXYGqpWZBFGPvXVoYZtqxPZqQtQvtgWXxYGHuVZyXxWXwXwXwXwXwXwXwXwXwX'

export const StripeProvider = ({ children }: { children: ReactNode }) => {
  const [stripePromise, setStripePromise] = useState<Promise<any> | null>(null)
  const { toast } = useToast()

  useEffect(() => {
    const initStripe = async () => {
      try {
        const stripe = await loadStripe(STRIPE_PUBLIC_KEY)
        if (stripe) {
          setStripePromise(Promise.resolve(stripe))
        } else {
          throw new Error('Failed to initialize Stripe')
        }
      } catch (error) {
        console.error('Stripe initialization error:', error)
        toast({
          title: 'Payment System Error',
          description:
            'Unable to initialize payment system. Please try again later.',
          variant: 'destructive',
        })
      }
    }

    initStripe()
  }, [toast])

  if (!stripePromise) {
    return null // Or a loading spinner
  }

  return <Elements stripe={stripePromise}>{children}</Elements>
}



// C:\Users\israe\Documents\GitHub\recentmap\src\providers\ThemeProvider.tsx
import { ThemeProvider as NextThemesProvider } from 'next-themes'
import type { ThemeProviderProps } from 'next-themes'

export function ThemeProvider({ children, ...props }: ThemeProviderProps) {
  return <NextThemesProvider {...props}>{children}</NextThemesProvider>
}



// C:\Users\israe\Documents\GitHub\recentmap\src\reservations\components\ReservationFilters.tsx
import { Input } from '@/components/ui/input'
import { Button } from '@/components/ui/button'
import { Calendar } from '@/components/ui/calendar'
import { Filter, SortAsc, SortDesc } from 'lucide-react'
import { motion } from 'framer-motion'

interface ReservationFiltersProps {
  searchQuery: string
  onSearchChange: (value: string) => void
  selectedDate: Date | undefined
  onDateSelect: (date: Date | undefined) => void
  sortDirection: 'asc' | 'desc'
  onSortChange: () => void
}

export const ReservationFilters = ({
  searchQuery,
  onSearchChange,
  selectedDate,
  onDateSelect,
  sortDirection,
  onSortChange,
}: ReservationFiltersProps) => {
  return (
    <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
      <div className="space-y-2">
        <div className="flex items-center gap-2">
          <Filter className="h-4 w-4 text-gray-500" />
          <span className="text-sm font-medium text-gray-700">
            Filtrar Reservas
          </span>
        </div>
        <Input
          placeholder="Buscar reservas..."
          value={searchQuery}
          onChange={(e) => onSearchChange(e.target.value)}
          className="w-full"
        />
      </div>
      <div className="space-y-2">
        <div className="flex items-center gap-2">
          <Filter className="h-4 w-4 text-gray-500" />
          <span className="text-sm font-medium text-gray-700">
            Filtrar por Fecha
          </span>
        </div>
        <div className="flex items-center gap-2">
          <Calendar
            mode="single"
            selected={selectedDate}
            onSelect={onDateSelect}
            className="rounded-md border"
          />
          <Button
            variant="outline"
            size="icon"
            onClick={onSortChange}
            className="relative group"
          >
            {sortDirection === 'asc' ? (
              <SortAsc className="h-4 w-4" />
            ) : (
              <SortDesc className="h-4 w-4" />
            )}
          </Button>
        </div>
      </div>
    </div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\reservations\components\ReservationList.tsx
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from '@/components/ui/table'
import { Button } from '@/components/ui/button'
import { useToast } from '@/hooks/use-toast'
import { ServiceRequest } from '@/types/service'
import { motion } from 'framer-motion'

interface ReservationListProps {
  reservations: ServiceRequest[]
  isLoading: boolean
}

export const ReservationList = ({
  reservations,
  isLoading,
}: ReservationListProps) => {
  const { toast } = useToast()

  return (
    <motion.div
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      exit={{ opacity: 0 }}
      className="rounded-md border"
    >
      <Table>
        <TableHeader>
          <TableRow>
            <TableHead>ID</TableHead>
            <TableHead>Status</TableHead>
            <TableHead>Created</TableHead>
            <TableHead>Customer</TableHead>
            <TableHead>Vehicle</TableHead>
            <TableHead>Actions</TableHead>
          </TableRow>
        </TableHeader>
        <TableBody>
          {reservations.map((reservation) => (
            <TableRow key={reservation.id}>
              <TableCell>{reservation.id}</TableCell>
              <TableCell>
                <span
                  className={`px-2 py-1 rounded-full text-xs ${
                    reservation.status === 'completed'
                      ? 'bg-green-100 text-green-800'
                      : 'bg-yellow-100 text-yellow-800'
                  }`}
                >
                  {reservation.status}
                </span>
              </TableCell>
              <TableCell>
                {reservation.createdAt.toLocaleDateString()}
              </TableCell>
              <TableCell>{reservation.username}</TableCell>
              <TableCell>{`${reservation.vehicleYear} ${reservation.vehicleMake} ${reservation.vehicleModel}`}</TableCell>
              <TableCell>
                <Button
                  variant="outline"
                  size="sm"
                  onClick={() => {
                    toast({
                      title: 'Ver Detalles',
                      description: `Viendo reserva ${reservation.id}`,
                    })
                  }}
                >
                  Ver
                </Button>
              </TableCell>
            </TableRow>
          ))}
        </TableBody>
      </Table>
    </motion.div>
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\routes\index.tsx
import { createBrowserRouter } from 'react-router-dom'
import Landing from '@/pages/Landing'
import Index from '@/pages/Index'
import { AdminPanel } from '@/components/admin/AdminPanel'
import { UserDashboard } from '@/components/user/UserDashboard'
import { AuthGuard } from '@/components/auth/AuthGuard'

export const router = createBrowserRouter([
  {
    path: '/',
    element: <Landing />,
  },
  {
    path: '/map',
    element: <Index />,
  },
  {
    path: '/admin/*',
    element: (
      <AuthGuard requiredRole="admin">
        <AdminPanel />
      </AuthGuard>
    ),
  },
  {
    path: '/user/*',
    element: (
      <AuthGuard>
        <UserDashboard />
      </AuthGuard>
    ),
  },
])



// C:\Users\israe\Documents\GitHub\recentmap\src\services\formService.ts
import { useForm } from '@formspree/react'

export const FORM_ID = import.meta.env.VITE_FORMSPREE_FORM_ID || ''

export const submitServiceRequest = async (data: any) => {
  try {
    const response = await fetch(`https://formspree.io/f/${FORM_ID}`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        ...data,
        timestamp: new Date().toISOString(),
        source: 'website',
      }),
    })

    if (response.ok) {
      return {
        success: true,
        message: 'Service request submitted successfully',
      }
    } else {
      throw new Error('Failed to submit form')
    }
  } catch (error) {
    console.error('Form submission error:', error)
    throw error
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\src\services\geocodingService.ts
interface GeocodingOptions {
  fuzzyMatch?: boolean
  limit?: number
  countryCode?: string
  proximity?: { lat: number; lng: number }
  language?: string
  viewbox?: { minLon: number; minLat: number; maxLon: number; maxLat: number }
  bounded?: boolean
}

const FALLBACK_GEOCODING_URL = 'https://nominatim.openstreetmap.org'
const NUEVO_LEON_COORDS = { lat: 25.5922, lng: -99.9962 }
const GEOCODING_DELAY = 1000
const DEFAULT_VIEWBOX = {
  minLon: -100.5,
  minLat: 25.0,
  maxLon: -99.5,
  maxLat: 26.0,
}
let lastRequestTime = 0

const calculateDistance = (
  lat1: number,
  lon1: number,
  lat2: number,
  lon2: number,
): number => {
  const R = 6371
  const dLat = ((lat2 - lat1) * Math.PI) / 180
  const dLon = ((lon2 - lon1) * Math.PI) / 180
  const a =
    Math.sin(dLat / 2) * Math.sin(dLat / 2) +
    Math.cos((lat1 * Math.PI) / 180) *
      Math.cos((lat2 * Math.PI) / 180) *
      Math.sin(dLon / 2) *
      Math.sin(dLon / 2)
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a))
  return R * c
}

const wait = (ms: number) => new Promise((resolve) => setTimeout(resolve, ms))

const fetchWithRetry = async (
  url: string,
  options?: RequestInit,
  retries = 3,
): Promise<Response> => {
  const defaultHeaders = {
    Accept: 'application/json',
    'User-Agent': 'MRGruas Application (https://mrgruas.github.io)',
    Referer: 'https://mrgruas.github.io',
    Origin: window.location.origin,
  }

  for (let i = 0; i < retries; i++) {
    try {
      const response = await fetch(url, {
        ...options,
        headers: { ...defaultHeaders, ...options?.headers },
        mode: 'cors',
        credentials: 'omit',
      })

      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`)
      }

      return response
    } catch (error) {
      console.error(`Attempt ${i + 1} failed:`, error)
      if (i === retries - 1) {
        return new Response(
          JSON.stringify([
            {
              lat: NUEVO_LEON_COORDS.lat,
              lon: NUEVO_LEON_COORDS.lng,
              display_name: 'Ubicación en Nuevo León',
              importance: 0.5,
            },
          ]),
        )
      }
      await wait(1000 * Math.pow(2, i))
    }
  }
  throw new Error('Max retries reached')
}

export const generateSearchTerms = (query: string): string[] => {
  // Check if it's coordinates
  const coordsRegex = /^-?\d+\.?\d*,\s*-?\d+\.?\d*$/
  if (coordsRegex.test(query)) {
    return [query]
  }

  // Check if it's a highway kilometer
  const kmRegex = /^km\s*(\d+)/i
  const kmMatch = query.match(kmRegex)
  if (kmMatch) {
    const km = kmMatch[1]
    return [
      `km ${km} carretera nacional`,
      `km ${km} carretera miguel aleman`,
      `km ${km} carretera laredo`,
      `kilómetro ${km} nacional`,
      `kilómetro ${km} miguel aleman`,
      `kilómetro ${km} laredo`,
    ]
  }

  const baseTerms = [
    query,
    `${query}, Nuevo Leon`,
    `${query} km, Nuevo Leon`,
    `kilómetro ${query}, Nuevo Leon`,
    `km ${query}, Nuevo Leon`,
    `carretera ${query}, Nuevo Leon`,
    `${query} carretera, Nuevo Leon`,
    `cerca de ${query}, Nuevo Leon`,
    `${query} monterrey`,
    `${query} área metropolitana`,
    `${query} san nicolas`,
    `${query} guadalupe`,
    `${query} san pedro`,
    `${query} escobedo`,
    `${query} apodaca`,
    `${query} santa catarina`,
    `${query} juarez`,
    `${query} nuevo león`,
    `${query} nl`,
    `${query} mty`,
  ]

  if (/\d/.test(query)) {
    baseTerms.push(
      `km ${query} carretera nacional`,
      `km ${query} carretera miguel aleman`,
      `km ${query} carretera laredo`,
      `kilómetro ${query} nacional`,
      `kilómetro ${query} miguel aleman`,
      `kilómetro ${query} laredo`,
      `${query} km nacional`,
      `${query} km miguel aleman`,
      `${query} km laredo`,
    )
  }

  return baseTerms
}

export const getAddressFromCoordinates = async (
  lat: number,
  lng: number,
  options: GeocodingOptions = {},
): Promise<string> => {
  const timeSinceLastRequest = Date.now() - lastRequestTime
  if (timeSinceLastRequest < GEOCODING_DELAY) {
    await wait(GEOCODING_DELAY - timeSinceLastRequest)
  }

  try {
    lastRequestTime = Date.now()
    const params = new URLSearchParams({
      format: 'json',
      lat: lat.toString(),
      lon: lng.toString(),
      'accept-language': options.language || 'es',
    })

    const response = await fetchWithRetry(
      `${FALLBACK_GEOCODING_URL}/reverse?${params.toString()}`,
    )

    const data = await response.json()
    return data.display_name || 'Ubicación seleccionada'
  } catch (error) {
    console.error('Error fetching address:', error)
    return 'Ubicación seleccionada'
  }
}

export const searchAddresses = async (
  query: string,
  options: GeocodingOptions = {},
): Promise<
  Array<{
    address: string
    lat: number
    lon: number
    distance: number
    importance?: number
  }>
> => {
  if (!query || query.length < 3) return []

  const timeSinceLastRequest = Date.now() - lastRequestTime
  if (timeSinceLastRequest < GEOCODING_DELAY) {
    await wait(GEOCODING_DELAY - timeSinceLastRequest)
  }

  try {
    lastRequestTime = Date.now()
    const enhancedQuery = `${query}, Nuevo Leon, Mexico`

    const params = new URLSearchParams({
      format: 'json',
      q: enhancedQuery,
      limit: (options.limit || 10).toString(),
      'accept-language': options.language || 'es',
      countrycodes: options.countryCode || 'mx',
      bounded: '1',
      viewbox: `${DEFAULT_VIEWBOX.minLon},${DEFAULT_VIEWBOX.maxLat},${DEFAULT_VIEWBOX.maxLon},${DEFAULT_VIEWBOX.minLat}`,
    })

    const response = await fetchWithRetry(
      `${FALLBACK_GEOCODING_URL}/search?${params.toString()}`,
    )

    const data = await response.json()

    if (!Array.isArray(data)) {
      console.warn('Received non-array response:', data)
      return []
    }

    const results = data.map((item: any) => ({
      address: item.display_name,
      lat: parseFloat(item.lat),
      lon: parseFloat(item.lon),
      distance: calculateDistance(
        parseFloat(item.lat),
        parseFloat(item.lon),
        NUEVO_LEON_COORDS.lat,
        NUEVO_LEON_COORDS.lng,
      ),
      importance: item.importance || 0,
    }))

    return results
      .filter((result) => !isNaN(result.lat) && !isNaN(result.lon))
      .sort((a, b) => {
        const distanceWeight = options.proximity ? 0.7 : 0.5
        const importanceWeight = 1 - distanceWeight

        const scoreA =
          distanceWeight * (1 / (a.distance + 1)) +
          importanceWeight * (a.importance || 0)
        const scoreB =
          distanceWeight * (1 / (b.distance + 1)) +
          importanceWeight * (b.importance || 0)

        return scoreB - scoreA
      })
  } catch (error) {
    console.error('Error searching addresses:', error)
    return [
      {
        address: 'Nuevo León, México',
        lat: NUEVO_LEON_COORDS.lat,
        lon: NUEVO_LEON_COORDS.lng,
        distance: 0,
      },
    ]
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\src\services\notificationService.ts
import axios from 'axios'

const TELEGRAM_BOT_TOKEN = import.meta.env.VITE_TELEGRAM_BOT_TOKEN
const TELEGRAM_CHAT_ID = import.meta.env.VITE_TELEGRAM_CHAT_ID
const FORMSPREE_ENDPOINT = import.meta.env.VITE_FORMSPREE_ENDPOINT

export const sendTelegramNotification = async (message: string) => {
  if (!TELEGRAM_BOT_TOKEN || !TELEGRAM_CHAT_ID) {
    console.warn('Telegram credentials not configured')
    return
  }

  try {
    await axios.post(
      `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`,
      {
        chat_id: TELEGRAM_CHAT_ID,
        text: message,
        parse_mode: 'HTML',
      },
    )
  } catch (error) {
    console.error('Error sending Telegram notification:', error)
  }
}

export const submitToFormspree = async (data: any) => {
  if (!FORMSPREE_ENDPOINT) {
    console.warn('Formspree endpoint not configured')
    return
  }

  try {
    const response = await axios.post(FORMSPREE_ENDPOINT, data)
    return response.data
  } catch (error) {
    console.error('Error submitting to Formspree:', error)
    throw error
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\src\services\osrmService.ts
const OSRM_API_URLS = [
  'https://routing.openstreetmap.de/routed-car/route/v1/driving',
  'https://router.project-osrm.org/route/v1/driving',
]

const MIN_REQUEST_INTERVAL = 1100 // Slightly over 1 second to be safe
const MAX_RETRIES = 3
const BACKOFF_FACTOR = 2
let lastRequestTime = 0
let requestQueue: Promise<any> = Promise.resolve()

interface Coordinates {
  lat: number
  lng: number
}

interface OSRMResponse {
  routes: {
    distance: number
    duration: number
    geometry: string
  }[]
}

const wait = (ms: number) => new Promise((resolve) => setTimeout(resolve, ms))

const calculateBackoffDelay = (attempt: number): number => {
  return Math.min(
    MIN_REQUEST_INTERVAL * Math.pow(BACKOFF_FACTOR, attempt),
    5000,
  )
}

const enforceRateLimit = async () => {
  const now = Date.now()
  const timeSinceLastRequest = now - lastRequestTime

  if (timeSinceLastRequest < MIN_REQUEST_INTERVAL) {
    await wait(MIN_REQUEST_INTERVAL - timeSinceLastRequest)
  }
  lastRequestTime = Date.now()
}

async function tryFetchWithUrls(
  urls: string[],
  coordinates: string,
  options: RequestInit,
  attempt = 0,
): Promise<Response> {
  const errors: Error[] = []

  // Enforce rate limiting
  await enforceRateLimit()

  for (const baseUrl of urls) {
    try {
      const url = `${baseUrl}/${coordinates}?overview=full&geometries=polyline`

      const response = await fetch(url, {
        ...options,
        method: 'GET',
        mode: 'cors',
        headers: {
          Accept: 'application/json',
          'User-Agent': 'TowingServiceApplication/1.0',
          Referer: 'https://mrgruas.com',
        },
      })

      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`)
      }

      // Handle rate limiting
      if (response.status === 429) {
        const backoffDelay = calculateBackoffDelay(attempt)
        await wait(backoffDelay)
        if (attempt < MAX_RETRIES) {
          return tryFetchWithUrls(urls, coordinates, options, attempt + 1)
        }
      }

      return response
    } catch (error) {
      console.error(`Error with ${baseUrl}:`, error)
      errors.push(
        error instanceof Error
          ? error
          : new Error(`Unknown error from ${baseUrl}`),
      )
      continue
    }
  }

  if (attempt < MAX_RETRIES) {
    console.log(`Retrying request, attempt ${attempt + 1} of ${MAX_RETRIES}`)
    const backoffDelay = calculateBackoffDelay(attempt)
    await wait(backoffDelay)
    return tryFetchWithUrls(urls, coordinates, options, attempt + 1)
  }

  throw new Error(
    `All routing services failed after ${MAX_RETRIES} retries. Errors: ${errors.map((e) => e.message).join(', ')}`,
  )
}

export async function getRouteFromOSRM(
  start: Coordinates,
  end: Coordinates,
): Promise<{
  distance: number
  duration: number
  geometry: string
}> {
  const coordinates = `${start.lng},${start.lat};${end.lng},${end.lat}`

  try {
    // Queue this request
    const result = await new Promise((resolve, reject) => {
      requestQueue = requestQueue
        .then(() =>
          tryFetchWithUrls(OSRM_API_URLS, coordinates, {
            headers: {
              Accept: 'application/json',
              'User-Agent': 'TowingServiceApplication/1.0',
              Referer: 'https://mrgruas.com',
            },
          }),
        )
        .then((response) => response.json())
        .then(resolve)
        .catch(reject)
    })

    const data = result as OSRMResponse

    if (!data.routes || data.routes.length === 0) {
      throw new Error('No route found between the specified locations.')
    }

    return {
      distance: data.routes[0].distance / 1000, // Convert to kilometers
      duration: data.routes[0].duration,
      geometry: data.routes[0].geometry,
    }
  } catch (error) {
    throw error
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\src\services\routeService.ts
import { Location, RouteResponse } from '@/types/service'
import { getRouteFromOSRM } from './osrmService'

export const COMPANY_LOCATION: Location = {
  lat: 26.509672,
  lng: -100.0095504,
}

export const getRouteDetails = async (
  origin: Location,
  destination: Location,
): Promise<RouteResponse> => {
  try {
    const route = await getRouteFromOSRM(origin, destination)

    // Add traffic factor based on time of day
    const trafficFactor = calculateTrafficFactor()

    return {
      ...route,
      distance: route.distance * trafficFactor,
      duration: route.duration * trafficFactor,
    }
  } catch (error) {
    throw new Error('Failed to calculate route details')
  }
}

const calculateTrafficFactor = (): number => {
  const hour = new Date().getHours()

  // Rush hour adjustments
  if ((hour >= 7 && hour <= 9) || (hour >= 17 && hour <= 19)) {
    return 1.3 // 30% longer during rush hours
  }

  // Night time adjustments
  if (hour >= 22 || hour <= 5) {
    return 0.9 // 10% shorter during night
  }

  return 1.0 // Normal traffic during other hours
}



// C:\Users\israe\Documents\GitHub\recentmap\src\types\form.ts
import { z } from 'zod'

export const formSchema = z.object({
  userName: z.string().min(1, 'Username is required'),
  phone: z.string().min(1, 'Phone number is required'),
  vehicleMake: z.string().min(1, 'Vehicle make is required'),
  vehicleModel: z.string().min(1, 'Vehicle model is required'),
  vehicleYear: z.string().min(1, 'Vehicle year is required'),
  vehicleColor: z.string().min(1, 'Vehicle color is required'),
  truckType: z.enum(['A', 'B', 'C', 'D']),
  requiresManeuver: z.boolean().default(false),
  issueDescription: z.string().optional(),
  pickupLocation: z
    .object({
      lat: z.number(),
      lng: z.number(),
      address: z.string(),
    })
    .optional(),
  dropoffLocation: z
    .object({
      lat: z.number(),
      lng: z.number(),
      address: z.string(),
    })
    .optional(),
})

export type FormData = z.infer<typeof formSchema>

export const vehicleFormSchema = formSchema



// C:\Users\israe\Documents\GitHub\recentmap\src\types\location.ts
// Interface representing a Location entity
export interface Location {
  id: string
  name: string
  address?: string
  city?: string
  state?: string
  country?: string
  postalCode?: string
  latitude?: number
  longitude?: number
  createdAt?: Date
  updatedAt?: Date
}

// Input structure for creating or updating a location
export interface LocationInput {
  name: string
  address?: string
  city?: string
  state?: string
  country?: string
  postalCode?: string
  latitude?: number
  longitude?: number
}

// Filter criteria for querying locations
export interface LocationFilter {
  id?: string
  name?: string
  city?: string
  state?: string
  country?: string
}

// Interface for representing a location search result with distance and formatted address
export interface LocationResult {
  id: string
  name: string
  address: string
  city: string
  state: string
  zip: string
  lat: number
  lon: number
  distance: number
  formattedAddress: string
  onSelectingPickup?: (selecting: boolean) => void
}

// Interface representing the minimal search result for a location search
export interface LocationSearchResult {
  address: string
  lat: number
  lon: number
  distance: number
}

// Structure for API response regarding locations
export interface LocationResponse {
  success: boolean
  message?: string
  data?: Location
  error?: string
  results?: LocationResult[]
}



// C:\Users\israe\Documents\GitHub\recentmap\src\types\service.ts
export interface Location {
  lat: number
  lng: number
}

export interface RouteResponse {
  geometry: string
  distance: number
  duration: number
}

export interface ServiceRequest {
  id: string
  status: 'pending' | 'completed'
  createdAt: Date
  username: string
  vehicleMake: string
  vehicleModel: string
  vehicleYear: number
  vehicleColor: string
  truckType: string
  issueDescription: string
  pickupLocation?: Location
  dropLocation?: Location
  serviceType: 'standard' | 'flatbed' | 'emergency'
  requiresManeuver: boolean
  tollFees: number
}



// C:\Users\israe\Documents\GitHub\recentmap\src\utils\addressUtils.ts


// C:\Users\israe\Documents\GitHub\recentmap\src\utils\downloadUtils.ts
export type TowTruckType = 'A' | 'B' | 'C' | 'D'

export interface TowTruckDetails {
  name: string
  capacity: string
  perKm: number
  maneuverCharge: number
  maxWeight: number
}

export const downloadServiceInfo = (data: any, format: 'csv' | 'txt') => {
  const content =
    format === 'csv' ? convertToCSV(data) : JSON.stringify(data, null, 2)

  const blob = new Blob([content], {
    type: format === 'csv' ? 'text/csv' : 'text/plain',
  })
  const url = window.URL.createObjectURL(blob)
  const a = document.createElement('a')
  a.href = url
  a.download = `service-info.${format}`
  a.click()
  window.URL.revokeObjectURL(url)
}

const convertToCSV = (data: any) => {
  const headers = Object.keys(data)
  const values = Object.values(data)
  return `${headers.join(',')}\n${values.join(',')}`
}



// C:\Users\israe\Documents\GitHub\recentmap\src\utils\emailService.ts
import { BillDetails } from './billingUtils'

// This is a mock email service - replace with your actual email service implementation
export const sendEmail = async (
  to: string,
  subject: string,
  html: string,
): Promise<boolean> => {
  console.log(`Email would be sent to ${to}`)
  console.log(`Subject: ${subject}`)
  console.log(`Content: ${html}`)

  // Simulate API call
  await new Promise((resolve) => setTimeout(resolve, 1000))
  return true
}

export const sendBillEmails = async (
  billDetails: BillDetails,
  billHtml: string,
): Promise<void> => {
  const adminEmail = 'admin@example.com' // Replace with actual admin email

  // Send to user
  await sendEmail(
    billDetails.userEmail,
    `Confirmación de Servicio de Grúa - ${billDetails.invoiceNumber}`,
    billHtml,
  )

  // Send to admin
  await sendEmail(
    adminEmail,
    `Nueva Solicitud de Servicio - ${billDetails.invoiceNumber}`,
    billHtml,
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\utils\errorHandling.ts
import { toast } from '@/hooks/use-toast'

export class APIError extends Error {
  constructor(
    message: string,
    public statusCode?: number,
    public details?: unknown,
  ) {
    super(message)
    this.name = 'APIError'
  }
}

export const handleError = (error: unknown) => {
  if (error instanceof APIError) {
    toast({
      title: 'API Error',
      description: error.message,
      variant: 'destructive',
    })
    return
  }

  if (error instanceof Error) {
    toast({
      title: 'Error',
      description: error.message,
      variant: 'destructive',
    })
    return
  }

  toast({
    title: 'Unknown Error',
    description: 'An unexpected error occurred',
    variant: 'destructive',
  })
}

export const createAPIError = (
  response: Response,
  message?: string,
): APIError => {
  return new APIError(
    message || `Request failed with status ${response.status}`,
    response.status,
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\src\utils\mapUtils.ts
import L from 'leaflet'

export const ENTERPRISE_LOCATIONS = [
  { lat: 26.510272, lng: -100.006323, name: 'Main Service Center' },
]

export const enterpriseIcon = new L.Icon({
  iconUrl:
    'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-blue.png',
  shadowUrl:
    'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
  iconSize: [25, 41],
  iconAnchor: [12, 41],
  popupAnchor: [1, -34],
  shadowSize: [41, 41],
})

export const pickupIcon = new L.Icon({
  iconUrl:
    'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png',
  shadowUrl:
    'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
  iconSize: [25, 41],
  iconAnchor: [12, 41],
  popupAnchor: [1, -34],
  shadowSize: [41, 41],
})

export const dropIcon = new L.Icon({
  iconUrl:
    'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-red.png',
  shadowUrl:
    'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
  iconSize: [25, 41],
  iconAnchor: [12, 41],
  popupAnchor: [1, -34],
  shadowSize: [41, 41],
})



// C:\Users\israe\Documents\GitHub\recentmap\src\utils\notificationUtils.tsx
import { toast } from '@/hooks/use-toast'
import { Check, AlertTriangle, Info, MapPin } from 'lucide-react'

const NOTIFICATION_COOLDOWN = 10000
const notificationTimestamps: { [key: string]: number } = {}

const shouldShowNotification = (type: string): boolean => {
  const now = Date.now()
  const lastShown = notificationTimestamps[type] || 0

  if (now - lastShown > NOTIFICATION_COOLDOWN) {
    notificationTimestamps[type] = now
    return true
  }
  return false
}

export const showLocationNotification = (
  type: 'pickup' | 'drop',
  coords: { lat: number; lng: number },
) => {
  if (!shouldShowNotification(`location_${type}`)) return

  toast({
    title: `${type === 'pickup' ? 'Pickup' : 'Drop-off'} Location Set`,
    description: (
      <div className="flex items-center gap-2">
        <MapPin className="h-4 w-4" />
        <span>
          Coordinates: {coords.lat.toFixed(4)}, {coords.lng.toFixed(4)}
        </span>
      </div>
    ),
    duration: 5000,
    className: 'bg-green-50 border-green-200',
  })
}

export const showRouteNotification = (distance: number) => {
  if (!shouldShowNotification('route')) return

  toast({
    title: 'Route Calculated',
    description: (
      <div className="flex items-center gap-2">
        <Info className="h-4 w-4" />
        <span>Total route distance: {distance.toFixed(2)} km</span>
      </div>
    ),
    duration: 5000,
    className: 'bg-blue-50 border-blue-200',
  })
}

export const showRouteErrorNotification = (error: string) => {
  if (!shouldShowNotification('route_error')) return

  toast({
    title: 'Route Calculation Error',
    description: (
      <div className="flex items-center gap-2">
        <AlertTriangle className="h-4 w-4" />
        <span>{error}</span>
      </div>
    ),
    duration: 7000,
    variant: 'destructive',
  })
}

export const showPaymentNotification = (success: boolean, error?: string) => {
  if (!shouldShowNotification('payment')) return

  if (success) {
    toast({
      title: 'Payment Successful',
      description: (
        <div className="flex items-center gap-2">
          <Check className="h-4 w-4" />
          <span>Tow truck request confirmed!</span>
        </div>
      ),
      duration: 5000,
      className: 'bg-green-50 border-green-200',
    })
  } else {
    toast({
      title: 'Payment Error',
      description: (
        <div className="flex items-center gap-2">
          <AlertTriangle className="h-4 w-4" />
          <span>{error || 'Payment processing error'}</span>
        </div>
      ),
      duration: 5000,
      variant: 'destructive',
    })
  }
}



// C:\Users\israe\Documents\GitHub\recentmap\src\utils\PaymentForm.tsx
import React from 'react'
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
  DialogFooter,
} from '@/components/ui/dialog'
import { Button } from '@/components/ui/button'
import { useToast } from '@/hooks/use-toast'
import { CardElement, useStripe, useElements } from '@stripe/react-stripe-js'
import { CreditCard, Calendar, CheckCircle, Shield } from 'lucide-react'
import { cn } from '@/lib/utils'
import {
  processPayment,
  validatePaymentDetails,
} from '@/utils/paymentProcessor'

interface PaymentWindowProps {
  isOpen: boolean
  onClose: () => void
  onPaymentSubmit?: (result: { success: boolean; error?: string }) => void
  amount: number
}

const PaymentWindow = ({
  isOpen,
  onClose,
  onPaymentSubmit,
  amount = 0,
}: PaymentWindowProps) => {
  const stripe = useStripe()
  const elements = useElements()
  const { toast } = useToast()
  const [isProcessing, setIsProcessing] = React.useState(false)
  const [cardComplete, setCardComplete] = React.useState(false)

  React.useEffect(() => {
    if (isOpen) {
      setCardComplete(false)
    }
  }, [isOpen])

  const handleClose = () => {
    if (isProcessing) {
      toast({
        title: 'Pago en Proceso',
        description: 'Por favor, espere mientras procesamos su pago',
        variant: 'destructive',
      })
      return
    }
    onClose()
  }

  const handleSubmit = async (event: React.FormEvent) => {
    event.preventDefault()

    if (!cardComplete) {
      toast({
        title: 'Datos Incompletos',
        description: 'Por favor, complete todos los datos de la tarjeta',
        variant: 'destructive',
      })
      return
    }

    setIsProcessing(true)

    if (!stripe || !elements) {
      toast({
        title: 'Error',
        description: 'Sistema de pago no disponible. Intente más tarde.',
        variant: 'destructive',
      })
      setIsProcessing(false)
      return
    }

    const cardElement = elements.getElement(CardElement)
    if (!validatePaymentDetails(cardElement)) {
      setIsProcessing(false)
      return
    }

    try {
      const { error, paymentMethod } = await stripe.createPaymentMethod({
        type: 'card',
        card: cardElement,
      })

      if (error) {
        throw error
      }

      const result = await processPayment(amount)

      if (result.success) {
        toast({
          title: 'Pago Exitoso',
          description: `Transacción completada. ID: ${result.transactionId}`,
        })
        onPaymentSubmit?.({ success: true })
        onClose()
      } else {
        throw new Error(result.error)
      }
    } catch (err: any) {
      toast({
        title: 'Error en el Pago',
        description: err.message || 'Ocurrió un error al procesar el pago',
        variant: 'destructive',
      })
      onPaymentSubmit?.({ success: false, error: err.message })
    } finally {
      setIsProcessing(false)
    }
  }

  return (
    <Dialog open={isOpen} onOpenChange={handleClose}>
      <DialogContent className="sm:max-w-md bg-gradient-to-br from-white to-gray-50 border-gray-200">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2 text-xl font-semibold">
            <CreditCard className="w-5 h-5 text-primary" />
            Pago Seguro
          </DialogTitle>
        </DialogHeader>

        <form onSubmit={handleSubmit} className="space-y-6">
          <div className="space-y-4">
            <div className="bg-white p-4 rounded-lg border border-gray-200 shadow-sm">
              <CardElement
                onChange={(e) => setCardComplete(e.complete)}
                options={{
                  style: {
                    base: {
                      fontSize: '16px',
                      color: '#424770',
                      '::placeholder': {
                        color: '#aab7c4',
                      },
                    },
                    invalid: {
                      color: '#9e2146',
                    },
                  },
                  hidePostalCode: true,
                }}
              />
            </div>

            <div className="flex items-center justify-between text-sm text-gray-600">
              <span className="flex items-center gap-1.5">
                <Shield className="w-4 h-4" />
                Encriptación SSL Segura
              </span>
              <span className="flex items-center gap-1.5">
                <Calendar className="w-4 h-4" />
                {new Date().toLocaleDateString()}
              </span>
            </div>

            <div className="flex items-center justify-between px-2">
              <span className="text-sm text-gray-600">Cargo por Servicio</span>
              <span className="text-lg font-semibold text-primary">
                ${amount.toFixed(2)}
              </span>
            </div>
          </div>

          <div className="flex gap-3 justify-end">
            <Button
              type="button"
              variant="outline"
              onClick={handleClose}
              disabled={isProcessing}
              className="border-gray-300 hover:bg-gray-100"
            >
              Cancelar
            </Button>
            <Button
              type="submit"
              disabled={!stripe || isProcessing || !cardComplete}
              className={cn(
                'bg-gradient-to-r from-primary to-primary/90 hover:from-primary/90 hover:to-primary text-white min-w-[120px]',
                isProcessing && 'opacity-80',
              )}
            >
              {isProcessing ? (
                <span className="flex items-center gap-2">
                  <div className="w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin" />
                  Procesando...
                </span>
              ) : (
                <span className="flex items-center gap-2">
                  <CheckCircle className="w-4 h-4" />
                  Pagar ${amount.toFixed(2)}
                </span>
              )}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  )
}

export default PaymentWindow



// C:\Users\israe\Documents\GitHub\recentmap\src\utils\paymentProcessor.ts
import { toast } from '@/hooks/use-toast'

interface PaymentResult {
  success: boolean
  error?: string
  transactionId?: string
}

export const processPayment = async (
  amount: number,
): Promise<PaymentResult> => {
  try {
    // Simulate payment processing delay
    await new Promise((resolve) => setTimeout(resolve, 1500))

    // Simulate successful payment with 90% probability
    const isSuccessful = Math.random() < 0.9

    if (!isSuccessful) {
      throw new Error('Payment processing failed. Please try again.')
    }

    // Generate a mock transaction ID
    const transactionId = `TRX-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`

    return {
      success: true,
      transactionId,
    }
  } catch (error: any) {
    return {
      success: false,
      error: error.message || 'An unexpected error occurred',
    }
  }
}

export const validatePaymentDetails = (cardElement: any) => {
  if (!cardElement) {
    toast({
      title: 'Error de Validación',
      description: 'Por favor, ingrese los detalles de la tarjeta',
      variant: 'destructive',
    })
    return false
  }
  return true
}



// C:\Users\israe\Documents\GitHub\recentmap\src\utils\priceCalculator.ts
import { towTruckTypes, TowTruckType } from './towTruckPricing'

export const formatCurrency = (amount: number): string => {
  return `$${amount.toFixed(2)} MXN`
}

export const calculateTotalCost = (
  distance: number,
  truckType: string,
  requiresManeuver: boolean,
  tollCosts: number = 0,
  requiresInvoice: boolean = false,
): number => {
  const truck = towTruckTypes[truckType || 'A']
  const baseCost = calculateBaseCost(distance, truckType)
  const maneuverCost = requiresManeuver ? truck.maneuverCharge : 0
  const flagDropFee = truck.flagDropFee
  const subtotal = baseCost + maneuverCost + tollCosts + flagDropFee
  const tax = requiresInvoice ? subtotal * 0.16 : 0
  return subtotal + tax
}

export const calculateBaseCost = (
  distance: number,
  truckType: string,
): number => {
  const truck = towTruckTypes[truckType || 'A']
  return distance * truck.perKm
}

export const COMPANY_LOCATION = { lat: 26.510272, lng: -100.006323 }



// C:\Users\israe\Documents\GitHub\recentmap\src\utils\routeCalculator.ts
interface Location {
  lat: number
  lng: number
}

const MEXICAN_ROADS_ADJUSTMENT = 1.15 // 15% adjustment for Mexican roads
const URBAN_AREA_THRESHOLD = 0.1 // 100m threshold for urban area detection

export const calculateRoadDistance = async (
  point1: Location,
  point2: Location,
): Promise<number> => {
  try {
    const response = await fetch(
      `https://router.project-osrm.org/route/v1/driving/${point1.lng},${point1.lat};${point2.lng},${point2.lat}?overview=false&alternatives=true`,
    )

    if (!response.ok) {
      throw new Error('Error al obtener la ruta')
    }

    const data = await response.json()

    if (!data.routes || data.routes.length === 0) {
      throw new Error('No se encontró ninguna ruta')
    }

    // Find the most efficient route
    const bestRoute = data.routes.reduce((best: any, current: any) => {
      return current.duration / current.distance < best.duration / best.distance
        ? current
        : best
    }, data.routes[0])

    // Apply Mexican roads adjustment
    return Number(
      ((bestRoute.distance / 1000) * MEXICAN_ROADS_ADJUSTMENT).toFixed(2),
    )
  } catch (error) {
    console.error('Error calculando la distancia por carretera:', error)
    return (
      calculateStraightLineDistance(point1, point2) * MEXICAN_ROADS_ADJUSTMENT
    )
  }
}

const calculateStraightLineDistance = (
  point1: Location,
  point2: Location,
): number => {
  const R = 6371
  const dLat = ((point2.lat - point1.lat) * Math.PI) / 180
  const dLon = ((point2.lng - point1.lng) * Math.PI) / 180
  const a =
    Math.sin(dLat / 2) * Math.sin(dLat / 2) +
    Math.cos((point1.lat * Math.PI) / 180) *
      Math.cos((point2.lat * Math.PI) / 180) *
      Math.sin(dLon / 2) *
      Math.sin(dLon / 2)
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a))
  return Number((R * c).toFixed(2))
}



// C:\Users\israe\Documents\GitHub\recentmap\src\utils\tollCalculator.ts
import { TOLL_LOCATIONS } from '@/data/tollData'
import { calculateDistance } from './distanceUtils'
import { getRouteDetails } from '@/services/routeService'
import { COMPANY_LOCATION } from './priceCalculator'

interface Location {
  lat: number
  lng: number
}

const TOLL_DETECTION_RADIUS = 0.5 // Reduced from 1.0 to 0.5 km for more precision
const TOLL_BUFFER_DISTANCE = 0.1 // Reduced from 0.2 to 0.1 km for more accuracy

export const detectTollsOnRoute = async (
  pickupLocation: Location,
  dropLocation: Location,
) => {
  try {
    const routes = await getRouteSegments(pickupLocation, dropLocation)
    const routePoints = extractRoutePoints(routes)

    // Enhanced toll detection with direction-aware logic
    const outboundTolls = detectTollsForSegment(
      pickupLocation,
      dropLocation,
      routePoints,
      'outbound',
    )
    const returnTolls = detectTollsForSegment(
      dropLocation,
      COMPANY_LOCATION,
      routePoints,
      'return',
    )

    // Filter out duplicate tolls based on location proximity
    const allTolls = removeDuplicateTolls([...outboundTolls, ...returnTolls])
    const totalTollCost = calculateTotalTollCost(allTolls)

    return { tolls: allTolls, totalTollCost, routeDetails: routes }
  } catch (error) {
    console.warn('Error detecting tolls:', error)
    return { tolls: [], totalTollCost: 0, routeDetails: null }
  }
}

const getRouteSegments = async (
  pickupLocation: Location,
  dropLocation: Location,
) => {
  const companyToPickup = await getRouteDetails(
    COMPANY_LOCATION,
    pickupLocation,
  )
  const pickupToDrop = await getRouteDetails(pickupLocation, dropLocation)
  const dropToCompany = await getRouteDetails(dropLocation, COMPANY_LOCATION)

  return { outbound: pickupToDrop, return: dropToCompany }
}

const extractRoutePoints = (routes: any) => {
  const points: [number, number][] = []
  if (routes.outbound?.geometry)
    points.push(...decodePolyline(routes.outbound.geometry))
  if (routes.return?.geometry)
    points.push(...decodePolyline(routes.return.geometry))
  return points
}

const detectTollsForSegment = (
  start: Location,
  end: Location,
  routePoints: [number, number][],
  direction: 'outbound' | 'return',
) => {
  return TOLL_LOCATIONS.filter((toll) => {
    // Enhanced proximity detection
    const nearStart = calculateDistance(start, toll) <= TOLL_DETECTION_RADIUS
    const nearEnd = calculateDistance(end, toll) <= TOLL_DETECTION_RADIUS

    // Check if toll is near any point on the route
    const nearRoute = routePoints.some(
      (point) =>
        calculateDistance({ lat: point[0], lng: point[1] }, toll) <=
        TOLL_BUFFER_DISTANCE,
    )

    // Additional check for toll direction based on route angle
    const isInDirection = checkTollDirection(start, end, toll)

    return (nearStart || nearEnd || nearRoute) && isInDirection
  }).map((toll) => ({
    ...toll,
    direction,
    // Adjust cost based on direction and vehicle type
    cost: adjustTollCost(toll.cost, direction),
  }))
}

const checkTollDirection = (
  start: Location,
  end: Location,
  toll: Location,
): boolean => {
  const routeAngle = Math.atan2(end.lat - start.lat, end.lng - start.lng)
  const tollAngle = Math.atan2(toll.lat - start.lat, toll.lng - start.lng)
  const angleDiff = Math.abs(routeAngle - tollAngle)
  return angleDiff <= Math.PI / 4 // 45-degree tolerance
}

const adjustTollCost = (
  baseCost: number,
  direction: 'outbound' | 'return',
): number => {
  // Return trips might have different rates
  return direction === 'return' ? baseCost * 0.9 : baseCost
}

const removeDuplicateTolls = (tolls: any[]) => {
  return tolls.filter(
    (toll, index, self) =>
      index ===
      self.findIndex((t) => calculateDistance(toll, t) < TOLL_BUFFER_DISTANCE),
  )
}

const calculateTotalTollCost = (tolls: any[]): number => {
  return tolls.reduce((sum, toll) => sum + toll.cost, 0)
}

const decodePolyline = (str: string, precision = 5) => {
  let index = 0,
    lat = 0,
    lng = 0,
    coordinates: [number, number][] = []
  const factor = Math.pow(10, precision)

  while (index < str.length) {
    let result = 0,
      shift = 0,
      byte

    do {
      byte = str.charCodeAt(index++) - 63
      result |= (byte & 0x1f) << shift
      shift += 5
    } while (byte >= 0x20)

    const latitude_change = result & 1 ? ~(result >> 1) : result >> 1

    result = 0
    shift = 0

    do {
      byte = str.charCodeAt(index++) - 63
      result |= (byte & 0x1f) << shift
      shift += 5
    } while (byte >= 0x20)

    const longitude_change = result & 1 ? ~(result >> 1) : result >> 1

    lat += latitude_change
    lng += longitude_change

    coordinates.push([lat / factor, lng / factor])
  }

  return coordinates
}



// C:\Users\israe\Documents\GitHub\recentmap\src\utils\tollUtils.ts
import { TollLocation } from '@/data/tollData'

/**
 * Separates tolls by direction (outbound/return)
 */
export const separateTollsByDirection = (tolls: TollLocation[]) => {
  return {
    outboundTolls: tolls.filter((toll) => toll.direction === 'outbound'),
    returnTolls: tolls.filter((toll) => toll.direction === 'return'),
  }
}

/**
 * Formats toll information for display
 */
export const formatTollInfo = (toll: TollLocation) => ({
  name: toll.name,
  cost: toll.cost,
  operatingHours: toll.operatingHours,
  acceptedPayments: toll.acceptedPayments.join(', '),
})

/**
 * Calculates total toll cost for a route
 */
export const calculateTotalTollCost = (tolls: TollLocation[]): number => {
  return tolls.reduce((sum, toll) => sum + toll.cost, 0)
}



// C:\Users\israe\Documents\GitHub\recentmap\src\utils\TowingContext.tsx
import { createContext, useContext, useState, ReactNode } from 'react'
import { TollLocation } from '@/data/tollData'

export interface UserDetails {
  name: string
  email: string
  phone: string
  vehicleMake: string
  vehicleModel: string
  vehicleYear: string
  vehicleColor: string
}

interface Location {
  lat: number
  lng: number
  address?: string
}

interface TowingContextType {
  totalDistance: number
  totalCost: number
  detectedTolls: TollLocation[]
  totalTollCost: number
  truckType: 'A' | 'B' | 'C' | 'D'
  requiresManeuver: boolean
  selectedVehicleModel: string
  userDetails: UserDetails | null
  pickupLocation: Location | null
  dropLocation: Location | null
  updateTowingInfo: (distance: number) => void
  updateTollInfo: (tolls: TollLocation[], tollCost: number) => void
  updateTruckType: (type: 'A' | 'B' | 'C' | 'D') => void
  updateManeuverRequired: (required: boolean) => void
  updateSelectedVehicleModel: (model: string) => void
  updateUserDetails: (details: UserDetails) => void
  updateLocations: (pickup: Location | null, drop: Location | null) => void
}

const TowingContext = createContext<TowingContextType | undefined>(undefined)

export const TowingProvider = ({ children }: { children: ReactNode }) => {
  const [totalDistance, setTotalDistance] = useState(0)
  const [totalCost, setTotalCost] = useState(0)
  const [detectedTolls, setDetectedTolls] = useState<TollLocation[]>([])
  const [totalTollCost, setTotalTollCost] = useState(0)
  const [truckType, setTruckType] = useState<'A' | 'B' | 'C' | 'D'>('A')
  const [requiresManeuver, setRequiresManeuver] = useState(false)
  const [selectedVehicleModel, setSelectedVehicleModel] = useState('')
  const [userDetails, setUserDetails] = useState<UserDetails | null>(null)
  const [pickupLocation, setPickupLocation] = useState<Location | null>(null)
  const [dropLocation, setDropLocation] = useState<Location | null>(null)

  const updateTowingInfo = (distance: number) => {
    setTotalDistance(distance)
  }

  const updateTollInfo = (tolls: TollLocation[], tollCost: number) => {
    setDetectedTolls(tolls)
    setTotalTollCost(tollCost)
  }

  const updateTruckType = (type: 'A' | 'B' | 'C' | 'D') => {
    setTruckType(type)
  }

  const updateManeuverRequired = (required: boolean) => {
    setRequiresManeuver(required)
  }

  const updateSelectedVehicleModel = (model: string) => {
    setSelectedVehicleModel(model)
  }

  const updateUserDetails = (details: UserDetails) => {
    setUserDetails(details)
  }

  const updateLocations = (pickup: Location | null, drop: Location | null) => {
    setPickupLocation(pickup)
    setDropLocation(drop)
  }

  return (
    <TowingContext.Provider
      value={{
        totalDistance,
        totalCost,
        detectedTolls,
        totalTollCost,
        truckType,
        requiresManeuver,
        selectedVehicleModel,
        userDetails,
        pickupLocation,
        dropLocation,
        updateTowingInfo,
        updateTollInfo,
        updateTruckType,
        updateManeuverRequired,
        updateSelectedVehicleModel,
        updateUserDetails,
        updateLocations,
      }}
    >
      {children}
    </TowingContext.Provider>
  )
}

export const useTowing = () => {
  const context = useContext(TowingContext)
  if (context === undefined) {
    throw new Error('useTowing must be used within a TowingProvider')
  }
  return context
}



// C:\Users\israe\Documents\GitHub\recentmap\src\utils\towTruckPricing.ts
export interface TowTruckType {
  name: string
  capacity: string
  perKm: number
  maneuverCharge: number
  flagDropFee: number
  maxWeight: number
}

export const towTruckTypes: Record<string, TowTruckType> = {
  A: {
    name: 'Tipo A',
    capacity: 'hasta 2000kg',
    perKm: 18.82,
    maneuverCharge: 1219.55,
    flagDropFee: 528.69,
    maxWeight: 2000,
  },
  B: {
    name: 'Tipo B',
    capacity: 'hasta 3000kg',
    perKm: 20.62,
    maneuverCharge: 1336.73,
    flagDropFee: 607.43,
    maxWeight: 3000,
  },
  C: {
    name: 'Tipo C',
    capacity: 'hasta 4000kg',
    perKm: 23.47,
    maneuverCharge: 1524.21,
    flagDropFee: 721.79,
    maxWeight: 4000,
  },
  D: {
    name: 'Tipo D',
    capacity: 'hasta 8000kg',
    perKm: 32.35,
    maneuverCharge: 2101.65,
    flagDropFee: 885.84,
    maxWeight: 8000,
  },
}

// Vehicle type detection logic
export const getTruckTypeForVehicle = (
  model: string,
): 'A' | 'B' | 'C' | 'D' => {
  const modelLower = model.toLowerCase()

  if (isTypeDVehicle(modelLower)) return 'D'
  if (isTypeCVehicle(modelLower)) return 'C'
  if (isTypeBVehicle(modelLower)) return 'B'
  return 'A'
}

const isTypeDVehicle = (model: string): boolean => {
  const typeDVehicles = [
    'f-150',
    'f-250',
    'f-350',
    'f-450',
    'silverado',
    'sierra',
    'ram',
    'tundra',
    'titan',
    'super duty',
    'power wagon',
    'sprinter',
    'transit',
    'promaster',
  ]

  const heavyKeywords = [
    'heavy duty',
    'commercial',
    'camion',
    'truck',
    '2500',
    '3500',
    '4500',
    '5500',
  ]

  return (
    typeDVehicles.some((v) => model.includes(v)) ||
    heavyKeywords.some((k) => model.includes(k))
  )
}

const isTypeCVehicle = (model: string): boolean => {
  const typeCVehicles = [
    'murano',
    'pathfinder',
    'highlander',
    'pilot',
    '4runner',
    'expedition',
    'tahoe',
    'suburban',
    'sequoia',
    'armada',
    'telluride',
    'palisade',
  ]

  const largeKeywords = [
    'full-size',
    'large suv',
    'luxury suv',
    'van',
    'executive',
  ]

  return (
    typeCVehicles.some((v) => model.includes(v)) ||
    largeKeywords.some((k) => model.includes(k))
  )
}

const isTypeBVehicle = (model: string): boolean => {
  const typeBVehicles = [
    'rav4',
    'cr-v',
    'rogue',
    'tucson',
    'sportage',
    'equinox',
    'escape',
    'compass',
    'cherokee',
    'forester',
    'outback',
    'cx-5',
  ]

  const mediumKeywords = [
    'suv',
    'crossover',
    'pickup',
    'mid-size',
    'compact suv',
  ]

  return (
    typeBVehicles.some((v) => model.includes(v)) ||
    mediumKeywords.some((k) => model.includes(k))
  )
}



// C:\Users\israe\Documents\GitHub\recentmap\supabase\functions\notify-request\index.ts
import { serve } from 'https://deno.land/std@0.168.0/http/server.ts'
import { createClient } from 'https://esm.sh/@supabase/supabase-js@2.7.1'

const corsHeaders = {
  'Access-Control-Allow-Origin': '*',
  'Access-Control-Allow-Headers':
    'authorization, x-client-info, apikey, content-type',
}

// Fetch environment variables and handle undefined values
const RESEND_API_KEY = Deno.env.get('RESEND_API_KEY')
const supabaseUrl = Deno.env.get('SUPABASE_URL')
const supabaseKey = Deno.env.get('SUPABASE_SERVICE_ROLE_KEY')

if (!RESEND_API_KEY || !supabaseUrl || !supabaseKey) {
  console.error('Missing one or more environment variables.')
  Deno.exit(1) // Exit if essential variables are missing
}

serve(async (req) => {
  if (req.method === 'OPTIONS') {
    return new Response(null, { headers: corsHeaders })
  }

  try {
    const { requestId } = await req.json()

    const supabase = createClient(supabaseUrl, supabaseKey)

    // Fetch request details and profile
    const { data: request, error: requestError } = await supabase
      .from('vehicle_requests')
      .select(`*, profiles:profiles(full_name, phone_number)`)
      .eq('id', requestId)
      .single()

    if (requestError)
      throw new Error(`Failed to fetch request: ${requestError.message}`)

    // Send email notification
    const emailResponse = await fetch('https://api.resend.com/emails', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        Authorization: `Bearer ${RESEND_API_KEY}`,
      },
      body: JSON.stringify({
        from: 'MRGruas <onboarding@resend.dev>',
        to: ['admin@mrgruas.com'],
        subject: `New Towing Request - ${request.vehicle_make} ${request.vehicle_model}`,
        html: `
          <h2>New Towing Request</h2>
          <p><strong>Customer:</strong> ${request.profiles.full_name}</p>
          <p><strong>Phone:</strong> ${request.profiles.phone_number}</p>
          <p><strong>Vehicle:</strong> ${request.vehicle_make} ${request.vehicle_model} (${request.vehicle_year})</p>
          <p><strong>Color:</strong> ${request.vehicle_color}</p>
          <p><strong>Truck Type:</strong> ${request.truck_type}</p>
          <p><strong>Requires Maneuver:</strong> ${request.requires_maneuver ? 'Yes' : 'No'}</p>
          <h3>Locations</h3>
          <p><strong>Pickup:</strong> ${JSON.stringify(request.pickup_location)}</p>
          <p><strong>Dropoff:</strong> ${JSON.stringify(request.dropoff_location)}</p>
        `,
      }),
    })

    if (!emailResponse.ok) {
      const errorText = await emailResponse.text()
      throw new Error(`Failed to send email: ${errorText}`)
    }

    return new Response(JSON.stringify({ success: true, requestId }), {
      headers: { ...corsHeaders, 'Content-Type': 'application/json' },
    })
  } catch (error) {
    console.error('Error:', error)
    return new Response(JSON.stringify({ error: error.message }), {
      status: 500,
      headers: { ...corsHeaders, 'Content-Type': 'application/json' },
    })
  }
})



// C:\Users\israe\Documents\GitHub\recentmap\supabase\functions\webhook-notify\index.ts
import { serve } from 'https://deno.land/std@0.168.0/http/server.ts'
import { createClient } from 'https://esm.sh/@supabase/supabase-js@2.7.1'

const corsHeaders = {
  'Access-Control-Allow-Origin': '*',
  'Access-Control-Allow-Headers':
    'authorization, x-client-info, apikey, content-type',
}

serve(async (req) => {
  if (req.method === 'OPTIONS') {
    return new Response(null, { headers: corsHeaders })
  }

  try {
    const supabaseUrl = Deno.env.get('SUPABASE_URL')!
    const supabaseKey = Deno.env.get('SUPABASE_SERVICE_ROLE_KEY')!
    const supabase = createClient(supabaseUrl, supabaseKey)

    const { requestId } = await req.json()

    // Fetch request details
    const { data: request, error: requestError } = await supabase
      .from('vehicle_requests')
      .select(
        `
        *,
        profiles:profiles(username, full_name, phone_number)
      `,
      )
      .eq('id', requestId)
      .single()

    if (requestError)
      throw new Error(`Failed to fetch request: ${requestError.message}`)

    // Fetch active webhooks
    const { data: webhooks, error: webhooksError } = await supabase
      .from('webhooks')
      .select('*')
      .eq('is_active', true)

    if (webhooksError)
      throw new Error(`Failed to fetch webhooks: ${webhooksError.message}`)

    // Send webhook notifications
    const notifications = webhooks.map(async (webhook) => {
      const payload = {
        event: 'vehicle_request.created',
        request: {
          id: request.id,
          created_at: request.created_at,
          vehicle_make: request.vehicle_make,
          vehicle_model: request.vehicle_model,
          status: request.status,
          customer: {
            name: request.profiles.full_name,
            phone: request.profiles.phone_number,
          },
          locations: {
            pickup: request.pickup_location,
            dropoff: request.dropoff_location,
          },
        },
      }

      const signature = await createSignature(
        JSON.stringify(payload),
        webhook.secret_key,
      )

      return fetch(webhook.url, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-Webhook-Signature': signature,
        },
        body: JSON.stringify(payload),
      })
    })

    await Promise.all(notifications)

    return new Response(JSON.stringify({ success: true }), {
      headers: { ...corsHeaders, 'Content-Type': 'application/json' },
    })
  } catch (error) {
    console.error('Error:', error)
    return new Response(JSON.stringify({ error: error.message }), {
      status: 500,
      headers: { ...corsHeaders, 'Content-Type': 'application/json' },
    })
  }
})

async function createSignature(
  payload: string,
  secret: string,
): Promise<string> {
  const encoder = new TextEncoder()
  const key = await crypto.subtle.importKey(
    'raw',
    encoder.encode(secret),
    { name: 'HMAC', hash: 'SHA-256' },
    false,
    ['sign'],
  )
  const signature = await crypto.subtle.sign(
    'HMAC',
    key,
    encoder.encode(payload),
  )
  return Array.from(new Uint8Array(signature))
    .map((b) => b.toString(16).padStart(2, '0'))
    .join('')
}

